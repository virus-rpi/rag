2024.09.26 22:56:09.279121 [ 1 ] {} <Warning> Context: Linux transparent hugepages are set to "always". Check /sys/kernel/mm/transparent_hugepage/enabled
2024.09.26 22:56:09.316753 [ 1 ] {} <Warning> Application: Integrity check of the executable skipped because the reference checksum could not be read.
2024.09.26 22:56:09.617927 [ 1 ] {} <Warning> Access(local directory): File /var/lib/clickhouse/access/users.list doesn't exist
2024.09.26 22:56:09.618219 [ 1 ] {} <Warning> Access(local directory): Recovering lists in directory /var/lib/clickhouse/access/
2024.09.26 22:56:09.709465 [ 1 ] {} <Warning> Context: Table system.session_log is enabled. It's unreliable and may contain garbage. Do not use it for any kind of security monitoring.
2024.09.26 22:59:56.642449 [ 39 ] {} <Error> Access(user directories): from: 192.168.65.1, user: default: Authentication failed: Code: 195. DB::Exception: Connections from 192.168.65.1 are not allowed. (IP_ADDRESS_NOT_ALLOWED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0xda217e4 in /usr/bin/clickhouse
3. ./build/./src/Access/IAccessStorage.cpp:0: DB::IAccessStorage::throwAddressNotAllowed(Poco::Net::IPAddress const&) @ 0x16c1b3d2 in /usr/bin/clickhouse
4. ./build/./src/Access/IAccessStorage.cpp:490: DB::IAccessStorage::authenticateImpl(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c1864c in /usr/bin/clickhouse
5. ./build/./src/Access/IAccessStorage.cpp:468: DB::IAccessStorage::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c1b342 in /usr/bin/clickhouse
6. ./build/./src/Access/MultipleAccessStorage.cpp:342: DB::MultipleAccessStorage::authenticateImpl(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c3cdd1 in /usr/bin/clickhouse
7. ./build/./src/Access/IAccessStorage.cpp:456: DB::IAccessStorage::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool) const @ 0x16c1b30c in /usr/bin/clickhouse
8. ./build/./src/Access/AccessControl.cpp:559: DB::AccessControl::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&) const @ 0x16b74d62 in /usr/bin/clickhouse
9. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::Session::authenticate(DB::Credentials const&, Poco::Net::SocketAddress const&) @ 0x17d8d042 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::HTTPHandler::authenticateUser(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&) @ 0x18c45f2e in /usr/bin/clickhouse
11. ./build/./src/Server/HTTPHandler.cpp:544: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c47815 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
13. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
14. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
15. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
16. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
17. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
18. ? @ 0x7f61f2294ac3 in ?
19. ? @ 0x7f61f2326850 in ?
 (version 23.3.2.1)
2024.09.26 22:59:56.656750 [ 39 ] {} <Error> DynamicQueryHandler: Code: 516. DB::Exception: default: Authentication failed: password is incorrect, or there is no user with such name.

If you have installed ClickHouse and forgot password you can reset it in the configuration file.
The password for default user is typically located at /etc/clickhouse-server/users.d/default-password.xml
and deleting this file will reset the password.
See also /etc/clickhouse-server/users.xml on the server where ClickHouse is installed.

. (AUTHENTICATION_FAILED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0xda3792c in /usr/bin/clickhouse
3. ./build/./src/Access/AccessControl.cpp:0: DB::AccessControl::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&) const @ 0x16b7501d in /usr/bin/clickhouse
4. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::Session::authenticate(DB::Credentials const&, Poco::Net::SocketAddress const&) @ 0x17d8d042 in /usr/bin/clickhouse
5. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::HTTPHandler::authenticateUser(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&) @ 0x18c45f2e in /usr/bin/clickhouse
6. ./build/./src/Server/HTTPHandler.cpp:544: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c47815 in /usr/bin/clickhouse
7. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
8. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
9. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
11. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
12. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
13. ? @ 0x7f61f2294ac3 in ?
14. ? @ 0x7f61f2326850 in ?
 (version 23.3.2.1)
2024.09.26 23:01:48.161328 [ 39 ] {} <Error> Access(user directories): from: 192.168.65.1, user: default: Authentication failed: Code: 195. DB::Exception: Connections from 192.168.65.1 are not allowed. (IP_ADDRESS_NOT_ALLOWED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0xda217e4 in /usr/bin/clickhouse
3. ./build/./src/Access/IAccessStorage.cpp:0: DB::IAccessStorage::throwAddressNotAllowed(Poco::Net::IPAddress const&) @ 0x16c1b3d2 in /usr/bin/clickhouse
4. ./build/./src/Access/IAccessStorage.cpp:490: DB::IAccessStorage::authenticateImpl(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c1864c in /usr/bin/clickhouse
5. ./build/./src/Access/IAccessStorage.cpp:468: DB::IAccessStorage::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c1b342 in /usr/bin/clickhouse
6. ./build/./src/Access/MultipleAccessStorage.cpp:342: DB::MultipleAccessStorage::authenticateImpl(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c3cdd1 in /usr/bin/clickhouse
7. ./build/./src/Access/IAccessStorage.cpp:456: DB::IAccessStorage::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool) const @ 0x16c1b30c in /usr/bin/clickhouse
8. ./build/./src/Access/AccessControl.cpp:559: DB::AccessControl::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&) const @ 0x16b74d62 in /usr/bin/clickhouse
9. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::Session::authenticate(DB::Credentials const&, Poco::Net::SocketAddress const&) @ 0x17d8d042 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::HTTPHandler::authenticateUser(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&) @ 0x18c45f2e in /usr/bin/clickhouse
11. ./build/./src/Server/HTTPHandler.cpp:544: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c47815 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
13. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
14. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
15. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
16. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
17. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
18. ? @ 0x7f61f2294ac3 in ?
19. ? @ 0x7f61f2326850 in ?
 (version 23.3.2.1)
2024.09.26 23:01:48.171520 [ 39 ] {} <Error> DynamicQueryHandler: Code: 516. DB::Exception: default: Authentication failed: password is incorrect, or there is no user with such name.

If you have installed ClickHouse and forgot password you can reset it in the configuration file.
The password for default user is typically located at /etc/clickhouse-server/users.d/default-password.xml
and deleting this file will reset the password.
See also /etc/clickhouse-server/users.xml on the server where ClickHouse is installed.

. (AUTHENTICATION_FAILED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0xda3792c in /usr/bin/clickhouse
3. ./build/./src/Access/AccessControl.cpp:0: DB::AccessControl::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&) const @ 0x16b7501d in /usr/bin/clickhouse
4. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::Session::authenticate(DB::Credentials const&, Poco::Net::SocketAddress const&) @ 0x17d8d042 in /usr/bin/clickhouse
5. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::HTTPHandler::authenticateUser(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&) @ 0x18c45f2e in /usr/bin/clickhouse
6. ./build/./src/Server/HTTPHandler.cpp:544: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c47815 in /usr/bin/clickhouse
7. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
8. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
9. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
11. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
12. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
13. ? @ 0x7f61f2294ac3 in ?
14. ? @ 0x7f61f2326850 in ?
 (version 23.3.2.1)
2024.09.26 23:03:15.426141 [ 1 ] {} <Warning> Context: Linux transparent hugepages are set to "always". Check /sys/kernel/mm/transparent_hugepage/enabled
2024.09.26 23:03:15.432895 [ 1 ] {} <Warning> Application: Integrity check of the executable skipped because the reference checksum could not be read.
2024.09.26 23:03:15.771975 [ 1 ] {} <Warning> Context: Table system.session_log is enabled. It's unreliable and may contain garbage. Do not use it for any kind of security monitoring.
2024.09.26 23:04:29.027271 [ 39 ] {} <Error> Access(user directories): from: 192.168.65.1, user: default: Authentication failed: Code: 195. DB::Exception: Connections from 192.168.65.1 are not allowed. (IP_ADDRESS_NOT_ALLOWED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0xda217e4 in /usr/bin/clickhouse
3. ./build/./src/Access/IAccessStorage.cpp:0: DB::IAccessStorage::throwAddressNotAllowed(Poco::Net::IPAddress const&) @ 0x16c1b3d2 in /usr/bin/clickhouse
4. ./build/./src/Access/IAccessStorage.cpp:490: DB::IAccessStorage::authenticateImpl(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c1864c in /usr/bin/clickhouse
5. ./build/./src/Access/IAccessStorage.cpp:468: DB::IAccessStorage::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c1b342 in /usr/bin/clickhouse
6. ./build/./src/Access/MultipleAccessStorage.cpp:342: DB::MultipleAccessStorage::authenticateImpl(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c3cdd1 in /usr/bin/clickhouse
7. ./build/./src/Access/IAccessStorage.cpp:456: DB::IAccessStorage::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool) const @ 0x16c1b30c in /usr/bin/clickhouse
8. ./build/./src/Access/AccessControl.cpp:559: DB::AccessControl::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&) const @ 0x16b74d62 in /usr/bin/clickhouse
9. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::Session::authenticate(DB::Credentials const&, Poco::Net::SocketAddress const&) @ 0x17d8d042 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::HTTPHandler::authenticateUser(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&) @ 0x18c45f2e in /usr/bin/clickhouse
11. ./build/./src/Server/HTTPHandler.cpp:544: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c47815 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
13. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
14. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
15. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
16. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
17. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
18. ? @ 0x7fc8b5c94ac3 in ?
19. ? @ 0x7fc8b5d26850 in ?
 (version 23.3.2.1)
2024.09.26 23:04:29.046397 [ 39 ] {} <Error> DynamicQueryHandler: Code: 516. DB::Exception: default: Authentication failed: password is incorrect, or there is no user with such name.

If you have installed ClickHouse and forgot password you can reset it in the configuration file.
The password for default user is typically located at /etc/clickhouse-server/users.d/default-password.xml
and deleting this file will reset the password.
See also /etc/clickhouse-server/users.xml on the server where ClickHouse is installed.

. (AUTHENTICATION_FAILED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0xda3792c in /usr/bin/clickhouse
3. ./build/./src/Access/AccessControl.cpp:0: DB::AccessControl::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&) const @ 0x16b7501d in /usr/bin/clickhouse
4. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::Session::authenticate(DB::Credentials const&, Poco::Net::SocketAddress const&) @ 0x17d8d042 in /usr/bin/clickhouse
5. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::HTTPHandler::authenticateUser(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&) @ 0x18c45f2e in /usr/bin/clickhouse
6. ./build/./src/Server/HTTPHandler.cpp:544: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c47815 in /usr/bin/clickhouse
7. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
8. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
9. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
11. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
12. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
13. ? @ 0x7fc8b5c94ac3 in ?
14. ? @ 0x7fc8b5d26850 in ?
 (version 23.3.2.1)
2024.09.26 23:04:32.247685 [ 39 ] {} <Error> Access(user directories): from: 192.168.65.1, user: default: Authentication failed: Code: 195. DB::Exception: Connections from 192.168.65.1 are not allowed. (IP_ADDRESS_NOT_ALLOWED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0xda217e4 in /usr/bin/clickhouse
3. ./build/./src/Access/IAccessStorage.cpp:0: DB::IAccessStorage::throwAddressNotAllowed(Poco::Net::IPAddress const&) @ 0x16c1b3d2 in /usr/bin/clickhouse
4. ./build/./src/Access/IAccessStorage.cpp:490: DB::IAccessStorage::authenticateImpl(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c1864c in /usr/bin/clickhouse
5. ./build/./src/Access/IAccessStorage.cpp:468: DB::IAccessStorage::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c1b342 in /usr/bin/clickhouse
6. ./build/./src/Access/MultipleAccessStorage.cpp:342: DB::MultipleAccessStorage::authenticateImpl(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c3cdd1 in /usr/bin/clickhouse
7. ./build/./src/Access/IAccessStorage.cpp:456: DB::IAccessStorage::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool) const @ 0x16c1b30c in /usr/bin/clickhouse
8. ./build/./src/Access/AccessControl.cpp:559: DB::AccessControl::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&) const @ 0x16b74d62 in /usr/bin/clickhouse
9. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::Session::authenticate(DB::Credentials const&, Poco::Net::SocketAddress const&) @ 0x17d8d042 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::HTTPHandler::authenticateUser(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&) @ 0x18c45f2e in /usr/bin/clickhouse
11. ./build/./src/Server/HTTPHandler.cpp:544: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c47815 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
13. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
14. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
15. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
16. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
17. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
18. ? @ 0x7fc8b5c94ac3 in ?
19. ? @ 0x7fc8b5d26850 in ?
 (version 23.3.2.1)
2024.09.26 23:04:32.249259 [ 39 ] {} <Error> DynamicQueryHandler: Code: 516. DB::Exception: default: Authentication failed: password is incorrect, or there is no user with such name.

If you have installed ClickHouse and forgot password you can reset it in the configuration file.
The password for default user is typically located at /etc/clickhouse-server/users.d/default-password.xml
and deleting this file will reset the password.
See also /etc/clickhouse-server/users.xml on the server where ClickHouse is installed.

. (AUTHENTICATION_FAILED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0xda3792c in /usr/bin/clickhouse
3. ./build/./src/Access/AccessControl.cpp:0: DB::AccessControl::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&) const @ 0x16b7501d in /usr/bin/clickhouse
4. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::Session::authenticate(DB::Credentials const&, Poco::Net::SocketAddress const&) @ 0x17d8d042 in /usr/bin/clickhouse
5. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::HTTPHandler::authenticateUser(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&) @ 0x18c45f2e in /usr/bin/clickhouse
6. ./build/./src/Server/HTTPHandler.cpp:544: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c47815 in /usr/bin/clickhouse
7. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
8. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
9. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
11. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
12. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
13. ? @ 0x7fc8b5c94ac3 in ?
14. ? @ 0x7fc8b5d26850 in ?
 (version 23.3.2.1)
2024.09.26 23:13:06.531109 [ 39 ] {} <Error> Access(user directories): from: 192.168.65.1, user: default: Authentication failed: Code: 195. DB::Exception: Connections from 192.168.65.1 are not allowed. (IP_ADDRESS_NOT_ALLOWED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0xda217e4 in /usr/bin/clickhouse
3. ./build/./src/Access/IAccessStorage.cpp:0: DB::IAccessStorage::throwAddressNotAllowed(Poco::Net::IPAddress const&) @ 0x16c1b3d2 in /usr/bin/clickhouse
4. ./build/./src/Access/IAccessStorage.cpp:490: DB::IAccessStorage::authenticateImpl(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c1864c in /usr/bin/clickhouse
5. ./build/./src/Access/IAccessStorage.cpp:468: DB::IAccessStorage::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c1b342 in /usr/bin/clickhouse
6. ./build/./src/Access/MultipleAccessStorage.cpp:342: DB::MultipleAccessStorage::authenticateImpl(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c3cdd1 in /usr/bin/clickhouse
7. ./build/./src/Access/IAccessStorage.cpp:456: DB::IAccessStorage::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool) const @ 0x16c1b30c in /usr/bin/clickhouse
8. ./build/./src/Access/AccessControl.cpp:559: DB::AccessControl::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&) const @ 0x16b74d62 in /usr/bin/clickhouse
9. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::Session::authenticate(DB::Credentials const&, Poco::Net::SocketAddress const&) @ 0x17d8d042 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::HTTPHandler::authenticateUser(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&) @ 0x18c45f2e in /usr/bin/clickhouse
11. ./build/./src/Server/HTTPHandler.cpp:544: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c47815 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
13. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
14. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
15. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
16. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
17. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
18. ? @ 0x7fc8b5c94ac3 in ?
19. ? @ 0x7fc8b5d26850 in ?
 (version 23.3.2.1)
2024.09.26 23:13:06.538506 [ 39 ] {} <Error> DynamicQueryHandler: Code: 516. DB::Exception: default: Authentication failed: password is incorrect, or there is no user with such name.

If you have installed ClickHouse and forgot password you can reset it in the configuration file.
The password for default user is typically located at /etc/clickhouse-server/users.d/default-password.xml
and deleting this file will reset the password.
See also /etc/clickhouse-server/users.xml on the server where ClickHouse is installed.

. (AUTHENTICATION_FAILED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0xda3792c in /usr/bin/clickhouse
3. ./build/./src/Access/AccessControl.cpp:0: DB::AccessControl::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&) const @ 0x16b7501d in /usr/bin/clickhouse
4. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::Session::authenticate(DB::Credentials const&, Poco::Net::SocketAddress const&) @ 0x17d8d042 in /usr/bin/clickhouse
5. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::HTTPHandler::authenticateUser(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&) @ 0x18c45f2e in /usr/bin/clickhouse
6. ./build/./src/Server/HTTPHandler.cpp:544: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c47815 in /usr/bin/clickhouse
7. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
8. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
9. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
11. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
12. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
13. ? @ 0x7fc8b5c94ac3 in ?
14. ? @ 0x7fc8b5d26850 in ?
 (version 23.3.2.1)
2024.09.26 23:15:32.357083 [ 1 ] {} <Warning> Context: Linux transparent hugepages are set to "always". Check /sys/kernel/mm/transparent_hugepage/enabled
2024.09.26 23:15:32.362308 [ 1 ] {} <Warning> Application: Integrity check of the executable skipped because the reference checksum could not be read.
2024.09.26 23:15:32.643913 [ 1 ] {} <Warning> Context: Table system.session_log is enabled. It's unreliable and may contain garbage. Do not use it for any kind of security monitoring.
2024.09.26 23:15:46.272317 [ 1 ] {} <Warning> Context: Linux transparent hugepages are set to "always". Check /sys/kernel/mm/transparent_hugepage/enabled
2024.09.26 23:15:46.278954 [ 1 ] {} <Warning> Application: Integrity check of the executable skipped because the reference checksum could not be read.
2024.09.26 23:15:46.724441 [ 1 ] {} <Warning> Context: Table system.session_log is enabled. It's unreliable and may contain garbage. Do not use it for any kind of security monitoring.
2024.09.26 23:15:52.565441 [ 39 ] {} <Error> Access(user directories): from: 192.168.65.1, user: default: Authentication failed: Code: 193. DB::Exception: Invalid credentials. (WRONG_PASSWORD), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::Exception<char const (&) [20], void>(int, char const (&) [20]) @ 0xdd92f36 in /usr/bin/clickhouse
3. ./build/./src/Access/IAccessStorage.cpp:709: DB::IAccessStorage::throwInvalidCredentials() @ 0x16c1b5e4 in /usr/bin/clickhouse
4. ./build/./src/Access/IAccessStorage.cpp:0: DB::IAccessStorage::authenticateImpl(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c18656 in /usr/bin/clickhouse
5. ./build/./src/Access/IAccessStorage.cpp:468: DB::IAccessStorage::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c1b342 in /usr/bin/clickhouse
6. ./build/./src/Access/MultipleAccessStorage.cpp:342: DB::MultipleAccessStorage::authenticateImpl(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c3cdd1 in /usr/bin/clickhouse
7. ./build/./src/Access/IAccessStorage.cpp:456: DB::IAccessStorage::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool) const @ 0x16c1b30c in /usr/bin/clickhouse
8. ./build/./src/Access/AccessControl.cpp:559: DB::AccessControl::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&) const @ 0x16b74d62 in /usr/bin/clickhouse
9. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::Session::authenticate(DB::Credentials const&, Poco::Net::SocketAddress const&) @ 0x17d8d042 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::HTTPHandler::authenticateUser(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&) @ 0x18c45f2e in /usr/bin/clickhouse
11. ./build/./src/Server/HTTPHandler.cpp:544: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c47815 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
13. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
14. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
15. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
16. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
17. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
18. ? @ 0x7f2e3da94ac3 in ?
19. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.26 23:15:52.579849 [ 39 ] {} <Error> DynamicQueryHandler: Code: 516. DB::Exception: default: Authentication failed: password is incorrect, or there is no user with such name.

If you have installed ClickHouse and forgot password you can reset it in the configuration file.
The password for default user is typically located at /etc/clickhouse-server/users.d/default-password.xml
and deleting this file will reset the password.
See also /etc/clickhouse-server/users.xml on the server where ClickHouse is installed.

. (AUTHENTICATION_FAILED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0xda3792c in /usr/bin/clickhouse
3. ./build/./src/Access/AccessControl.cpp:0: DB::AccessControl::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&) const @ 0x16b7501d in /usr/bin/clickhouse
4. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::Session::authenticate(DB::Credentials const&, Poco::Net::SocketAddress const&) @ 0x17d8d042 in /usr/bin/clickhouse
5. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::HTTPHandler::authenticateUser(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&) @ 0x18c45f2e in /usr/bin/clickhouse
6. ./build/./src/Server/HTTPHandler.cpp:544: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c47815 in /usr/bin/clickhouse
7. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
8. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
9. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
11. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
12. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
13. ? @ 0x7f2e3da94ac3 in ?
14. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.26 23:17:42.503184 [ 39 ] {} <Error> Access(user directories): from: 192.168.65.1, user: default: Authentication failed: Code: 193. DB::Exception: Invalid credentials. (WRONG_PASSWORD), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::Exception<char const (&) [20], void>(int, char const (&) [20]) @ 0xdd92f36 in /usr/bin/clickhouse
3. ./build/./src/Access/IAccessStorage.cpp:709: DB::IAccessStorage::throwInvalidCredentials() @ 0x16c1b5e4 in /usr/bin/clickhouse
4. ./build/./src/Access/IAccessStorage.cpp:0: DB::IAccessStorage::authenticateImpl(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c18656 in /usr/bin/clickhouse
5. ./build/./src/Access/IAccessStorage.cpp:468: DB::IAccessStorage::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c1b342 in /usr/bin/clickhouse
6. ./build/./src/Access/MultipleAccessStorage.cpp:342: DB::MultipleAccessStorage::authenticateImpl(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c3cdd1 in /usr/bin/clickhouse
7. ./build/./src/Access/IAccessStorage.cpp:456: DB::IAccessStorage::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool) const @ 0x16c1b30c in /usr/bin/clickhouse
8. ./build/./src/Access/AccessControl.cpp:559: DB::AccessControl::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&) const @ 0x16b74d62 in /usr/bin/clickhouse
9. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::Session::authenticate(DB::Credentials const&, Poco::Net::SocketAddress const&) @ 0x17d8d042 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::HTTPHandler::authenticateUser(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&) @ 0x18c45f2e in /usr/bin/clickhouse
11. ./build/./src/Server/HTTPHandler.cpp:544: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c47815 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
13. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
14. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
15. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
16. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
17. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
18. ? @ 0x7f2e3da94ac3 in ?
19. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.26 23:17:42.505311 [ 39 ] {} <Error> DynamicQueryHandler: Code: 516. DB::Exception: default: Authentication failed: password is incorrect, or there is no user with such name.

If you have installed ClickHouse and forgot password you can reset it in the configuration file.
The password for default user is typically located at /etc/clickhouse-server/users.d/default-password.xml
and deleting this file will reset the password.
See also /etc/clickhouse-server/users.xml on the server where ClickHouse is installed.

. (AUTHENTICATION_FAILED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0xda3792c in /usr/bin/clickhouse
3. ./build/./src/Access/AccessControl.cpp:0: DB::AccessControl::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&) const @ 0x16b7501d in /usr/bin/clickhouse
4. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::Session::authenticate(DB::Credentials const&, Poco::Net::SocketAddress const&) @ 0x17d8d042 in /usr/bin/clickhouse
5. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::HTTPHandler::authenticateUser(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&) @ 0x18c45f2e in /usr/bin/clickhouse
6. ./build/./src/Server/HTTPHandler.cpp:544: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c47815 in /usr/bin/clickhouse
7. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
8. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
9. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
11. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
12. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
13. ? @ 0x7f2e3da94ac3 in ?
14. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.26 23:18:36.658498 [ 39 ] {} <Error> Access(user directories): from: 192.168.65.1, user: default: Authentication failed: Code: 193. DB::Exception: Invalid credentials. (WRONG_PASSWORD), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::Exception<char const (&) [20], void>(int, char const (&) [20]) @ 0xdd92f36 in /usr/bin/clickhouse
3. ./build/./src/Access/IAccessStorage.cpp:709: DB::IAccessStorage::throwInvalidCredentials() @ 0x16c1b5e4 in /usr/bin/clickhouse
4. ./build/./src/Access/IAccessStorage.cpp:0: DB::IAccessStorage::authenticateImpl(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c18656 in /usr/bin/clickhouse
5. ./build/./src/Access/IAccessStorage.cpp:468: DB::IAccessStorage::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c1b342 in /usr/bin/clickhouse
6. ./build/./src/Access/MultipleAccessStorage.cpp:342: DB::MultipleAccessStorage::authenticateImpl(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c3cdd1 in /usr/bin/clickhouse
7. ./build/./src/Access/IAccessStorage.cpp:456: DB::IAccessStorage::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool) const @ 0x16c1b30c in /usr/bin/clickhouse
8. ./build/./src/Access/AccessControl.cpp:559: DB::AccessControl::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&) const @ 0x16b74d62 in /usr/bin/clickhouse
9. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::Session::authenticate(DB::Credentials const&, Poco::Net::SocketAddress const&) @ 0x17d8d042 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::HTTPHandler::authenticateUser(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&) @ 0x18c45f2e in /usr/bin/clickhouse
11. ./build/./src/Server/HTTPHandler.cpp:544: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c47815 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
13. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
14. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
15. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
16. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
17. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
18. ? @ 0x7f2e3da94ac3 in ?
19. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.26 23:18:36.661776 [ 39 ] {} <Error> DynamicQueryHandler: Code: 516. DB::Exception: default: Authentication failed: password is incorrect, or there is no user with such name.

If you have installed ClickHouse and forgot password you can reset it in the configuration file.
The password for default user is typically located at /etc/clickhouse-server/users.d/default-password.xml
and deleting this file will reset the password.
See also /etc/clickhouse-server/users.xml on the server where ClickHouse is installed.

. (AUTHENTICATION_FAILED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0xda3792c in /usr/bin/clickhouse
3. ./build/./src/Access/AccessControl.cpp:0: DB::AccessControl::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&) const @ 0x16b7501d in /usr/bin/clickhouse
4. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::Session::authenticate(DB::Credentials const&, Poco::Net::SocketAddress const&) @ 0x17d8d042 in /usr/bin/clickhouse
5. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::HTTPHandler::authenticateUser(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&) @ 0x18c45f2e in /usr/bin/clickhouse
6. ./build/./src/Server/HTTPHandler.cpp:544: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c47815 in /usr/bin/clickhouse
7. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
8. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
9. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
11. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
12. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
13. ? @ 0x7f2e3da94ac3 in ?
14. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.26 23:18:57.819959 [ 39 ] {25fd30d8-abc9-474f-b3a4-5f189c844917} <Error> executeQuery: std::exception. Code: 1001, type: SearchIndexException, e.what() = Error(BAD_ARGUMENTS): Unknown index type for Float32 Vector: MSTG (version 23.3.2.1) (from 192.168.65.1:31275) (in query:  ALTER TABLE default.test ADD VECTOR INDEX vector_index embeddings TYPE MSTG ), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: SearchIndexException::SearchIndexException(Search::ErrorCode, String const&) @ 0x19186c55 in /usr/bin/clickhouse
1. ./build/./contrib/search-index/SearchIndex/VectorSearch.cpp:92: Search::getVectorIndexType(String, Search::DataType const&) @ 0x1ca07ed1 in /usr/bin/clickhouse
2. ./build/./src/VectorIndex/Storages/VIDescriptions.cpp:0: DB::VIDescription::getVectorIndexFromAST(std::shared_ptr<DB::IAST> const&, DB::ColumnsDescription const&, DB::ConstraintsDescription const&, bool) @ 0x19243052 in /usr/bin/clickhouse
3. ./build/./src/Storages/AlterCommands.cpp:0: DB::AlterCommand::apply(DB::StorageInMemoryMetadata&, std::shared_ptr<DB::Context const>) const @ 0x182a97f3 in /usr/bin/clickhouse
4. ./build/./contrib/llvm-project/libcxx/include/__iterator/wrap_iter.h:100: DB::AlterCommands::apply(DB::StorageInMemoryMetadata&, std::shared_ptr<DB::Context const>) const @ 0x182acb6e in /usr/bin/clickhouse
5. ./build/./src/Storages/MergeTree/MergeTreeData.cpp:0: DB::MergeTreeData::checkAlterIsPossible(DB::AlterCommands const&, std::shared_ptr<DB::Context const>) const @ 0x18836d1b in /usr/bin/clickhouse
6. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:1645: DB::InterpreterAlterQuery::executeToTable(DB::ASTAlterQuery&) @ 0x17b0ec20 in /usr/bin/clickhouse
7. ./build/./src/Interpreters/InterpreterAlterQuery.cpp:67: DB::InterpreterAlterQuery::execute() @ 0x17b0b030 in /usr/bin/clickhouse
8. ./build/./src/Interpreters/executeQuery.cpp:0: DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x17f5dd65 in /usr/bin/clickhouse
9. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:612: DB::executeQuery(DB::ReadBuffer&, DB::WriteBuffer&, bool, std::shared_ptr<DB::Context>, std::function<void (DB::QueryResultDetails const&)>, std::optional<DB::FormatSettings> const&) @ 0x17f6a022 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/optional:260: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c4a8e0 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
12. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
13. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
15. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
16. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
17. ? @ 0x7f2e3da94ac3 in ?
18. ? @ 0x7f2e3db26850 in ?

2024.09.26 23:18:57.821568 [ 39 ] {25fd30d8-abc9-474f-b3a4-5f189c844917} <Error> DynamicQueryHandler: std::exception. Code: 1001, type: SearchIndexException, e.what() = Error(BAD_ARGUMENTS): Unknown index type for Float32 Vector: MSTG, Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: SearchIndexException::SearchIndexException(Search::ErrorCode, String const&) @ 0x19186c55 in /usr/bin/clickhouse
1. ./build/./contrib/search-index/SearchIndex/VectorSearch.cpp:92: Search::getVectorIndexType(String, Search::DataType const&) @ 0x1ca07ed1 in /usr/bin/clickhouse
2. ./build/./src/VectorIndex/Storages/VIDescriptions.cpp:0: DB::VIDescription::getVectorIndexFromAST(std::shared_ptr<DB::IAST> const&, DB::ColumnsDescription const&, DB::ConstraintsDescription const&, bool) @ 0x19243052 in /usr/bin/clickhouse
3. ./build/./src/Storages/AlterCommands.cpp:0: DB::AlterCommand::apply(DB::StorageInMemoryMetadata&, std::shared_ptr<DB::Context const>) const @ 0x182a97f3 in /usr/bin/clickhouse
4. ./build/./contrib/llvm-project/libcxx/include/__iterator/wrap_iter.h:100: DB::AlterCommands::apply(DB::StorageInMemoryMetadata&, std::shared_ptr<DB::Context const>) const @ 0x182acb6e in /usr/bin/clickhouse
5. ./build/./src/Storages/MergeTree/MergeTreeData.cpp:0: DB::MergeTreeData::checkAlterIsPossible(DB::AlterCommands const&, std::shared_ptr<DB::Context const>) const @ 0x18836d1b in /usr/bin/clickhouse
6. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:1645: DB::InterpreterAlterQuery::executeToTable(DB::ASTAlterQuery&) @ 0x17b0ec20 in /usr/bin/clickhouse
7. ./build/./src/Interpreters/InterpreterAlterQuery.cpp:67: DB::InterpreterAlterQuery::execute() @ 0x17b0b030 in /usr/bin/clickhouse
8. ./build/./src/Interpreters/executeQuery.cpp:0: DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x17f5dd65 in /usr/bin/clickhouse
9. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:612: DB::executeQuery(DB::ReadBuffer&, DB::WriteBuffer&, bool, std::shared_ptr<DB::Context>, std::function<void (DB::QueryResultDetails const&)>, std::optional<DB::FormatSettings> const&) @ 0x17f6a022 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/optional:260: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c4a8e0 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
12. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
13. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
15. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
16. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
17. ? @ 0x7f2e3da94ac3 in ?
18. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.26 23:20:23.267009 [ 39 ] {68d13f5d-c0bf-45a0-ac23-54615aa55673} <Error> executeQuery: Code: 57. DB::Exception: Table default.test already exists. (TABLE_ALREADY_EXISTS) (version 23.3.2.1) (from 192.168.65.1:57082) (in query:  CREATE TABLE default.test ( id Int64, page_content String, embeddings Array(Float32), CONSTRAINT check_data_length CHECK length(embeddings) = 768 ) ENGINE = MergeTree() ORDER BY id ), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<String&, String, String>(int, FormatStringHelperImpl<std::type_identity<String&>::type, std::type_identity<String>::type, std::type_identity<String>::type>, String&, String&&, String&&) @ 0x15168440 in /usr/bin/clickhouse
3. ./build/./src/Interpreters/InterpreterCreateQuery.cpp:0: DB::InterpreterCreateQuery::doCreateTable(DB::ASTCreateQuery&, DB::InterpreterCreateQuery::TableProperties const&, std::unique_ptr<DB::DDLGuard, std::default_delete<DB::DDLGuard>>&) @ 0x17a961cb in /usr/bin/clickhouse
4. ./build/./src/Interpreters/InterpreterCreateQuery.cpp:0: DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x17a90402 in /usr/bin/clickhouse
5. ./build/./src/Interpreters/InterpreterCreateQuery.cpp:1819: DB::InterpreterCreateQuery::execute() @ 0x17a7ddc1 in /usr/bin/clickhouse
6. ./build/./src/Interpreters/executeQuery.cpp:0: DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x17f5dd65 in /usr/bin/clickhouse
7. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:612: DB::executeQuery(DB::ReadBuffer&, DB::WriteBuffer&, bool, std::shared_ptr<DB::Context>, std::function<void (DB::QueryResultDetails const&)>, std::optional<DB::FormatSettings> const&) @ 0x17f6a022 in /usr/bin/clickhouse
8. ./build/./contrib/llvm-project/libcxx/include/optional:260: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c4a8e0 in /usr/bin/clickhouse
9. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
10. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
11. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
13. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
14. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
15. ? @ 0x7f2e3da94ac3 in ?
16. ? @ 0x7f2e3db26850 in ?

2024.09.26 23:20:23.269632 [ 39 ] {68d13f5d-c0bf-45a0-ac23-54615aa55673} <Error> DynamicQueryHandler: Code: 57. DB::Exception: Table default.test already exists. (TABLE_ALREADY_EXISTS), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<String&, String, String>(int, FormatStringHelperImpl<std::type_identity<String&>::type, std::type_identity<String>::type, std::type_identity<String>::type>, String&, String&&, String&&) @ 0x15168440 in /usr/bin/clickhouse
3. ./build/./src/Interpreters/InterpreterCreateQuery.cpp:0: DB::InterpreterCreateQuery::doCreateTable(DB::ASTCreateQuery&, DB::InterpreterCreateQuery::TableProperties const&, std::unique_ptr<DB::DDLGuard, std::default_delete<DB::DDLGuard>>&) @ 0x17a961cb in /usr/bin/clickhouse
4. ./build/./src/Interpreters/InterpreterCreateQuery.cpp:0: DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x17a90402 in /usr/bin/clickhouse
5. ./build/./src/Interpreters/InterpreterCreateQuery.cpp:1819: DB::InterpreterCreateQuery::execute() @ 0x17a7ddc1 in /usr/bin/clickhouse
6. ./build/./src/Interpreters/executeQuery.cpp:0: DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x17f5dd65 in /usr/bin/clickhouse
7. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:612: DB::executeQuery(DB::ReadBuffer&, DB::WriteBuffer&, bool, std::shared_ptr<DB::Context>, std::function<void (DB::QueryResultDetails const&)>, std::optional<DB::FormatSettings> const&) @ 0x17f6a022 in /usr/bin/clickhouse
8. ./build/./contrib/llvm-project/libcxx/include/optional:260: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c4a8e0 in /usr/bin/clickhouse
9. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
10. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
11. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
13. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
14. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
15. ? @ 0x7f2e3da94ac3 in ?
16. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.26 23:35:56.151669 [ 239 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f2e3da94ac3 in ?
31. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.26 23:38:26.715539 [ 228 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.84 GiB (attempt to allocate chunk of 4360416 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f2e3da94ac3 in ?
31. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.26 23:40:57.925818 [ 232 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360448 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f2e3da94ac3 in ?
31. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.26 23:45:21.706113 [ 234 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.82 GiB (attempt to allocate chunk of 4360368 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f2e3da94ac3 in ?
31. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.26 23:49:45.718195 [ 234 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360336 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f2e3da94ac3 in ?
31. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.26 23:50:23.643046 [ 224 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.84 GiB (attempt to allocate chunk of 4360272 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f2e3da94ac3 in ?
31. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.26 23:52:16.751088 [ 230 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.85 GiB (attempt to allocate chunk of 4360368 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f2e3da94ac3 in ?
31. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.26 23:57:18.857982 [ 233 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360448 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f2e3da94ac3 in ?
31. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.26 23:59:50.302134 [ 228 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.82 GiB (attempt to allocate chunk of 4360448 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f2e3da94ac3 in ?
31. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.27 00:02:20.581044 [ 233 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.82 GiB (attempt to allocate chunk of 4360336 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f2e3da94ac3 in ?
31. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.27 00:04:13.663940 [ 233 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.81 GiB (attempt to allocate chunk of 4360272 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f2e3da94ac3 in ?
31. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.27 00:09:53.716312 [ 239 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.82 GiB (attempt to allocate chunk of 4360368 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f2e3da94ac3 in ?
31. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.27 00:12:24.603571 [ 233 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.82 GiB (attempt to allocate chunk of 4360304 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f2e3da94ac3 in ?
31. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.27 00:14:55.953489 [ 230 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360368 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f2e3da94ac3 in ?
31. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.27 00:15:33.742271 [ 231 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.90 GiB (attempt to allocate chunk of 4360416 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f2e3da94ac3 in ?
31. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.27 02:05:52.753103 [ 224 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.84 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f2e3da94ac3 in ?
31. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.27 09:03:35.098362 [ 234 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.88 GiB (attempt to allocate chunk of 4222641 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero.: (while reading column ProfileEvent_NetworkSendBytes): (while reading from part /var/lib/clickhouse/store/a51/a51efc65-fc44-4803-9d0c-ce07f9ff06af/202409_1_2273_427/ from mark 0 with max_rows_to_read = 2114): While executing MergeTreeSequentialSource. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. void DB::PODArrayBase<8ul, 4096ul, Allocator<false, false>, 63ul, 64ul>::resize<>(unsigned long) @ 0xda23ab8 in /usr/bin/clickhouse
9. ./build/./src/Common/PODArray.h:389: DB::SerializationNumber<unsigned long>::deserializeBinaryBulk(DB::IColumn&, DB::ReadBuffer&, unsigned long, double) const @ 0x170ce4bb in /usr/bin/clickhouse
10. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:209: DB::ISerialization::deserializeBinaryBulkWithMultipleStreams(COW<DB::IColumn>::immutable_ptr<DB::IColumn>&, unsigned long, DB::ISerialization::DeserializeBinaryBulkSettings&, std::shared_ptr<DB::ISerialization::DeserializeBinaryBulkState>&, std::unordered_map<String, COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>>*) const @ 0x1709e16b in /usr/bin/clickhouse
11. ./build/./src/Storages/MergeTree/MergeTreeReaderWide.cpp:0: DB::MergeTreeReaderWide::readData(DB::NameAndTypePair const&, std::shared_ptr<DB::ISerialization const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn>&, unsigned long, bool, unsigned long, unsigned long, std::unordered_map<String, COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>>&, bool) @ 0x189e4120 in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeReaderWide.cpp:157: DB::MergeTreeReaderWide::readRows(unsigned long, unsigned long, bool, unsigned long, std::vector<COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::allocator<COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>&) @ 0x189e2d93 in /usr/bin/clickhouse
13. ./build/./src/Storages/MergeTree/MergeTreeSequentialSource.cpp:182: DB::MergeTreeSequentialSource::generate() @ 0x189e7608 in /usr/bin/clickhouse
14. ./build/./src/Processors/Chunk.h:90: DB::ISource::tryGenerate() @ 0x18cd2395 in /usr/bin/clickhouse
15. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::ISource::work() @ 0x18cd1ec5 in /usr/bin/clickhouse
16. ./build/./src/Processors/Executors/ExecutionThreadContext.cpp:0: DB::ExecutionThreadContext::executeTask() @ 0x18ce950c in /usr/bin/clickhouse
17. ./build/./src/Processors/Executors/PipelineExecutor.cpp:248: DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x18cdfd7b in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/atomic:958: DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x18cdf8a9 in /usr/bin/clickhouse
19. ./build/./src/Processors/Executors/PullingPipelineExecutor.cpp:54: DB::PullingPipelineExecutor::pull(DB::Chunk&) @ 0x18cecf48 in /usr/bin/clickhouse
20. ./build/./src/Processors/Executors/PullingPipelineExecutor.cpp:0: DB::PullingPipelineExecutor::pull(DB::Block&) @ 0x18ced130 in /usr/bin/clickhouse
21. ./build/./src/Storages/MergeTree/MergeTask.cpp:521: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::executeImpl() @ 0x18811eb4 in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
25. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
27. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
28. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
29. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
31. ? @ 0x7f2e3da94ac3 in ?
 (version 23.3.2.1)
2024.10.02 22:41:10.936080 [ 1 ] {} <Warning> Context: Linux transparent hugepages are set to "always". Check /sys/kernel/mm/transparent_hugepage/enabled
2024.10.02 22:41:10.967170 [ 1 ] {} <Warning> Application: Integrity check of the executable skipped because the reference checksum could not be read.
2024.10.02 22:41:13.686550 [ 1 ] {} <Warning> Context: Table system.session_log is enabled. It's unreliable and may contain garbage. Do not use it for any kind of security monitoring.
2024.10.02 22:41:13.901230 [ 286 ] {} <Warning> system.asynchronous_metric_log (aa49c1cc-fa19-413a-b6a8-f846993856d7): Removing temporary directory /var/lib/clickhouse/store/aa4/aa49c1cc-fa19-413a-b6a8-f846993856d7/tmp_merge_202409_1_2495_1032/
2024.10.02 22:41:14.715701 [ 298 ] {} <Warning> system.metric_log (a51efc65-fc44-4803-9d0c-ce07f9ff06af): Removing temporary directory /var/lib/clickhouse/store/a51/a51efc65-fc44-4803-9d0c-ce07f9ff06af/delete_tmp_202409_1_2289_429/
2024.10.02 22:43:14.754028 [ 39 ] {08fcea98-2dc7-494a-aa2d-9ce86b38c25b} <Error> executeQuery: Code: 62. DB::Exception: Not support distance function without ORDER BY clause. (SYNTAX_ERROR) (version 23.3.2.1) (from 192.168.65.1:61870) (in query:  SELECT keywords, distance(embeddings, [0.03699438, -0.040089518, -0.064849064, -0.016746355, 0.053397097, 0.010999547, 0.0036444569, -0.01743426, 0.021367166, 0.02756787, -0.055426203, 0.023027187, -0.023926627, -0.06467651, -0.018086523, -0.030773327, -0.027391966, 0.043407705, 0.004129164, -0.01620058, -0.011294144, 0.031303287, 0.019731497, 0.0047164783, 0.053746738, -0.04445773, -0.011030656, -0.03618617, -0.020795159, 0.023311386, -0.038536396, 0.048730165, 0.0007542536, -0.0151743395, 0.0003700302, -0.057269022, -0.011442179, 0.064925924, 0.004469991, 0.009488511, 0.023872864, -0.08210364, -0.020039598, 0.015152989, -0.03455951, -0.054042786, -0.05828221, -0.0056554046, 0.005865583, -0.071073085, 0.04425871, 0.014148037, 0.06189315, 0.03481871, 0.0073301676, -0.032488443, 0.038492322, 0.011572406, 0.019825239, 0.026526352, 0.012632791, -0.011928984, 0.016074032, 0.055432256, -0.0065144887, -0.044166185, -0.022224836, -0.0008785451, 0.040924825, -0.012424532, -0.0029351765, -0.056494884, 0.025244974, -0.011784074, -0.052461334, -0.11254319, -0.019410562, 0.044913128, 0.0023883644, 0.026291382, -0.008406303, -0.043705024, -0.08495333, -0.027652573, -0.07519549, 0.033721145, -0.009692825, -0.023569351, -0.035907727, 0.018102072, -0.038564023, -0.014759392, 0.057618953, -0.044333704, -0.039962053, 0.105801076, -0.012327563, -0.0054806517, 0.007520503, -0.058296427, 0.018502992, 0.0036653425, -0.05797612, 0.058554575, 0.02739057, 0.076447316, -0.01298798, 0.050707407, -0.011958466, 0.05107749, -0.07577634, -0.037861608, 0.036007203, -0.058324285, 0.045401957, -0.02501924, -0.017445616, 0.046888944, 0.05114052, 0.038307942, 0.02882377, 0.037953768, 0.0742223, 0.004274218, 0.0088198865, 0.024424488, -0.0004095162, 0.043095827, 0.03682955, 0.014330134, 0.003208707, -0.040602606, -0.040088546, 0.026590066, 0.046391156, 0.07367876, 0.023998376, -0.025120897, 0.0035239793, -0.013285776, -0.008768575, 0.02016276, 0.0010779889, 0.043165553, 0.001310545, 0.042327337, -0.01885023, 0.023272468, 0.08018527, -0.051045116, -0.034667443, 0.00020957118, -0.06712201, -0.02379333, 0.03336453, 0.008412936, -0.03273267, 0.050669704, 0.09437578, 0.06589382, 0.039406676, 0.018450612, 0.028625293, 0.0046728887, -0.049847394, 0.015251399, -0.006554311, -0.016548678, 0.023529349, 0.0043250974, -0.0021488704, 0.089529626, -0.03804672, -0.024356285, -0.008075331, -0.015903907, -0.0058758804, 0.0004073673, -0.030676642, -0.03656273, -0.012119554, 0.004015856, -0.008629824, 0.026174987, 0.011489186, -0.021910496, 0.07312163, -0.017047336, -0.014005227, 0.0030832523, -0.02577037, -0.015560933, -0.0417329, -0.028640663, -0.023765663, 0.04488632, -0.009398627, 0.007038831, 0.035848163, -0.046222135, -0.0021941354, 0.06706701, 0.0033863278, 0.0067402194, 0.045719255, -0.0041433815, 0.026703075, -0.005650576, -0.021597635, 0.042490955, -0.019296128, 0.011165145, -0.043809336, -0.0064701163, 0.018556248, -0.009519116, 0.027139805, 0.016593011, -0.006007977, -0.029470269, -0.03905902, 0.035240978, -0.033909567, -0.0024433252, -0.004952422, 0.06523346, -0.045307893, 0.0042731264, 0.035185263, -0.027283058, -0.01846644, 0.09376739, 0.016555505, -0.0017514607, 0.078591175, -0.014939238, 0.018160552, 0.032782376, -0.006694654, 0.033134095, -0.008662764, 0.020671666, -0.021540483, 0.024259139, -0.042602215, -0.08840811, -0.015961371, 0.064084016, 0.008771312, 0.031071763, 0.0013063564, -0.016081853, -0.0035057603, -0.0062895217, -0.04520596, 0.050900925, -0.029725403, 0.0041065672, -0.007854125, 0.013407516, 0.020131478, 0.025780268, -0.003840437, -0.01289965, -0.02179761, -0.024918098, 0.05336189, -0.050594635, 0.024162801, 0.012208516, 0.025960539, 0.007266379, 0.031318214, 0.013826131, 0.015230341, 0.03474755, -0.0105011435, 0.043871213, 0.03930262, -0.053653263, 0.0060727037, 0.053199995, 0.007826698, -0.059909213, -0.014090388, -0.0092615895, -0.04947403, -0.02529563, -0.0375785, -0.045861304, -0.048001856, -0.024553498, -0.009206843, -0.032012995, -0.032333445, 0.023160346, 0.02796993, 0.03366755, 0.0019476394, -0.08939203, -0.009866293, -0.0569794, 0.03520322, -0.11132757, 0.024057008, -0.0031262173, -0.04478177, -0.057226628, 0.018165773, 0.05607867, 0.024768917, -0.03530705, -0.04702305, -0.0009087978, 0.032788023, 0.0135077955, -0.034628253, 0.0233885, -0.07506211, 0.03642665, 0.028317226, 0.088546015, 0.009478744, -0.03942127, 0.0111533, 0.07658725, -0.020805119, 0.01813683, -0.020707158, 0.034090456, -0.0041516856, -0.0077053616, -0.03633104, 0.025105936, 0.021863556, 0.026916882, -0.0981228, -0.004523251, -0.037712988, 0.018456535, 0.016205374, 0.03227894, -0.030527158, -0.053949613, 0.023964545, 0.02269021, -0.022293461, 0.03367573, 0.085209906, 0.060796294, 0.010838065, 0.12902263, -0.01694008, 0.018405084, -0.0049455087, -0.042993665, -0.01019101, -0.0033217429, 0.055764314, -0.028230106, 0.000730329, 0.026552994, 0.003957798, -0.034522787, -0.024497991, 0.014242735, -0.023903621, 0.01507725, 0.016007833, 0.03621179, -0.0085084895, -0.02287522, 0.030702623, -0.0030377535, -0.0053026974, -0.0034253176, -0.06186622, -0.063173644, -0.010933676, 0.011757615, -0.042364713, -0.018662458, 0.015349212, 0.01326398, 0.05749138, -0.011801498, 0.030677686, 0.009742563, -0.013932522, 0.0440089, -0.04352725, 0.03446055, 0.04937953, -0.015561065, 0.05242365, 0.011058239, -0.012140186, -0.047183063, 0.025291087, 0.01965361, 0.006409989, -0.024329515, -0.033837937, -0.008912799, -0.00018269588, 0.0007890399, -0.0021570618, -0.009216193, -0.035334956, 0.008073508, 0.013990948, 0.020804781, 0.039264835, -0.10574533, -0.022850022, -0.025708204, 0.013246247, -0.017094923, -0.03435561, 0.02929498, -0.016654646, 0.023595568, 0.021752797, -0.017676894, -0.06941912, -0.04577211, 0.023971343, -0.008513252, 0.006589605, 0.0050590597, 0.017276702, 0.002541564, -0.02288965, -0.032129847, -0.03235706, -0.04756713, 0.01130429, 0.025885917, 0.00027474246, -0.011692397, 0.052505635, -0.016754206, 0.007739998, 0.00031204932, -0.011126217, -0.04999242, -0.020067757, -0.02679827, 0.015927594, -0.073336825, 0.013469353, -0.0580917, -0.043998066, -0.011027563, -0.039664164, -0.005749623, 0.018272659, 0.07282008, -0.028953746, 0.008125625, 0.029799266, 0.00930479, -0.0052663796, -0.108113006, 0.011571947, -0.0032099118, 0.028925946, 0.00040189954, -0.010614756, 0.023520697, 0.039298646, 0.0041626547, 0.020949168, -0.017950444, 0.021378938, -0.0038062378, -0.06714989, 0.017683938, -0.051217444, -0.024703328, -0.0078828, 0.03254166, 0.0010553305, 0.03319834, -0.022770675, 0.021067346, -0.0009863164, 0.048314497, -0.037366938, 0.072503954, -0.032973994, -0.04739449, -0.05867264, -0.061556213, -0.01490505, 0.009413129, 0.013524396, 0.04195668, 0.009708794, 0.0115918955, -0.030000556, -0.003406723, 0.0006018104, -0.013914035, 0.056682464, -0.08217875, -0.001219442, 0.034592006, -0.01170216, -0.024157742, -0.015376954, -0.02845654, 0.0035460761, -0.012266723, 0.057166953, -0.02048005, 0.037438408, -0.0045330795, -0.00031943165, -0.01631846, -0.01245495, -0.038763992, -0.078346975, -0.002038096, 0.019253433, -0.08414125, 0.038358845, 0.036325462, -0.041629266, 0.013063169, -0.015793618, 0.05837563, -0.0706814, -0.026032368, 0.015781965, 0.03436528, 0.013275698, -0.020307407, 0.004132362, -0.0439121, 0.082610644, -0.009417679, 0.017384512, 0.068277545, -0.017448483, 0.005332682, 0.010497486, -0.05917456, -0.009461004, -0.027491445, -0.039685093, 0.014020787, 0.042099625, -0.013748909, 0.00429445, -0.013879585, 0.00036192214, 0.0014250231, 0.015838409, -0.005729923, -0.029609395, -0.012657533, -0.009822376, -0.028636726, 0.06367585, 0.009841709, -0.0040893545, -0.0016083913, 0.045984656, -0.055777512, -0.022561613, -0.05726247, 0.06032096, 0.031847216, 0.078910634, -0.024023477, -0.025755208, -0.033546302, -0.030200802, -0.004976394, 0.058450643, 0.024584055, 0.01462004, 0.06358059, -0.004168876, 0.030705746, 0.03965261, 0.06868595, 0.052272663, -0.002557367, -0.017804824, 0.014052447, -0.011136537, -0.006610256, 0.02557463, 0.023084363, 0.037227098, -0.019117171, -0.0076187295, -0.01615469, 0.014430799, -0.06576304, 0.049786743, -0.0141218025, 0.0027244764, 0.03613718, -0.018096369, 0.0052798274, 0.020776577, 0.030618723, -0.008130019, -0.038449273, 0.015559043, -0.052439686, -0.022446053, -0.0300201, 0.062337894, -0.03221063, -0.02144594, -0.011290945, -0.013556042, 0.02742661, 0.02013747, -0.023218554, 0.009589082, 0.016736591, -0.0005807484, 0.00013909032, 0.085036464, 0.038106408, 0.021597024, 0.02178403, 0.018013647, 0.009632963, -0.025870504, 0.0063394234, -0.021679161, 0.011654006, 0.00762929, -0.01497246, -0.076975584, 0.005404775, 0.036844432, -0.02355763, -0.015521761, 0.05999857, 0.009588825, -0.09448155, -0.0077713546, -0.011029748, 0.0030538219, 0.012367527, 0.030350346, -0.049445428, 0.0039242823, -0.013819624, -0.03415084, -0.008133336, 0.0878895, -0.0046882555, -0.049495995, 0.008406013, -0.017823445, -0.0021215093, -0.027740017, -0.014728463, -0.027044287, -0.058870573, -0.031761892, 0.00088360155, -0.04108465, 0.08357774, 0.028615639, -0.017514495, 0.020811848, -0.001628287, -0.01244699, -0.0068482254, 0.015220526, -0.0013649927, -0.0026609127, 0.031167706, -0.0005389089, 0.03932212, -0.014842763, 0.072785966, -0.009019472, 0.013104402, -0.030209247, -0.016053982, 0.054317616, 0.0021747216, -0.046264, 0.02437336, 0.07458065, 0.03125905, -0.089877725, -0.022951107, 0.03068962, 0.031759605, -0.028261038, -0.061399035, -0.0026744113, 0.03077485, 0.05964815, 0.02123617, 0.006204028, 0.017600993, 0.019899257, 0.036894497, 0.047271047, -0.021611892, -0.027172612, 0.04521311, -0.015572926, -0.026682043, 0.004856933, 0.02866872, -0.0033389323, 0.07078031, 0.051183514, 0.030393064, 0.065503135, -0.022367178, -0.0632898, 0.045625035, -0.015985426, -0.0025249105, -0.007823751, 0.0039300434, 0.05045026, -0.04638493, 0.0030467995, 0.01687344, -0.044307783, 0.06332948, 0.011980257, 0.048224032, 0.0012050231, -0.11291813, -0.020754946, 0.00052623695, 0.0025405032, 0.05242986, 0.029035084, -0.010089483, -0.014904519, -0.0036358065, 0.004798264, -0.0036547978, -0.036878455, -0.023304243, -0.03088867, 0.047965094, 0.05376685, -0.046020027, -0.030424504, 0.0015687464, -0.021906087, 0.0071473517, -0.033671364, 0.0064924904, 0.0054803286, 0.04393574, -0.014034028, -0.008778806, -0.024371734, 0.02096771]) as dist FROM default.keywords FORMAT Native), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::Exception<String&>(int, FormatStringHelperImpl<std::type_identity<String&>::type>, String&) @ 0xdd9bba4 in /usr/bin/clickhouse
3. ./build/./src/Interpreters/TreeRewriter.cpp:941: DB::TreeRewriter::analyzeSelect(std::shared_ptr<DB::IAST>&, DB::TreeRewriterResult&&, DB::SelectQueryOptions const&, std::vector<DB::TableWithColumnNamesAndTypes, std::allocator<DB::TableWithColumnNamesAndTypes>> const&, std::vector<String, std::allocator<String>> const&, std::shared_ptr<DB::TableJoin>, bool, std::unordered_map<String, String, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, String>>>, std::unordered_map<String, String, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, String>>>) const @ 0x17ec58e7 in /usr/bin/clickhouse
4. ./build/./contrib/llvm-project/libcxx/include/__utility/swap.h:37: DB::InterpreterSelectQuery::InterpreterSelectQuery(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context> const&, std::optional<DB::Pipe>, std::shared_ptr<DB::IStorage> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::shared_ptr<DB::PreparedSets>)::$_0::operator()(bool) const @ 0x17c0ac9c in /usr/bin/clickhouse
5. ./build/./src/Interpreters/InterpreterSelectQuery.cpp:0: DB::InterpreterSelectQuery::InterpreterSelectQuery(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context> const&, std::optional<DB::Pipe>, std::shared_ptr<DB::IStorage> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::shared_ptr<DB::PreparedSets>) @ 0x17c07875 in /usr/bin/clickhouse
6. ./build/./contrib/llvm-project/libcxx/include/optional:260: DB::InterpreterSelectQuery::InterpreterSelectQuery(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x17c04c31 in /usr/bin/clickhouse
7. ./build/./src/Interpreters/InterpreterSelectWithUnionQuery.cpp:257: DB::InterpreterSelectWithUnionQuery::buildCurrentChildInterpreter(std::shared_ptr<DB::IAST> const&, std::vector<String, std::allocator<String>> const&) @ 0x17c9093a in /usr/bin/clickhouse
8. ./build/./src/Interpreters/InterpreterSelectWithUnionQuery.cpp:152: DB::InterpreterSelectWithUnionQuery::InterpreterSelectWithUnionQuery(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context>, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x17c8e888 in /usr/bin/clickhouse
9. ./build/./contrib/llvm-project/libcxx/include/vector:434: std::__unique_if<DB::InterpreterSelectWithUnionQuery>::__unique_single std::make_unique[abi:v15000]<DB::InterpreterSelectWithUnionQuery, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::Context>&, DB::SelectQueryOptions const&>(std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::Context>&, DB::SelectQueryOptions const&) @ 0x17bcce93 in /usr/bin/clickhouse
10. ./build/./src/Interpreters/InterpreterFactory.cpp:0: DB::InterpreterFactory::get(std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::Context>, DB::SelectQueryOptions const&) @ 0x17bcc0b5 in /usr/bin/clickhouse
11. ./build/./src/Interpreters/executeQuery.cpp:0: DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x17f5cf2c in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:612: DB::executeQuery(DB::ReadBuffer&, DB::WriteBuffer&, bool, std::shared_ptr<DB::Context>, std::function<void (DB::QueryResultDetails const&)>, std::optional<DB::FormatSettings> const&) @ 0x17f6a022 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/optional:260: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c4a8e0 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
15. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
16. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
18. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
19. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
20. ? @ 0x7fbe27a94ac3 in ?
21. ? @ 0x7fbe27b26850 in ?

2024.10.02 22:43:14.758495 [ 39 ] {08fcea98-2dc7-494a-aa2d-9ce86b38c25b} <Error> DynamicQueryHandler: Code: 62. DB::Exception: Not support distance function without ORDER BY clause. (SYNTAX_ERROR), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::Exception<String&>(int, FormatStringHelperImpl<std::type_identity<String&>::type>, String&) @ 0xdd9bba4 in /usr/bin/clickhouse
3. ./build/./src/Interpreters/TreeRewriter.cpp:941: DB::TreeRewriter::analyzeSelect(std::shared_ptr<DB::IAST>&, DB::TreeRewriterResult&&, DB::SelectQueryOptions const&, std::vector<DB::TableWithColumnNamesAndTypes, std::allocator<DB::TableWithColumnNamesAndTypes>> const&, std::vector<String, std::allocator<String>> const&, std::shared_ptr<DB::TableJoin>, bool, std::unordered_map<String, String, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, String>>>, std::unordered_map<String, String, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, String>>>) const @ 0x17ec58e7 in /usr/bin/clickhouse
4. ./build/./contrib/llvm-project/libcxx/include/__utility/swap.h:37: DB::InterpreterSelectQuery::InterpreterSelectQuery(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context> const&, std::optional<DB::Pipe>, std::shared_ptr<DB::IStorage> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::shared_ptr<DB::PreparedSets>)::$_0::operator()(bool) const @ 0x17c0ac9c in /usr/bin/clickhouse
5. ./build/./src/Interpreters/InterpreterSelectQuery.cpp:0: DB::InterpreterSelectQuery::InterpreterSelectQuery(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context> const&, std::optional<DB::Pipe>, std::shared_ptr<DB::IStorage> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::shared_ptr<DB::PreparedSets>) @ 0x17c07875 in /usr/bin/clickhouse
6. ./build/./contrib/llvm-project/libcxx/include/optional:260: DB::InterpreterSelectQuery::InterpreterSelectQuery(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x17c04c31 in /usr/bin/clickhouse
7. ./build/./src/Interpreters/InterpreterSelectWithUnionQuery.cpp:257: DB::InterpreterSelectWithUnionQuery::buildCurrentChildInterpreter(std::shared_ptr<DB::IAST> const&, std::vector<String, std::allocator<String>> const&) @ 0x17c9093a in /usr/bin/clickhouse
8. ./build/./src/Interpreters/InterpreterSelectWithUnionQuery.cpp:152: DB::InterpreterSelectWithUnionQuery::InterpreterSelectWithUnionQuery(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context>, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x17c8e888 in /usr/bin/clickhouse
9. ./build/./contrib/llvm-project/libcxx/include/vector:434: std::__unique_if<DB::InterpreterSelectWithUnionQuery>::__unique_single std::make_unique[abi:v15000]<DB::InterpreterSelectWithUnionQuery, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::Context>&, DB::SelectQueryOptions const&>(std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::Context>&, DB::SelectQueryOptions const&) @ 0x17bcce93 in /usr/bin/clickhouse
10. ./build/./src/Interpreters/InterpreterFactory.cpp:0: DB::InterpreterFactory::get(std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::Context>, DB::SelectQueryOptions const&) @ 0x17bcc0b5 in /usr/bin/clickhouse
11. ./build/./src/Interpreters/executeQuery.cpp:0: DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x17f5cf2c in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:612: DB::executeQuery(DB::ReadBuffer&, DB::WriteBuffer&, bool, std::shared_ptr<DB::Context>, std::function<void (DB::QueryResultDetails const&)>, std::optional<DB::FormatSettings> const&) @ 0x17f6a022 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/optional:260: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c4a8e0 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
15. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
16. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
18. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
19. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
20. ? @ 0x7fbe27a94ac3 in ?
21. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.02 23:17:12.797191 [ 281 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.84 GiB (attempt to allocate chunk of 4360432 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.02 23:19:43.571018 [ 281 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.84 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.02 23:24:45.508666 [ 253 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.84 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.02 23:26:38.751863 [ 236 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.85 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.02 23:27:17.064060 [ 238 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.80 GiB (attempt to allocate chunk of 4360368 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.02 23:29:47.711820 [ 224 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.82 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.02 23:32:18.508434 [ 234 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.02 23:34:49.529560 [ 230 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.85 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.02 23:36:42.559438 [ 245 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.02 23:39:13.303580 [ 239 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.02 23:43:38.065800 [ 257 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.02 23:45:30.830469 [ 245 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.82 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.02 23:46:09.549514 [ 240 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.81 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.02 23:49:18.236452 [ 258 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4218217 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero.: (while reading column ProfileEvent_CreatedLogEntryForBuildVIndex): (while reading from part /var/lib/clickhouse/store/a51/a51efc65-fc44-4803-9d0c-ce07f9ff06af/202410_2302_2837_107/ from mark 0 with max_rows_to_read = 2114): While executing MergeTreeSequentialSource. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:80: DB::CompressedReadBufferFromFile::readBig(char*, unsigned long) @ 0x16f2bbf3 in /usr/bin/clickhouse
10. ./build/./src/DataTypes/Serializations/SerializationNumber.cpp:155: DB::SerializationNumber<unsigned long>::deserializeBinaryBulk(DB::IColumn&, DB::ReadBuffer&, unsigned long, double) const @ 0x170ce4d7 in /usr/bin/clickhouse
11. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:209: DB::ISerialization::deserializeBinaryBulkWithMultipleStreams(COW<DB::IColumn>::immutable_ptr<DB::IColumn>&, unsigned long, DB::ISerialization::DeserializeBinaryBulkSettings&, std::shared_ptr<DB::ISerialization::DeserializeBinaryBulkState>&, std::unordered_map<String, COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>>*) const @ 0x1709e16b in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeReaderWide.cpp:0: DB::MergeTreeReaderWide::readData(DB::NameAndTypePair const&, std::shared_ptr<DB::ISerialization const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn>&, unsigned long, bool, unsigned long, unsigned long, std::unordered_map<String, COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>>&, bool) @ 0x189e4120 in /usr/bin/clickhouse
13. ./build/./src/Storages/MergeTree/MergeTreeReaderWide.cpp:157: DB::MergeTreeReaderWide::readRows(unsigned long, unsigned long, bool, unsigned long, std::vector<COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::allocator<COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>&) @ 0x189e2d93 in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/MergeTreeSequentialSource.cpp:182: DB::MergeTreeSequentialSource::generate() @ 0x189e7608 in /usr/bin/clickhouse
15. ./build/./src/Processors/Chunk.h:90: DB::ISource::tryGenerate() @ 0x18cd2395 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::ISource::work() @ 0x18cd1ec5 in /usr/bin/clickhouse
17. ./build/./src/Processors/Executors/ExecutionThreadContext.cpp:0: DB::ExecutionThreadContext::executeTask() @ 0x18ce950c in /usr/bin/clickhouse
18. ./build/./src/Processors/Executors/PipelineExecutor.cpp:248: DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x18cdfd7b in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/atomic:958: DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x18cdf8a9 in /usr/bin/clickhouse
20. ./build/./src/Processors/Executors/PullingPipelineExecutor.cpp:54: DB::PullingPipelineExecutor::pull(DB::Chunk&) @ 0x18cecf48 in /usr/bin/clickhouse
21. ./build/./src/Processors/Executors/PullingPipelineExecutor.cpp:0: DB::PullingPipelineExecutor::pull(DB::Block&) @ 0x18ced130 in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:521: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::executeImpl() @ 0x18811eb4 in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
25. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
26. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
27. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
29. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
30. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
31. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.02 23:53:41.597942 [ 234 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.82 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.02 23:56:12.746647 [ 281 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.81 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.03 00:01:14.708777 [ 247 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.88 GiB (attempt to allocate chunk of 4360432 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.03 00:03:45.684705 [ 235 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.03 00:07:31.867902 [ 239 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.84 GiB (attempt to allocate chunk of 4360368 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.03 00:08:09.710573 [ 257 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.89 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.03 00:10:02.809477 [ 224 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.89 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.03 00:14:26.804156 [ 281 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.03 00:15:04.733314 [ 257 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.85 GiB (attempt to allocate chunk of 4196403 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero.: (while reading column ProfileEvent_SelectedBytes): (while reading from part /var/lib/clickhouse/store/a51/a51efc65-fc44-4803-9d0c-ce07f9ff06af/202410_2302_3042_148/ from mark 0 with max_rows_to_read = 2114): While executing MergeTreeSequentialSource. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:0: CurrentMemoryTracker::realloc(long, long) @ 0x1271b089 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:141: Allocator<false, false>::realloc(void*, unsigned long, unsigned long, unsigned long) @ 0x12718827 in /usr/bin/clickhouse
8. ./build/./src/Common/PODArray.h:0: DB::CompressedReadBufferBase::readCompressedData(unsigned long&, unsigned long&, bool) @ 0x16f29d56 in /usr/bin/clickhouse
9. ./build/./src/Compression/CompressedReadBufferFromFile.cpp:122: DB::CompressedReadBufferFromFile::readBig(char*, unsigned long) @ 0x16f2ba1a in /usr/bin/clickhouse
10. ./build/./src/DataTypes/Serializations/SerializationNumber.cpp:155: DB::SerializationNumber<unsigned long>::deserializeBinaryBulk(DB::IColumn&, DB::ReadBuffer&, unsigned long, double) const @ 0x170ce4d7 in /usr/bin/clickhouse
11. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:209: DB::ISerialization::deserializeBinaryBulkWithMultipleStreams(COW<DB::IColumn>::immutable_ptr<DB::IColumn>&, unsigned long, DB::ISerialization::DeserializeBinaryBulkSettings&, std::shared_ptr<DB::ISerialization::DeserializeBinaryBulkState>&, std::unordered_map<String, COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>>*) const @ 0x1709e16b in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeReaderWide.cpp:0: DB::MergeTreeReaderWide::readData(DB::NameAndTypePair const&, std::shared_ptr<DB::ISerialization const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn>&, unsigned long, bool, unsigned long, unsigned long, std::unordered_map<String, COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>>&, bool) @ 0x189e4120 in /usr/bin/clickhouse
13. ./build/./src/Storages/MergeTree/MergeTreeReaderWide.cpp:157: DB::MergeTreeReaderWide::readRows(unsigned long, unsigned long, bool, unsigned long, std::vector<COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::allocator<COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>&) @ 0x189e2d93 in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/MergeTreeSequentialSource.cpp:182: DB::MergeTreeSequentialSource::generate() @ 0x189e7608 in /usr/bin/clickhouse
15. ./build/./src/Processors/Chunk.h:90: DB::ISource::tryGenerate() @ 0x18cd2395 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::ISource::work() @ 0x18cd1ec5 in /usr/bin/clickhouse
17. ./build/./src/Processors/Executors/ExecutionThreadContext.cpp:0: DB::ExecutionThreadContext::executeTask() @ 0x18ce950c in /usr/bin/clickhouse
18. ./build/./src/Processors/Executors/PipelineExecutor.cpp:248: DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x18cdfd7b in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/atomic:958: DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x18cdf8a9 in /usr/bin/clickhouse
20. ./build/./src/Processors/Executors/PullingPipelineExecutor.cpp:54: DB::PullingPipelineExecutor::pull(DB::Chunk&) @ 0x18cecf48 in /usr/bin/clickhouse
21. ./build/./src/Processors/Executors/PullingPipelineExecutor.cpp:0: DB::PullingPipelineExecutor::pull(DB::Block&) @ 0x18ced130 in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:521: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::executeImpl() @ 0x18811eb4 in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
25. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
26. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
27. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
29. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
30. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
31. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.03 00:16:57.984320 [ 237 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360432 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.03 00:19:29.109854 [ 282 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.84 GiB (attempt to allocate chunk of 4360368 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.03 00:21:59.584370 [ 234 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.03 00:24:30.795994 [ 240 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.84 GiB (attempt to allocate chunk of 4224197 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero.: (while reading column ProfileEvent_RejectedInserts): (while reading from part /var/lib/clickhouse/store/a51/a51efc65-fc44-4803-9d0c-ce07f9ff06af/202410_2302_3117_163/ from mark 0 with max_rows_to_read = 2114): While executing MergeTreeSequentialSource. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:80: DB::CompressedReadBufferFromFile::readBig(char*, unsigned long) @ 0x16f2bbf3 in /usr/bin/clickhouse
10. ./build/./src/DataTypes/Serializations/SerializationNumber.cpp:155: DB::SerializationNumber<unsigned long>::deserializeBinaryBulk(DB::IColumn&, DB::ReadBuffer&, unsigned long, double) const @ 0x170ce4d7 in /usr/bin/clickhouse
11. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:209: DB::ISerialization::deserializeBinaryBulkWithMultipleStreams(COW<DB::IColumn>::immutable_ptr<DB::IColumn>&, unsigned long, DB::ISerialization::DeserializeBinaryBulkSettings&, std::shared_ptr<DB::ISerialization::DeserializeBinaryBulkState>&, std::unordered_map<String, COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>>*) const @ 0x1709e16b in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeReaderWide.cpp:0: DB::MergeTreeReaderWide::readData(DB::NameAndTypePair const&, std::shared_ptr<DB::ISerialization const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn>&, unsigned long, bool, unsigned long, unsigned long, std::unordered_map<String, COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>>&, bool) @ 0x189e4120 in /usr/bin/clickhouse
13. ./build/./src/Storages/MergeTree/MergeTreeReaderWide.cpp:157: DB::MergeTreeReaderWide::readRows(unsigned long, unsigned long, bool, unsigned long, std::vector<COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::allocator<COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>&) @ 0x189e2d93 in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/MergeTreeSequentialSource.cpp:182: DB::MergeTreeSequentialSource::generate() @ 0x189e7608 in /usr/bin/clickhouse
15. ./build/./src/Processors/Chunk.h:90: DB::ISource::tryGenerate() @ 0x18cd2395 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::ISource::work() @ 0x18cd1ec5 in /usr/bin/clickhouse
17. ./build/./src/Processors/Executors/ExecutionThreadContext.cpp:0: DB::ExecutionThreadContext::executeTask() @ 0x18ce950c in /usr/bin/clickhouse
18. ./build/./src/Processors/Executors/PipelineExecutor.cpp:248: DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x18cdfd7b in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/atomic:958: DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x18cdf8a9 in /usr/bin/clickhouse
20. ./build/./src/Processors/Executors/PullingPipelineExecutor.cpp:54: DB::PullingPipelineExecutor::pull(DB::Chunk&) @ 0x18cecf48 in /usr/bin/clickhouse
21. ./build/./src/Processors/Executors/PullingPipelineExecutor.cpp:0: DB::PullingPipelineExecutor::pull(DB::Block&) @ 0x18ced130 in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:521: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::executeImpl() @ 0x18811eb4 in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
25. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
26. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
27. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
29. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
30. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
31. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.03 00:27:01.648335 [ 236 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.89 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.03 00:28:54.851054 [ 239 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.90 GiB (attempt to allocate chunk of 4360432 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.03 00:31:25.829837 [ 238 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.89 GiB (attempt to allocate chunk of 4360368 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.03 00:33:18.914183 [ 258 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.94 GiB (attempt to allocate chunk of 4360448 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.03 00:35:11.807419 [ 258 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.89 GiB (attempt to allocate chunk of 4360448 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.03 00:38:20.698936 [ 253 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.92 GiB (attempt to allocate chunk of 4360432 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.03 00:40:13.644612 [ 245 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.92 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.03 00:40:51.698127 [ 247 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.86 GiB (attempt to allocate chunk of 4360432 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.03 00:42:44.677346 [ 253 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.96 GiB (attempt to allocate chunk of 4360448 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.03 00:45:16.295696 [ 234 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.93 GiB (attempt to allocate chunk of 4360368 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.03 00:45:53.608210 [ 247 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.82 GiB (attempt to allocate chunk of 4360448 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.03 00:47:46.605661 [ 224 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.88 GiB (attempt to allocate chunk of 4360432 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.03 04:25:46.737274 [ 247 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.85 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.03 05:32:06.800337 [ 236 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.85 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.03 06:02:28.728626 [ 247 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.82 GiB (attempt to allocate chunk of 4360336 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:157: DB::WriteBufferFromFileBase::WriteBufferFromFileBase(unsigned long, char*, unsigned long) @ 0x127a5e2c in /usr/bin/clickhouse
10. ./build/./src/IO/WriteBufferFromFileDescriptor.cpp:93: DB::WriteBufferFromFileDescriptor::WriteBufferFromFileDescriptor(int, unsigned long, char*, unsigned long, String) @ 0x127a599b in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::WriteBufferFromFile::WriteBufferFromFile(String const&, unsigned long, int, unsigned int, char*, unsigned long) @ 0x12825d14 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/string:1499: std::__unique_if<DB::WriteBufferFromFile>::__unique_single std::make_unique[abi:v15000]<DB::WriteBufferFromFile, std::__fs::filesystem::path, unsigned long&, int&>(std::__fs::filesystem::path&&, unsigned long&, int&) @ 0x1717a40f in /usr/bin/clickhouse
13. ./build/./src/Disks/DiskLocal.cpp:0: DB::DiskLocal::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1717144d in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/DataPartStorageOnDiskFull.cpp:0: DB::DataPartStorageOnDiskFull::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1878a0c5 in /usr/bin/clickhouse
15. ./build/./src/Storages/MergeTree/IDataPartStorage.h:0: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f41e4 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
17. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
20. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
24. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
27. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
28. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
29. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
31. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.03 07:47:25.110110 [ 282 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.90 GiB (attempt to allocate chunk of 4360448 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:157: DB::WriteBufferFromFileBase::WriteBufferFromFileBase(unsigned long, char*, unsigned long) @ 0x127a5e2c in /usr/bin/clickhouse
10. ./build/./src/IO/WriteBufferFromFileDescriptor.cpp:93: DB::WriteBufferFromFileDescriptor::WriteBufferFromFileDescriptor(int, unsigned long, char*, unsigned long, String) @ 0x127a599b in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::WriteBufferFromFile::WriteBufferFromFile(String const&, unsigned long, int, unsigned int, char*, unsigned long) @ 0x12825d14 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/string:1499: std::__unique_if<DB::WriteBufferFromFile>::__unique_single std::make_unique[abi:v15000]<DB::WriteBufferFromFile, std::__fs::filesystem::path, unsigned long&, int&>(std::__fs::filesystem::path&&, unsigned long&, int&) @ 0x1717a40f in /usr/bin/clickhouse
13. ./build/./src/Disks/DiskLocal.cpp:0: DB::DiskLocal::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1717144d in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/DataPartStorageOnDiskFull.cpp:0: DB::DataPartStorageOnDiskFull::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1878a0c5 in /usr/bin/clickhouse
15. ./build/./src/Storages/MergeTree/IDataPartStorage.h:0: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f41e4 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
17. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
20. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
24. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
27. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
28. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
29. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
31. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.03 07:48:56.881907 [ 245 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.88 GiB (attempt to allocate chunk of 4360448 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:157: DB::WriteBufferFromFileBase::WriteBufferFromFileBase(unsigned long, char*, unsigned long) @ 0x127a5e2c in /usr/bin/clickhouse
10. ./build/./src/IO/WriteBufferFromFileDescriptor.cpp:93: DB::WriteBufferFromFileDescriptor::WriteBufferFromFileDescriptor(int, unsigned long, char*, unsigned long, String) @ 0x127a599b in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::WriteBufferFromFile::WriteBufferFromFile(String const&, unsigned long, int, unsigned int, char*, unsigned long) @ 0x12825d14 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/string:1499: std::__unique_if<DB::WriteBufferFromFile>::__unique_single std::make_unique[abi:v15000]<DB::WriteBufferFromFile, std::__fs::filesystem::path, unsigned long&, int&>(std::__fs::filesystem::path&&, unsigned long&, int&) @ 0x1717a40f in /usr/bin/clickhouse
13. ./build/./src/Disks/DiskLocal.cpp:0: DB::DiskLocal::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1717144d in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/DataPartStorageOnDiskFull.cpp:0: DB::DataPartStorageOnDiskFull::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1878a0c5 in /usr/bin/clickhouse
15. ./build/./src/Storages/MergeTree/IDataPartStorage.h:0: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f41e4 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
17. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
20. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
24. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
27. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
28. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
29. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
31. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.03 08:46:18.024541 [ 282 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.85 GiB (attempt to allocate chunk of 4360432 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:157: DB::WriteBufferFromFileBase::WriteBufferFromFileBase(unsigned long, char*, unsigned long) @ 0x127a5e2c in /usr/bin/clickhouse
10. ./build/./src/IO/WriteBufferFromFileDescriptor.cpp:93: DB::WriteBufferFromFileDescriptor::WriteBufferFromFileDescriptor(int, unsigned long, char*, unsigned long, String) @ 0x127a599b in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::WriteBufferFromFile::WriteBufferFromFile(String const&, unsigned long, int, unsigned int, char*, unsigned long) @ 0x12825d14 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/string:1499: std::__unique_if<DB::WriteBufferFromFile>::__unique_single std::make_unique[abi:v15000]<DB::WriteBufferFromFile, std::__fs::filesystem::path, unsigned long&, int&>(std::__fs::filesystem::path&&, unsigned long&, int&) @ 0x1717a40f in /usr/bin/clickhouse
13. ./build/./src/Disks/DiskLocal.cpp:0: DB::DiskLocal::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1717144d in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/DataPartStorageOnDiskFull.cpp:0: DB::DataPartStorageOnDiskFull::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1878a0c5 in /usr/bin/clickhouse
15. ./build/./src/Storages/MergeTree/IDataPartStorage.h:0: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f41e4 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
17. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
20. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
24. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
27. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
28. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
29. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
31. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.03 08:47:03.984294 [ 245 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.92 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:157: DB::WriteBufferFromFileBase::WriteBufferFromFileBase(unsigned long, char*, unsigned long) @ 0x127a5e2c in /usr/bin/clickhouse
10. ./build/./src/IO/WriteBufferFromFileDescriptor.cpp:93: DB::WriteBufferFromFileDescriptor::WriteBufferFromFileDescriptor(int, unsigned long, char*, unsigned long, String) @ 0x127a599b in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::WriteBufferFromFile::WriteBufferFromFile(String const&, unsigned long, int, unsigned int, char*, unsigned long) @ 0x12825d14 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/string:1499: std::__unique_if<DB::WriteBufferFromFile>::__unique_single std::make_unique[abi:v15000]<DB::WriteBufferFromFile, std::__fs::filesystem::path, unsigned long&, int&>(std::__fs::filesystem::path&&, unsigned long&, int&) @ 0x1717a40f in /usr/bin/clickhouse
13. ./build/./src/Disks/DiskLocal.cpp:0: DB::DiskLocal::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1717144d in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/DataPartStorageOnDiskFull.cpp:0: DB::DataPartStorageOnDiskFull::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1878a0c5 in /usr/bin/clickhouse
15. ./build/./src/Storages/MergeTree/IDataPartStorage.h:0: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f41e4 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
17. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
20. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
24. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
27. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
28. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
29. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
31. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.03 09:07:48.166093 [ 281 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.87 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:157: DB::WriteBufferFromFileBase::WriteBufferFromFileBase(unsigned long, char*, unsigned long) @ 0x127a5e2c in /usr/bin/clickhouse
10. ./build/./src/IO/WriteBufferFromFileDescriptor.cpp:93: DB::WriteBufferFromFileDescriptor::WriteBufferFromFileDescriptor(int, unsigned long, char*, unsigned long, String) @ 0x127a599b in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::WriteBufferFromFile::WriteBufferFromFile(String const&, unsigned long, int, unsigned int, char*, unsigned long) @ 0x12825d14 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/string:1499: std::__unique_if<DB::WriteBufferFromFile>::__unique_single std::make_unique[abi:v15000]<DB::WriteBufferFromFile, std::__fs::filesystem::path, unsigned long&, int&>(std::__fs::filesystem::path&&, unsigned long&, int&) @ 0x1717a40f in /usr/bin/clickhouse
13. ./build/./src/Disks/DiskLocal.cpp:0: DB::DiskLocal::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1717144d in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/DataPartStorageOnDiskFull.cpp:0: DB::DataPartStorageOnDiskFull::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1878a0c5 in /usr/bin/clickhouse
15. ./build/./src/Storages/MergeTree/IDataPartStorage.h:0: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f41e4 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
17. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
20. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
24. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
27. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
28. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
29. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
31. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.03 11:15:08.430728 [ 224 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.85 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:157: DB::WriteBufferFromFileBase::WriteBufferFromFileBase(unsigned long, char*, unsigned long) @ 0x127a5e2c in /usr/bin/clickhouse
10. ./build/./src/IO/WriteBufferFromFileDescriptor.cpp:93: DB::WriteBufferFromFileDescriptor::WriteBufferFromFileDescriptor(int, unsigned long, char*, unsigned long, String) @ 0x127a599b in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::WriteBufferFromFile::WriteBufferFromFile(String const&, unsigned long, int, unsigned int, char*, unsigned long) @ 0x12825d14 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/string:1499: std::__unique_if<DB::WriteBufferFromFile>::__unique_single std::make_unique[abi:v15000]<DB::WriteBufferFromFile, std::__fs::filesystem::path, unsigned long&, int&>(std::__fs::filesystem::path&&, unsigned long&, int&) @ 0x1717a40f in /usr/bin/clickhouse
13. ./build/./src/Disks/DiskLocal.cpp:0: DB::DiskLocal::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1717144d in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/DataPartStorageOnDiskFull.cpp:0: DB::DataPartStorageOnDiskFull::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1878a0c5 in /usr/bin/clickhouse
15. ./build/./src/Storages/MergeTree/IDataPartStorage.h:0: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f41e4 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
17. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
20. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
24. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
27. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
28. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
29. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
31. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.03 13:27:40.824770 [ 245 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.90 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:157: DB::WriteBufferFromFileBase::WriteBufferFromFileBase(unsigned long, char*, unsigned long) @ 0x127a5e2c in /usr/bin/clickhouse
10. ./build/./src/IO/WriteBufferFromFileDescriptor.cpp:93: DB::WriteBufferFromFileDescriptor::WriteBufferFromFileDescriptor(int, unsigned long, char*, unsigned long, String) @ 0x127a599b in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::WriteBufferFromFile::WriteBufferFromFile(String const&, unsigned long, int, unsigned int, char*, unsigned long) @ 0x12825d14 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/string:1499: std::__unique_if<DB::WriteBufferFromFile>::__unique_single std::make_unique[abi:v15000]<DB::WriteBufferFromFile, std::__fs::filesystem::path, unsigned long&, int&>(std::__fs::filesystem::path&&, unsigned long&, int&) @ 0x1717a40f in /usr/bin/clickhouse
13. ./build/./src/Disks/DiskLocal.cpp:0: DB::DiskLocal::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1717144d in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/DataPartStorageOnDiskFull.cpp:0: DB::DataPartStorageOnDiskFull::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1878a0c5 in /usr/bin/clickhouse
15. ./build/./src/Storages/MergeTree/IDataPartStorage.h:0: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f41e4 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
17. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
20. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
24. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
27. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
28. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
29. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
31. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.03 13:29:56.139866 [ 238 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.85 GiB (attempt to allocate chunk of 4360624 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:157: DB::WriteBufferFromFileBase::WriteBufferFromFileBase(unsigned long, char*, unsigned long) @ 0x127a5e2c in /usr/bin/clickhouse
10. ./build/./src/IO/WriteBufferFromFileDescriptor.cpp:93: DB::WriteBufferFromFileDescriptor::WriteBufferFromFileDescriptor(int, unsigned long, char*, unsigned long, String) @ 0x127a599b in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::WriteBufferFromFile::WriteBufferFromFile(String const&, unsigned long, int, unsigned int, char*, unsigned long) @ 0x12825d14 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/string:1499: std::__unique_if<DB::WriteBufferFromFile>::__unique_single std::make_unique[abi:v15000]<DB::WriteBufferFromFile, std::__fs::filesystem::path, unsigned long&, int&>(std::__fs::filesystem::path&&, unsigned long&, int&) @ 0x1717a40f in /usr/bin/clickhouse
13. ./build/./src/Disks/DiskLocal.cpp:0: DB::DiskLocal::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1717144d in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/DataPartStorageOnDiskFull.cpp:0: DB::DataPartStorageOnDiskFull::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1878a0c5 in /usr/bin/clickhouse
15. ./build/./src/Storages/MergeTree/IDataPartStorage.h:0: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f41e4 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
17. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
20. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
24. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
27. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
28. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
29. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
31. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.09 22:34:38.711008 [ 1 ] {} <Warning> Context: Linux transparent hugepages are set to "always". Check /sys/kernel/mm/transparent_hugepage/enabled
2024.10.09 22:34:38.718422 [ 1 ] {} <Warning> Application: Integrity check of the executable skipped because the reference checksum could not be read.
2024.10.09 22:34:39.368593 [ 1 ] {} <Warning> Context: Table system.session_log is enabled. It's unreliable and may contain garbage. Do not use it for any kind of security monitoring.
2024.10.09 22:34:39.423047 [ 287 ] {} <Warning> system.asynchronous_metric_log (aa49c1cc-fa19-413a-b6a8-f846993856d7): Removing temporary directory /var/lib/clickhouse/store/aa4/aa49c1cc-fa19-413a-b6a8-f846993856d7/tmp_merge_202410_2502_4894_1213/
2024.10.09 22:34:39.429930 [ 301 ] {} <Warning> system.trace_log (a7f71b1f-e269-40f0-ae81-52767f9cda4a): Removing temporary directory /var/lib/clickhouse/store/a7f/a7f71b1f-e269-40f0-ae81-52767f9cda4a/delete_tmp_202410_2832_3290_172/
2024.10.09 22:34:39.432879 [ 287 ] {} <Warning> system.asynchronous_metric_log (aa49c1cc-fa19-413a-b6a8-f846993856d7): Removing temporary directory /var/lib/clickhouse/store/aa4/aa49c1cc-fa19-413a-b6a8-f846993856d7/delete_tmp_202410_2502_4892_1211/
2024.10.09 22:34:39.742630 [ 298 ] {} <Warning> system.metric_log (a51efc65-fc44-4803-9d0c-ce07f9ff06af): Removing temporary directory /var/lib/clickhouse/store/a51/a51efc65-fc44-4803-9d0c-ce07f9ff06af/delete_tmp_202410_2302_4457_397/
2024.10.09 22:34:40.325985 [ 298 ] {} <Warning> system.metric_log (a51efc65-fc44-4803-9d0c-ce07f9ff06af): Removing temporary directory /var/lib/clickhouse/store/a51/a51efc65-fc44-4803-9d0c-ce07f9ff06af/tmp_merge_202410_4506_4508_1/
2024.10.09 22:37:42.717858 [ 230 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.86 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:157: DB::WriteBufferFromFileBase::WriteBufferFromFileBase(unsigned long, char*, unsigned long) @ 0x127a5e2c in /usr/bin/clickhouse
10. ./build/./src/IO/WriteBufferFromFileDescriptor.cpp:93: DB::WriteBufferFromFileDescriptor::WriteBufferFromFileDescriptor(int, unsigned long, char*, unsigned long, String) @ 0x127a599b in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::WriteBufferFromFile::WriteBufferFromFile(String const&, unsigned long, int, unsigned int, char*, unsigned long) @ 0x12825d14 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/string:1499: std::__unique_if<DB::WriteBufferFromFile>::__unique_single std::make_unique[abi:v15000]<DB::WriteBufferFromFile, std::__fs::filesystem::path, unsigned long&, int&>(std::__fs::filesystem::path&&, unsigned long&, int&) @ 0x1717a40f in /usr/bin/clickhouse
13. ./build/./src/Disks/DiskLocal.cpp:0: DB::DiskLocal::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1717144d in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/DataPartStorageOnDiskFull.cpp:0: DB::DataPartStorageOnDiskFull::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1878a0c5 in /usr/bin/clickhouse
15. ./build/./src/Storages/MergeTree/IDataPartStorage.h:0: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f41e4 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
17. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
20. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
24. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
27. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
28. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
29. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
31. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.09 22:40:43.937497 [ 225 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.85 GiB (attempt to allocate chunk of 4360448 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:157: DB::WriteBufferFromFileBase::WriteBufferFromFileBase(unsigned long, char*, unsigned long) @ 0x127a5e2c in /usr/bin/clickhouse
10. ./build/./src/IO/WriteBufferFromFileDescriptor.cpp:93: DB::WriteBufferFromFileDescriptor::WriteBufferFromFileDescriptor(int, unsigned long, char*, unsigned long, String) @ 0x127a599b in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::WriteBufferFromFile::WriteBufferFromFile(String const&, unsigned long, int, unsigned int, char*, unsigned long) @ 0x12825d14 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/string:1499: std::__unique_if<DB::WriteBufferFromFile>::__unique_single std::make_unique[abi:v15000]<DB::WriteBufferFromFile, std::__fs::filesystem::path, unsigned long&, int&>(std::__fs::filesystem::path&&, unsigned long&, int&) @ 0x1717a40f in /usr/bin/clickhouse
13. ./build/./src/Disks/DiskLocal.cpp:0: DB::DiskLocal::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1717144d in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/DataPartStorageOnDiskFull.cpp:0: DB::DataPartStorageOnDiskFull::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1878a0c5 in /usr/bin/clickhouse
15. ./build/./src/Storages/MergeTree/IDataPartStorage.h:0: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f41e4 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
17. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
20. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
24. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
27. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
28. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
29. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
31. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.09 22:42:14.695809 [ 230 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.87 GiB (attempt to allocate chunk of 4360448 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:157: DB::WriteBufferFromFileBase::WriteBufferFromFileBase(unsigned long, char*, unsigned long) @ 0x127a5e2c in /usr/bin/clickhouse
10. ./build/./src/IO/WriteBufferFromFileDescriptor.cpp:93: DB::WriteBufferFromFileDescriptor::WriteBufferFromFileDescriptor(int, unsigned long, char*, unsigned long, String) @ 0x127a599b in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::WriteBufferFromFile::WriteBufferFromFile(String const&, unsigned long, int, unsigned int, char*, unsigned long) @ 0x12825d14 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/string:1499: std::__unique_if<DB::WriteBufferFromFile>::__unique_single std::make_unique[abi:v15000]<DB::WriteBufferFromFile, std::__fs::filesystem::path, unsigned long&, int&>(std::__fs::filesystem::path&&, unsigned long&, int&) @ 0x1717a40f in /usr/bin/clickhouse
13. ./build/./src/Disks/DiskLocal.cpp:0: DB::DiskLocal::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1717144d in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/DataPartStorageOnDiskFull.cpp:0: DB::DataPartStorageOnDiskFull::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1878a0c5 in /usr/bin/clickhouse
15. ./build/./src/Storages/MergeTree/IDataPartStorage.h:0: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f41e4 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
17. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
20. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
24. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
27. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
28. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
29. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
31. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.09 22:44:31.108348 [ 234 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.89 GiB (attempt to allocate chunk of 4360448 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:157: DB::WriteBufferFromFileBase::WriteBufferFromFileBase(unsigned long, char*, unsigned long) @ 0x127a5e2c in /usr/bin/clickhouse
10. ./build/./src/IO/WriteBufferFromFileDescriptor.cpp:93: DB::WriteBufferFromFileDescriptor::WriteBufferFromFileDescriptor(int, unsigned long, char*, unsigned long, String) @ 0x127a599b in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::WriteBufferFromFile::WriteBufferFromFile(String const&, unsigned long, int, unsigned int, char*, unsigned long) @ 0x12825d14 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/string:1499: std::__unique_if<DB::WriteBufferFromFile>::__unique_single std::make_unique[abi:v15000]<DB::WriteBufferFromFile, std::__fs::filesystem::path, unsigned long&, int&>(std::__fs::filesystem::path&&, unsigned long&, int&) @ 0x1717a40f in /usr/bin/clickhouse
13. ./build/./src/Disks/DiskLocal.cpp:0: DB::DiskLocal::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1717144d in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/DataPartStorageOnDiskFull.cpp:0: DB::DataPartStorageOnDiskFull::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1878a0c5 in /usr/bin/clickhouse
15. ./build/./src/Storages/MergeTree/IDataPartStorage.h:0: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f41e4 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
17. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
20. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
24. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
27. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
28. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
29. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
31. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.09 22:44:33.959173 [ 224 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.81 GiB (attempt to allocate chunk of 4360368 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:157: DB::WriteBufferFromFileBase::WriteBufferFromFileBase(unsigned long, char*, unsigned long) @ 0x127a5e2c in /usr/bin/clickhouse
10. ./build/./src/IO/WriteBufferFromFileDescriptor.cpp:93: DB::WriteBufferFromFileDescriptor::WriteBufferFromFileDescriptor(int, unsigned long, char*, unsigned long, String) @ 0x127a599b in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::WriteBufferFromFile::WriteBufferFromFile(String const&, unsigned long, int, unsigned int, char*, unsigned long) @ 0x12825d14 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/string:1499: std::__unique_if<DB::WriteBufferFromFile>::__unique_single std::make_unique[abi:v15000]<DB::WriteBufferFromFile, std::__fs::filesystem::path, unsigned long&, int&>(std::__fs::filesystem::path&&, unsigned long&, int&) @ 0x1717a40f in /usr/bin/clickhouse
13. ./build/./src/Disks/DiskLocal.cpp:0: DB::DiskLocal::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1717144d in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/DataPartStorageOnDiskFull.cpp:0: DB::DataPartStorageOnDiskFull::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1878a0c5 in /usr/bin/clickhouse
15. ./build/./src/Storages/MergeTree/IDataPartStorage.h:0: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f41e4 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
17. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
20. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
24. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
27. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
28. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
29. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
31. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.09 22:46:46.982849 [ 227 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.85 GiB (attempt to allocate chunk of 4360448 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:157: DB::WriteBufferFromFileBase::WriteBufferFromFileBase(unsigned long, char*, unsigned long) @ 0x127a5e2c in /usr/bin/clickhouse
10. ./build/./src/IO/WriteBufferFromFileDescriptor.cpp:93: DB::WriteBufferFromFileDescriptor::WriteBufferFromFileDescriptor(int, unsigned long, char*, unsigned long, String) @ 0x127a599b in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::WriteBufferFromFile::WriteBufferFromFile(String const&, unsigned long, int, unsigned int, char*, unsigned long) @ 0x12825d14 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/string:1499: std::__unique_if<DB::WriteBufferFromFile>::__unique_single std::make_unique[abi:v15000]<DB::WriteBufferFromFile, std::__fs::filesystem::path, unsigned long&, int&>(std::__fs::filesystem::path&&, unsigned long&, int&) @ 0x1717a40f in /usr/bin/clickhouse
13. ./build/./src/Disks/DiskLocal.cpp:0: DB::DiskLocal::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1717144d in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/DataPartStorageOnDiskFull.cpp:0: DB::DataPartStorageOnDiskFull::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1878a0c5 in /usr/bin/clickhouse
15. ./build/./src/Storages/MergeTree/IDataPartStorage.h:0: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f41e4 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
17. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
20. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
24. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
27. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
28. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
29. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
31. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.09 22:47:31.800875 [ 226 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.86 GiB (attempt to allocate chunk of 4360336 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:157: DB::WriteBufferFromFileBase::WriteBufferFromFileBase(unsigned long, char*, unsigned long) @ 0x127a5e2c in /usr/bin/clickhouse
10. ./build/./src/IO/WriteBufferFromFileDescriptor.cpp:93: DB::WriteBufferFromFileDescriptor::WriteBufferFromFileDescriptor(int, unsigned long, char*, unsigned long, String) @ 0x127a599b in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::WriteBufferFromFile::WriteBufferFromFile(String const&, unsigned long, int, unsigned int, char*, unsigned long) @ 0x12825d14 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/string:1499: std::__unique_if<DB::WriteBufferFromFile>::__unique_single std::make_unique[abi:v15000]<DB::WriteBufferFromFile, std::__fs::filesystem::path, unsigned long&, int&>(std::__fs::filesystem::path&&, unsigned long&, int&) @ 0x1717a40f in /usr/bin/clickhouse
13. ./build/./src/Disks/DiskLocal.cpp:0: DB::DiskLocal::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1717144d in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/DataPartStorageOnDiskFull.cpp:0: DB::DataPartStorageOnDiskFull::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1878a0c5 in /usr/bin/clickhouse
15. ./build/./src/Storages/MergeTree/IDataPartStorage.h:0: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f41e4 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
17. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
20. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
24. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
27. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
28. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
29. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
31. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.09 22:49:47.860335 [ 231 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.87 GiB (attempt to allocate chunk of 4360448 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:157: DB::WriteBufferFromFileBase::WriteBufferFromFileBase(unsigned long, char*, unsigned long) @ 0x127a5e2c in /usr/bin/clickhouse
10. ./build/./src/IO/WriteBufferFromFileDescriptor.cpp:93: DB::WriteBufferFromFileDescriptor::WriteBufferFromFileDescriptor(int, unsigned long, char*, unsigned long, String) @ 0x127a599b in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::WriteBufferFromFile::WriteBufferFromFile(String const&, unsigned long, int, unsigned int, char*, unsigned long) @ 0x12825d14 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/string:1499: std::__unique_if<DB::WriteBufferFromFile>::__unique_single std::make_unique[abi:v15000]<DB::WriteBufferFromFile, std::__fs::filesystem::path, unsigned long&, int&>(std::__fs::filesystem::path&&, unsigned long&, int&) @ 0x1717a40f in /usr/bin/clickhouse
13. ./build/./src/Disks/DiskLocal.cpp:0: DB::DiskLocal::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1717144d in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/DataPartStorageOnDiskFull.cpp:0: DB::DataPartStorageOnDiskFull::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1878a0c5 in /usr/bin/clickhouse
15. ./build/./src/Storages/MergeTree/IDataPartStorage.h:0: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f41e4 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
17. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
20. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
24. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
27. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
28. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
29. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
31. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.09 22:50:32.876610 [ 238 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.85 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:157: DB::WriteBufferFromFileBase::WriteBufferFromFileBase(unsigned long, char*, unsigned long) @ 0x127a5e2c in /usr/bin/clickhouse
10. ./build/./src/IO/WriteBufferFromFileDescriptor.cpp:93: DB::WriteBufferFromFileDescriptor::WriteBufferFromFileDescriptor(int, unsigned long, char*, unsigned long, String) @ 0x127a599b in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::WriteBufferFromFile::WriteBufferFromFile(String const&, unsigned long, int, unsigned int, char*, unsigned long) @ 0x12825d14 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/string:1499: std::__unique_if<DB::WriteBufferFromFile>::__unique_single std::make_unique[abi:v15000]<DB::WriteBufferFromFile, std::__fs::filesystem::path, unsigned long&, int&>(std::__fs::filesystem::path&&, unsigned long&, int&) @ 0x1717a40f in /usr/bin/clickhouse
13. ./build/./src/Disks/DiskLocal.cpp:0: DB::DiskLocal::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1717144d in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/DataPartStorageOnDiskFull.cpp:0: DB::DataPartStorageOnDiskFull::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1878a0c5 in /usr/bin/clickhouse
15. ./build/./src/Storages/MergeTree/IDataPartStorage.h:0: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f41e4 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
17. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
20. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
24. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
27. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
28. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
29. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
31. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.09 22:55:04.966432 [ 226 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.87 GiB (attempt to allocate chunk of 4360528 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:157: DB::WriteBufferFromFileBase::WriteBufferFromFileBase(unsigned long, char*, unsigned long) @ 0x127a5e2c in /usr/bin/clickhouse
10. ./build/./src/IO/WriteBufferFromFileDescriptor.cpp:93: DB::WriteBufferFromFileDescriptor::WriteBufferFromFileDescriptor(int, unsigned long, char*, unsigned long, String) @ 0x127a599b in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::WriteBufferFromFile::WriteBufferFromFile(String const&, unsigned long, int, unsigned int, char*, unsigned long) @ 0x12825d14 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/string:1499: std::__unique_if<DB::WriteBufferFromFile>::__unique_single std::make_unique[abi:v15000]<DB::WriteBufferFromFile, std::__fs::filesystem::path, unsigned long&, int&>(std::__fs::filesystem::path&&, unsigned long&, int&) @ 0x1717a40f in /usr/bin/clickhouse
13. ./build/./src/Disks/DiskLocal.cpp:0: DB::DiskLocal::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1717144d in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/DataPartStorageOnDiskFull.cpp:0: DB::DataPartStorageOnDiskFull::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1878a0c5 in /usr/bin/clickhouse
15. ./build/./src/Storages/MergeTree/IDataPartStorage.h:0: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f41e4 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
17. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
20. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
24. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
27. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
28. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
29. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
31. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.09 22:55:49.719261 [ 224 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.86 GiB (attempt to allocate chunk of 4360336 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:157: DB::WriteBufferFromFileBase::WriteBufferFromFileBase(unsigned long, char*, unsigned long) @ 0x127a5e2c in /usr/bin/clickhouse
10. ./build/./src/IO/WriteBufferFromFileDescriptor.cpp:93: DB::WriteBufferFromFileDescriptor::WriteBufferFromFileDescriptor(int, unsigned long, char*, unsigned long, String) @ 0x127a599b in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::WriteBufferFromFile::WriteBufferFromFile(String const&, unsigned long, int, unsigned int, char*, unsigned long) @ 0x12825d14 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/string:1499: std::__unique_if<DB::WriteBufferFromFile>::__unique_single std::make_unique[abi:v15000]<DB::WriteBufferFromFile, std::__fs::filesystem::path, unsigned long&, int&>(std::__fs::filesystem::path&&, unsigned long&, int&) @ 0x1717a40f in /usr/bin/clickhouse
13. ./build/./src/Disks/DiskLocal.cpp:0: DB::DiskLocal::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1717144d in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/DataPartStorageOnDiskFull.cpp:0: DB::DataPartStorageOnDiskFull::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1878a0c5 in /usr/bin/clickhouse
15. ./build/./src/Storages/MergeTree/IDataPartStorage.h:0: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f41e4 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
17. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
20. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
24. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
27. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
28. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
29. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
31. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.09 22:59:36.315900 [ 237 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360336 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:157: DB::WriteBufferFromFileBase::WriteBufferFromFileBase(unsigned long, char*, unsigned long) @ 0x127a5e2c in /usr/bin/clickhouse
10. ./build/./src/IO/WriteBufferFromFileDescriptor.cpp:93: DB::WriteBufferFromFileDescriptor::WriteBufferFromFileDescriptor(int, unsigned long, char*, unsigned long, String) @ 0x127a599b in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::WriteBufferFromFile::WriteBufferFromFile(String const&, unsigned long, int, unsigned int, char*, unsigned long) @ 0x12825d14 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/string:1499: std::__unique_if<DB::WriteBufferFromFile>::__unique_single std::make_unique[abi:v15000]<DB::WriteBufferFromFile, std::__fs::filesystem::path, unsigned long&, int&>(std::__fs::filesystem::path&&, unsigned long&, int&) @ 0x1717a40f in /usr/bin/clickhouse
13. ./build/./src/Disks/DiskLocal.cpp:0: DB::DiskLocal::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1717144d in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/DataPartStorageOnDiskFull.cpp:0: DB::DataPartStorageOnDiskFull::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1878a0c5 in /usr/bin/clickhouse
15. ./build/./src/Storages/MergeTree/IDataPartStorage.h:0: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f41e4 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
17. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
20. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
24. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
27. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
28. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
29. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
31. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.09 23:03:23.140225 [ 230 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.90 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:157: DB::WriteBufferFromFileBase::WriteBufferFromFileBase(unsigned long, char*, unsigned long) @ 0x127a5e2c in /usr/bin/clickhouse
10. ./build/./src/IO/WriteBufferFromFileDescriptor.cpp:93: DB::WriteBufferFromFileDescriptor::WriteBufferFromFileDescriptor(int, unsigned long, char*, unsigned long, String) @ 0x127a599b in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::WriteBufferFromFile::WriteBufferFromFile(String const&, unsigned long, int, unsigned int, char*, unsigned long) @ 0x12825d14 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/string:1499: std::__unique_if<DB::WriteBufferFromFile>::__unique_single std::make_unique[abi:v15000]<DB::WriteBufferFromFile, std::__fs::filesystem::path, unsigned long&, int&>(std::__fs::filesystem::path&&, unsigned long&, int&) @ 0x1717a40f in /usr/bin/clickhouse
13. ./build/./src/Disks/DiskLocal.cpp:0: DB::DiskLocal::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1717144d in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/DataPartStorageOnDiskFull.cpp:0: DB::DataPartStorageOnDiskFull::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1878a0c5 in /usr/bin/clickhouse
15. ./build/./src/Storages/MergeTree/IDataPartStorage.h:0: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f41e4 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
17. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
20. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
24. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
27. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
28. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
29. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
31. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.09 23:07:08.849869 [ 231 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.82 GiB (attempt to allocate chunk of 4360288 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:157: DB::WriteBufferFromFileBase::WriteBufferFromFileBase(unsigned long, char*, unsigned long) @ 0x127a5e2c in /usr/bin/clickhouse
10. ./build/./src/IO/WriteBufferFromFileDescriptor.cpp:93: DB::WriteBufferFromFileDescriptor::WriteBufferFromFileDescriptor(int, unsigned long, char*, unsigned long, String) @ 0x127a599b in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::WriteBufferFromFile::WriteBufferFromFile(String const&, unsigned long, int, unsigned int, char*, unsigned long) @ 0x12825d14 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/string:1499: std::__unique_if<DB::WriteBufferFromFile>::__unique_single std::make_unique[abi:v15000]<DB::WriteBufferFromFile, std::__fs::filesystem::path, unsigned long&, int&>(std::__fs::filesystem::path&&, unsigned long&, int&) @ 0x1717a40f in /usr/bin/clickhouse
13. ./build/./src/Disks/DiskLocal.cpp:0: DB::DiskLocal::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1717144d in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/DataPartStorageOnDiskFull.cpp:0: DB::DataPartStorageOnDiskFull::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1878a0c5 in /usr/bin/clickhouse
15. ./build/./src/Storages/MergeTree/IDataPartStorage.h:0: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f41e4 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
17. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
20. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
24. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
27. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
28. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
29. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
31. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.09 23:07:12.343536 [ 224 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.88 GiB (attempt to allocate chunk of 4208336 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero.: (while reading column ProfileEvent_MergeTreeDataProjectionWriterBlocks): (while reading from part /var/lib/clickhouse/store/a51/a51efc65-fc44-4803-9d0c-ce07f9ff06af/202410_2302_4762_448/ from mark 8 with max_rows_to_read = 2087): While executing MergeTreeSequentialSource. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. void DB::PODArrayBase<8ul, 4096ul, Allocator<false, false>, 63ul, 64ul>::resize<>(unsigned long) @ 0xda23ab8 in /usr/bin/clickhouse
9. ./build/./src/Common/PODArray.h:389: DB::SerializationNumber<unsigned long>::deserializeBinaryBulk(DB::IColumn&, DB::ReadBuffer&, unsigned long, double) const @ 0x170ce4bb in /usr/bin/clickhouse
10. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:209: DB::ISerialization::deserializeBinaryBulkWithMultipleStreams(COW<DB::IColumn>::immutable_ptr<DB::IColumn>&, unsigned long, DB::ISerialization::DeserializeBinaryBulkSettings&, std::shared_ptr<DB::ISerialization::DeserializeBinaryBulkState>&, std::unordered_map<String, COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>>*) const @ 0x1709e16b in /usr/bin/clickhouse
11. ./build/./src/Storages/MergeTree/MergeTreeReaderWide.cpp:0: DB::MergeTreeReaderWide::readData(DB::NameAndTypePair const&, std::shared_ptr<DB::ISerialization const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn>&, unsigned long, bool, unsigned long, unsigned long, std::unordered_map<String, COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>>&, bool) @ 0x189e4120 in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeReaderWide.cpp:157: DB::MergeTreeReaderWide::readRows(unsigned long, unsigned long, bool, unsigned long, std::vector<COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::allocator<COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>&) @ 0x189e2d93 in /usr/bin/clickhouse
13. ./build/./src/Storages/MergeTree/MergeTreeSequentialSource.cpp:182: DB::MergeTreeSequentialSource::generate() @ 0x189e7608 in /usr/bin/clickhouse
14. ./build/./src/Processors/Chunk.h:90: DB::ISource::tryGenerate() @ 0x18cd2395 in /usr/bin/clickhouse
15. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::ISource::work() @ 0x18cd1ec5 in /usr/bin/clickhouse
16. ./build/./src/Processors/Executors/ExecutionThreadContext.cpp:0: DB::ExecutionThreadContext::executeTask() @ 0x18ce950c in /usr/bin/clickhouse
17. ./build/./src/Processors/Executors/PipelineExecutor.cpp:248: DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x18cdfd7b in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/atomic:958: DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x18cdf8a9 in /usr/bin/clickhouse
19. ./build/./src/Processors/Executors/PullingPipelineExecutor.cpp:54: DB::PullingPipelineExecutor::pull(DB::Chunk&) @ 0x18cecf48 in /usr/bin/clickhouse
20. ./build/./src/Processors/Executors/PullingPipelineExecutor.cpp:0: DB::PullingPipelineExecutor::pull(DB::Block&) @ 0x18ced130 in /usr/bin/clickhouse
21. ./build/./src/Storages/MergeTree/MergeTask.cpp:521: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::executeImpl() @ 0x18811eb4 in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
25. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
27. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
28. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
29. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
31. ? @ 0x7f3895a94ac3 in ?
 (version 23.3.2.1)
2024.10.09 23:10:55.834529 [ 225 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.81 GiB (attempt to allocate chunk of 4360448 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:157: DB::WriteBufferFromFileBase::WriteBufferFromFileBase(unsigned long, char*, unsigned long) @ 0x127a5e2c in /usr/bin/clickhouse
10. ./build/./src/IO/WriteBufferFromFileDescriptor.cpp:93: DB::WriteBufferFromFileDescriptor::WriteBufferFromFileDescriptor(int, unsigned long, char*, unsigned long, String) @ 0x127a599b in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::WriteBufferFromFile::WriteBufferFromFile(String const&, unsigned long, int, unsigned int, char*, unsigned long) @ 0x12825d14 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/string:1499: std::__unique_if<DB::WriteBufferFromFile>::__unique_single std::make_unique[abi:v15000]<DB::WriteBufferFromFile, std::__fs::filesystem::path, unsigned long&, int&>(std::__fs::filesystem::path&&, unsigned long&, int&) @ 0x1717a40f in /usr/bin/clickhouse
13. ./build/./src/Disks/DiskLocal.cpp:0: DB::DiskLocal::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1717144d in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/DataPartStorageOnDiskFull.cpp:0: DB::DataPartStorageOnDiskFull::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1878a0c5 in /usr/bin/clickhouse
15. ./build/./src/Storages/MergeTree/IDataPartStorage.h:0: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f41e4 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
17. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
20. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
24. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
27. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
28. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
29. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
31. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.09 23:12:07.102075 [ 39 ] {955a0899-13e2-48f8-88b9-8478a4380a85} <Error> executeQuery: Code: 469. DB::Exception: Constraint `check_data_length` for table default.docs (3c4d917d-57dc-4cc8-ab39-33b8d956ac9c) is violated at row 1. Expression: (length(embeddings) = 768). Column values: embeddings = [0.04112676903605461, -0.008400964550673962, 0.09749477356672287, -0.053131524473428726, -0.001413525315001607, 0.03715737536549568, 0.008255580440163612, -0.025049051269888878, -0.0015678626950830221, -0.028389258310198784, 0.010690483264625072, -0.006459140218794346, 0.20259089767932892, 0.032178185880184174, 0.046765342354774475, 0.01466406974941492, -0.04373771324753761, 0.023064764216542244, 0.027008596807718277, 0.05068179965019226, -0.11421819031238556, -0.05220935121178627, 0.10694943368434906, 0.09731987863779068, -0.036210861057043076, -0.017703868448734283, -0.021764438599348068, -0.031486380845308304, 0.06449003517627716, -0.06462034583091736, 0.11916103214025497, 0.03971036896109581, -0.01853313483297825, 0.058251846581697464, 0.008044475689530373, 0.01547224447131157, -0.044564105570316315, 0.06325632333755493, 0.005558537319302559, -0.03139401599764824, -0.08913689851760864, -0.04606947302818298, -0.014500710181891918, -0.051759328693151474, 0.006230400409549475, -0.060991041362285614, 0.052895113825798035, 0.016175515949726105, -0.0173935666680336, 0.055896636098623276, -0.004420056007802486, -0.009099304676055908, 0.04762881621718407, -0.02145329862833023, -0.04269666597247124, 0.02086651511490345, 0.018043765798211098, 0.029654046520590782, 0.05177649110555649, 0.07189029455184937, -0.07093359529972076, 0.0010210160398855805, 0.03791459649801254, -0.034294936805963516, 0.0004765923658851534, 0.018332112580537796, 0.0665619820356369, -0.002618261380121112, 0.11268480122089386, -0.04894984886050224, 0.018420640379190445, -0.01757984422147274, -0.010174473747611046, 0.04525480791926384, -0.021397139877080917, 0.11532675474882126, -0.055264171212911606, -0.015345095656812191, -0.12123377621173859, -0.011908014304935932, -0.15089012682437897, 0.040806662291288376, -0.011781638488173485, -0.005612982902675867, 0.006401349790394306, -0.01635991781949997, -0.009834450669586658, 0.010021897032856941, -0.03097623586654663, -0.04822486639022827, 0.016370205208659172, -0.029412854462862015, -0.01282628532499075, -0.04488382861018181, 0.013726006262004375, -0.021837204694747925, 0.04366128891706467, -0.029287194833159447, -0.010640166699886322, -0.10984556376934052, 0.017254607751965523, -0.0004918534541502595, -0.04328940436244011, 0.03474825620651245, 0.041193265467882156, 0.05670227110385895, 0.04823417216539383, -0.019503487274050713, 0.05669773742556572, -0.010472320020198822, -0.009554700925946236, -0.03481427952647209, -0.06290591508150101, 0.020141661167144775, -0.06863225996494293, -0.04927641525864601, 0.013040315359830856, 0.010648333467543125, 0.034409452229738235, 0.07569956034421921, 0.014744537882506847, 0.04826740175485611, -0.005035950802266598, -0.012604649178683758, 0.02325516566634178, -0.054228488355875015, -0.07620903104543686, 0.0764530748128891, -0.0679018422961235, -0.011016343720257282, 0.007538978476077318, -0.03399340808391571, 0.028552360832691193, -0.036915022879838943, -0.0928267166018486, -0.04258729889988899, 0.04170601814985275, 0.0557204894721508, 0.0054741413332521915, -0.0508527010679245, 0.018909351900219917, -0.09906692057847977, -0.029620744287967682, 0.017833711579442024, -0.019879205152392387, 0.0006834550877101719, 0.047341156750917435, -0.04990822449326515, -0.01716255210340023, 0.039507120847702026, 0.002763956319540739, 0.04233676195144653, -0.09128551185131073, 0.021852998062968254, -0.045491334050893784, -0.003876769682392478, -0.04667738080024719, -0.018148822709918022, 0.02576877921819687, 0.012938815169036388, -0.01759943924844265, 0.05042668431997299, 0.0072966814041137695, 0.07770740985870361, -0.045169148594141006, -0.07323839515447617, 0.008351152762770653, 0.007953478023409843, -0.004714835435152054, -0.032919175922870636, -0.06336789578199387, -0.010174283757805824, 0.008563329465687275, 0.02098591811954975, -0.033558834344148636, -0.037677280604839325, 0.02241131290793419, -0.049901265650987625, 0.009958988055586815, -0.03820584714412689, 0.04470084607601166, 0.01590130664408207, -0.016525981947779655, -0.003101245267316699, 0.04618902504444122, 0.005928968079388142, 0.04641854390501976, 0.013662979006767273, -0.02730601839721203, -0.02260732650756836, 0.019516505300998688, 0.014044861309230328, 0.009985015727579594, 0.0036300497595220804, 0.007266989443451166, 0.06509029120206833, -0.010095532052218914, 0.018118733540177345, -0.030959732830524445, -0.02009149268269539, 0.03921203687787056, 0.017353219911456108, -0.01061128918081522, -0.04410579428076744, 0.01570095494389534, -0.007173595950007439, 0.004249447025358677, 0.0384400375187397, 0.03772586211562157, 0.05227470025420189, -0.015308933332562447, 0.038963090628385544, -0.01851087063550949, -0.04436035454273224, -0.037230417132377625, 0.04432890564203262, -0.042224857956171036, 0.038043003529310226, -0.011614635586738586, -0.009917216375470161, -0.005439909175038338, 0.005710291676223278, -0.01292689610272646, -0.017040517181158066, -0.02342803217470646, -0.007542700972408056, -0.01887032575905323, -0.00408390024676919, -0.01913602463901043, 0.0015421768184751272, 0.03318754583597183, 0.04709598049521446, 0.05091400444507599, 0.024551717564463615, 0.05177771672606468, -0.03418348729610443, -0.041375115513801575, 0.05476862192153931, -0.017739688977599144, 0.02319563925266266, 0.04009556025266647, -0.05034223198890686, -0.012569224461913109, -0.040207114070653915, 0.047189194709062576, 0.06881839036941528, 0.036453623324632645, 0.007383022923022509, -0.07399331778287888, 0.04669874534010887, 0.04590693861246109, -0.03657842054963112, -0.029057389125227928, -0.023157374933362007, 0.006855986081063747, -0.013003568165004253, 0.03766760230064392, 0.023585092276334763, -0.014273903332650661, 0.024112064391374588, 0.020958127453923225, 0.030608143657445908, 0.00935056246817112, 0.003458634717389941, 0.07281047105789185, 0.036470428109169006, -0.055507928133010864, 0.030497970059514046, 0.07009201496839523, 0.029175128787755966, -0.04006607085466385, 0.02121541276574135, -0.07111053168773651, 0.005707551725208759, 0.03345181420445442, 0.058384835720062256, 0.00447284197434783, -0.024309294298291206, 0.01540397573262453, -0.00007842402555979788, -0.005186615511775017, -0.009474387392401695, -0.017360340803861618, 0.0375961996614933, -0.024325352162122726, 0.10852240025997162, 0.04295344650745392, 0.018111594021320343, 0.014796697534620762, -0.04984721541404724, -0.014833662658929825, -0.007269750349223614, 0.028995905071496964, -0.01402225811034441, -0.00007969354192027822, -0.008047026582062244, 0.02774444781243801, 0.0040969871915876865, -0.008088630624115467, -0.017454709857702255, 0.031756941229104996, -0.037631139159202576, -0.009362776763737202, -0.03553250804543495, -0.02473743073642254, -0.005112426821142435, 0.010493204928934574, -0.01688285544514656, -0.013335518538951874, 0.0016652642516419291, 0.008578014560043812, 0.047118835151195526, -0.03651205822825432, 0.020822320133447647, 0.05174384266138077, 0.05402554199099541, 0.005726643837988377, 0.024147391319274902, -0.012216254137456417, -0.03834644332528114, -0.021724883466959, 0.022474365308880806, -0.0072288778610527515, -0.013360566459596157, 0.03644173592329025, 0.03198769688606262, -0.028750363737344742, -0.0372941717505455, -0.002340676262974739, 0.015134798362851143, 0.018716948106884956, 0.07642769813537598, -0.014287699945271015, 0.0071293264627456665, 0.00017217350250575691, -0.028243685141205788, -0.03771013393998146, 0.025617297738790512, -0.029350411146879196, 0.0410865917801857, 0.009700339287519455, -0.0030304566025733948, -0.006925365421921015, 0.025001641362905502, 0.012117253616452217, 0.019071267917752266, -0.053252384066581726, 0.03433280438184738, -0.07949414104223251, 0.01415552943944931, -0.034957777708768845, -0.044917937368154526, -0.022444983944296837, 0.01898389495909214, -0.009450245648622513, 0.05393995717167854, -0.007413389626890421, -0.042290300130844116, -0.0021597088780254126, 0.006635033525526524, 0.005249409936368465, -0.018422018736600876, 0.008196841925382614, 0.03559621796011925, 0.030688943341374397, 0.006063733249902725, -0.009056570008397102, 0.011896943673491478, 0.006002794019877911, -0.028651341795921326, 0.029948590323328972, -0.005105042830109596, -0.041034799069166183, -0.009642736054956913, -0.04087080433964729, -0.030866360291838646, 0.03304264694452286, -0.006581900641322136, 0.03131371736526489, 0.011574024334549904, 0.0020294361747801304, -0.03986697643995285, 0.06552740186452866, 0.0002521446440368891, -0.06849580258131027, 0.005251407623291016, 0.005539783742278814, -0.013817114755511284, 0.00877917930483818, 0.007843996398150921, -0.00521165831014514, 0.030877962708473206, 0.03003661334514618, -0.01015123724937439, -0.025567078962922096, -0.00979952048510313, -0.00982715655118227, -0.01679673045873642, -0.03347286581993103, 0.010995552875101566, 0.04239370673894882, 0.012884977273643017, -0.01967129297554493, -0.02690216153860092, -0.0537419393658638, 0.04612419754266739, -0.024626154452562332, 0.024760078638792038, 0.010672315023839474, -0.0009442606824450195, 0.02980009652674198, -0.03142961114645004, 0.005180883686989546, 0.015273631550371647, 0.007293933071196079, -0.013583612628281116, 0.030973216518759727, -0.037088122218847275, -0.02731720358133316, -0.029258398339152336, -0.015127088874578476, 0.024791836738586426, -0.031368620693683624, -0.03179318830370903, 0.011125358752906322, -0.026527008041739464, 0.035565946251153946, 0.007999823428690434, 0.016748348250985146, 0.0578162707388401, 0.02152731828391552, -0.024239664897322655, 0.02873917482793331, -0.016491128131747246, 0.003806576831266284, -0.0379222109913826, -0.019340209662914276, -0.028069239109754562, 0.020346377044916153, -0.04691646993160248, 0.040187425911426544, -0.030056890100240707, -0.00934668816626072, 0.034412872046232224, 0.019517192617058754, 0.00571842584758997, 0.007056301459670067, -0.031052365899086, -0.018865026533603668, 0.01035971287637949, 0.02340511791408062, 0.03356312960386276, 0.024721812456846237, 0.020413683727383614, 0.06188393384218216, 0.0024855586234480143, -0.034079745411872864, 0.013799524866044521, -0.0264658872038126, 0.022548187524080276, 0.004792942199856043, 0.0048643918707966805, -0.02826474793255329, 0.007719140965491533, -0.0002229060628451407, -0.014499436132609844, -0.058232128620147705, 0.006874094717204571, -0.020141853019595146, 0.011796528473496437, -0.03683674708008766, -0.020144635811448097, -0.06310122460126877, -0.0005744993686676025, -0.009568058885633945, 0.03347845748066902, -0.028822394087910652, 0.008713101968169212, -0.01366719976067543, 0.000556181010324508, 0.03903563320636749, 0.010797100141644478, 0.01823129877448082, -0.0009091593092307448, 0.032228969037532806, -0.004630065523087978, -0.005639039445668459, 0.020894596353173256, -0.00008655933197587729, -0.020166857168078423, 0.011366728693246841, -0.024981791153550148, -0.028785396367311478, -0.0005089910700917244, 0.025930508971214294, 0.024389345198869705, 0.028883565217256546, -0.03519399091601372, 0.046732936054468155, -0.0015605516964569688, -0.020675430074334145, 0.03479232266545296, -0.03526531532406807, -0.03545811399817467, 0.024641871452331543, -0.0017004553228616714, 0.019755203276872635, 0.015506728552281857, 0.012084905058145523, -0.003097117878496647, -0.0360398069024086, -0.0027035255916416645, 0.030154524371027946, -0.040230561047792435, 0.008995968848466873, -0.04338430240750313, -0.0011625747429206967, 0.005406067240983248, 0.00898006372153759, 0.025237154215574265, -0.02205396443605423, 0.02120666205883026, -0.008092467673122883, 0.053548622876405716, -0.00878408458083868, -0.0008121957071125507, 0.008075183257460594, -0.013216770254075527, 0.003094600047916174, -0.005302043631672859, -0.014354857616126537, 0.009537110105156898, 0.05724840238690376, 0.0038471973966807127, 0.013702616095542908, -0.013545074500143528, 0.028473442420363426, 0.07334710657596588, 0.007879437878727913, -0.010901509784162045, -0.016215741634368896, -0.013836121186614037, -0.0039771017618477345, 0.05668671429157257, -0.01651117205619812, 0.02169436402618885, -0.003131014760583639, -0.0020890343002974987, 0.018677733838558197, 0.01342421118170023, -0.03208912909030914, 0.02090190351009369, 0.06153852492570877, -0.0017614222597330809, 0.007354092784225941, -0.020615138113498688, 0.028870582580566406, 0.03088679350912571, 0.00023880874505266547, -0.027481626719236374, -0.010605577379465103, -0.05585501715540886, -0.02246074564754963, -0.003517249133437872, 0.037035197019577026, -0.03140551969408989, -0.027843017131090164, 0.024822216480970383, -0.03815183788537979, -0.028419118374586105, -0.001893513253889978, 0.021165264770388603, -0.03769949823617935, 0.02438555657863617, -0.0329190157353878, -0.012152718380093575, -0.008549747057259083, -0.014017218723893166, 0.03758098557591438, 0.017697574570775032, 0.0314563512802124, -0.020938124507665634, -0.004193033557385206, 0.00010984546679537743, -0.05198754742741585, 0.03512177616357803, -0.004685565363615751, 0.013876876793801785, -0.0030888968612998724, 0.019371680915355682, -0.05528497323393822, 0.008958532474935055, 0.0006540937465615571, 0.00017407086852472275, -0.0056823864579200745, 0.02045457623898983, -0.01926295831799507, -0.007989882491528988, -0.012086545117199421, 0.01420773658901453, -0.011442702263593674, -0.05625816062092781, -0.03793339058756828, -0.008988410234451294, 0.002976102288812399, -0.011346818879246712, -0.023046011105179787, -0.010411012917757034, -0.00815978366881609, 0.003365460317581892, 0.02891707420349121, -0.015214743092656136, 0.0053184968419373035, 0.02783309295773506, -0.03096819296479225, 0.0023907998111099005, -0.026923296973109245, -0.022503618150949478, -0.043741073459386826, -0.02819158136844635, 0.018597133457660675, 0.002268814481794834, -0.0029174548108130693, -0.025284741073846817, -0.00319598987698555, -0.03348339721560478, 0.01935933157801628, 0.039952851831912994, 0.04389861971139908, 0.024804934859275818, 0.0007417522720061243, -0.02417057938873768, -0.007191809359937906, 0.01685091108083725, -0.03149881586432457, -0.000010680488230718765, 0.041556090116500854, -0.003227245295420289, -0.04296642541885376, 0.029496148228645325, -0.05517983064055443, -0.026096805930137634, 0.025703152641654015, -0.04826205223798752, 0.011460854671895504, 0.025536416098475456, 0.06379643827676773, 0.04230910912156105, -0.027765994891524315, -0.024022798985242844, -0.011495410464704037, 0.022165372967720032, -0.016285767778754234, 0.03393073007464409, -0.04509823024272919, 0.012565627694129944, -0.0021136151626706123, -0.020885808393359184, -0.024248279631137848, 0.009134472347795963, -0.018834421411156654, -0.0217552799731493, -0.05108245462179184, 0.006296403240412474, 0.017696307972073555, 0.04843733832240105, 0.012255779467523098, 0.04236619547009468, -0.0453970767557621, 0.021040739491581917, -0.026848934590816498, -0.04417773708701134, -0.02701510116457939, -0.02679886482656002, 0.00868728756904602, 0.012282646261155605, -0.0023587073665112257, 0.0077600120566785336, -0.008334517478942871, -0.014376750215888023, 0.00024675397435203195, -0.04333096742630005, 0.02545076794922352, 0.04097384959459305, -0.006867955904453993, -0.004614207427948713, 0.006639937870204449, -0.025192759931087494, 0.005046755541115999, 0.029727432876825333, -0.0036288874689489603, 0.028330594301223755, -0.05291871726512909, 0.016500743106007576, -0.024655256420373917, 0.027101678773760796, -0.036831893026828766, -0.029537169262766838, -0.007847853004932404, -0.01710391230881214, 0.004529262892901897, -0.017477143555879593, -0.011326992884278297, 0.03385044261813164, 0.0025562187656760216, -0.030649572610855103, 0.028829025104641914, -0.01702794060111046, 0.003773796372115612, 0.06318812817335129, 0.024801107123494148, 0.0005973030929453671, -0.006220902781933546, -0.020438410341739655, 0.03914552927017212, 0.02747317962348461, -0.009098367765545845, -0.030245523899793625, -0.011044243350625038, 0.0008789818966761231, 0.035039544105529785, 0.022321708500385284, 0.025502661243081093, 0.03415408357977867, 0.011689180508255959, 0.029431642964482307, -0.014848055317997932, -0.013332908041775227, -0.04088233783841133, 0.0016417226288467646, -0.0001908252015709877, -0.048127591609954834, 0.01309671439230442, 0.017438720911741257, -0.023462088778614998, 0.028764156624674797, 0.015662427991628647, 0.015431550331413746, -0.01649722456932068, 0.00826359260827303, -0.002190323080867529, -0.006923543754965067, -0.012776247225701809, -0.03024160861968994, 0.021992236375808716, -0.009583735838532448, 0.006758818868547678, 0.011797710321843624, 0.06525582820177078, -0.01793454773724079, -0.009243237785995007, 0.016094516962766647, -0.011445008218288422, -0.01743880845606327, -0.008408263325691223, 0.01403969619423151, -0.010894207283854485, 0.013176471926271915, -0.017324630171060562, -0.03186485171318054, -0.03562108427286148, 0.0384221114218235, 0.008773223496973515, -0.0024316865019500256, -0.007962893694639206, -0.012082628905773163, -0.008132019080221653, -0.045298200100660324, -0.037971559911966324, -0.011736966669559479, 0.025261100381612778, -0.02263030968606472, 0.001445906120352447, -0.016075950115919113, 0.0295853354036808, 0.016559265553951263, -0.009476060047745705, -0.024880675598978996, 0.005245420150458813, 0.024844862520694733, -0.007902298122644424, -0.014811310917139053, 0.018835658207535744, 0.013316920027136803, 0.02936268411576748, -0.013327701948583126, 0.013596398755908012, -0.010030603967607021, 0.02471514418721199, 0.010211591608822346, -0.006804019678384066, -0.015354492701590061, -0.004576915875077248, 0.03325419872999191, 0.006882003508508205, 0.013088996522128582, 0.01640736311674118, -0.018102262169122696, 0.0014430301962420344, 0.02442939206957817, -0.01429260615259409, 0.015081748366355896, -0.02540522813796997, -0.0119558647274971, -0.004332041367888451, -0.008295868523418903, -0.020444106310606003, -0.007604793645441532, 0.003364169504493475, 0.00020354773732833564, -0.002697459189221263, -0.005108331795781851, 0.008935454301536083, -0.02733936719596386, 0.0063319639302790165, 0.01937936432659626, -0.040439147502183914, 0.0017137906979769468, -0.011859148740768433, -0.0034289464820176363, 0.0036989920772612095, 0.007740485016256571, 0.015089968219399452, -0.007275377865880728, -0.009799518622457981, 0.016716966405510902, -0.0032311684917658567, -0.060726191848516464, 0.002828961471095681, 0.011269385926425457, 0.02417968399822712, -0.026233196258544922, -0.018231205642223358, -0.011497975327074528, -0.009086895734071732, 0.01099392119795084, 0.04455692321062088, 0.0019239230314269662, -0.02908186987042427, 0.02461799792945385, -0.0021742903627455235, -0.004481333773583174, 0.011874686926603317, 0.019026774913072586, 0.01927514187991619, -0.023444704711437225, 0.014641212299466133, 0.0012568593956530094, 0.0016372279496863484, -0.015481566078960896, 0.00914992019534111, 0.017788812518119812, -0.003122493391856551, -0.008762910030782223, -0.00434125354513526, 0.04606098309159279, -0.008591116406023502, 0.0005484759458340704, -0.001336159068159759, -0.017760811373591423, 0.025090107694268227, 0.001943016890436411, -0.010332999750971794, 0.042990852147340775, 0.012340242974460125, 0.010870733298361301, -0.012363673187792301, 0.024340881034731865, 0.002102173864841461, -0.012059740722179413, 0.01977889984846115, -0.01981772854924202, -0.01408790610730648, 0.012559263966977596, -0.002082603285089135, 0.007528300397098064, 0.026997674256563187, -0.01052336860448122, -0.014920263551175594, 0.005067087709903717, 0.003544847946614027, -0.018898144364356995, -0.0081374766305089, -0.036997027695178986, 0.0003397548571228981, -0.019712885841727257, -0.004398426041007042, -0.039350081235170364, 0.01599687524139881, 0.026161037385463715, -0.0076543721370399, -0.011813698336482048, 0.0046318829990923405, -0.015193561092019081, 0.0026564705185592175, 0.005674352403730154, -0.019270414486527443, 0.01656905561685562, 0.015603264793753624, -0.014052958227694035, 0.006996374111622572, -0.02792644128203392, -0.035882655531167984, -0.011499639600515366, -0.0038525101263076067, -0.004764233715832233, 0.02546367421746254, 0.04385506361722946, 0.015397674404084682, -0.0013809357769787312, -0.0009901036974042654, 0.0001122518369811587, -0.003334264736622572, 0.03538162261247635, -0.0015743070980533957, -0.002375634852796793, -0.016721803694963455, 0.020702945068478584, -0.01892886310815811, -0.005655535496771336, -0.010076671838760376, -0.012540903873741627, -0.008144616149365902, 0.01843920163810253, 0.0018893360393121839, -0.002516418229788542, -0.008176185190677643, 0.001942258095368743, 0.024492410942912102, 0.020326241850852966, 0.028259750455617905, 0.0042038061656057835, -0.020344149321317673, 0.015674380585551262, 0.014548246748745441, 0.027964357286691666, 0.00888014119118452, -0.012406482361257076, -0.05167323723435402, -0.03078628145158291, -0.005042042583227158, 0.02372106723487377, -0.00736968033015728, 0.010218181647360325, -0.013124516233801842, -0.008044169284403324, 0.010520095005631447, 0.005561995320022106, 0.021618319675326347, 0.02862992323935032, 0.009091737680137157, 0.021043425425887108, 0.01773924194276333, 0.04213305190205574, -0.006726520601660013, 0.04071580618619919, -0.03269629925489426, 0.018825065344572067, 0.046047136187553406, -0.02938213385641575, 0.015778064727783203, -0.006057696882635355, 0.006428316235542297, -0.01420268602669239, 0.030464045703411102, -0.002448837971314788, 0.012781074270606041, -0.016828753054142, -0.023663189262151718, 0.018488630652427673, -0.045323457568883896, 0.0037064175121486187, 0.002913739299401641, -0.008330711163580418, 0.024225609377026558, -0.017567850649356842, 0.0018023320008069277, -0.006980669219046831, -0.019382553175091743, -0.001860154210589826, 0.016808219254016876, 0.0061479429714381695, 0.01058582216501236, -0.042127709835767746, -0.02071322686970234, 0.025002174079418182, -0.030113685876131058, -0.02306627295911312, -0.03290226683020592, -0.009672964923083782, 0.03738393262028694, 0.040425095707178116, -0.03907371312379837, -0.03412050008773804, 0.008126838132739067, 0.024371294304728508, -0.04400717467069626, 0.0003857500269077718, 0.016115102916955948, -0.029309015721082687, 0.01950220949947834, -0.006159611511975527, -0.004895802121609449, -0.016210295259952545, -0.013117247261106968, -0.006657449062913656, 0.004355574958026409, 0.023292301222682, -0.0007659733528271317, 0.0014287902740761638, -0.0056495340541005135, -0.02707950957119465, -0.03222488984465599, 0.004794982261955738, -0.0022141151130199432, -0.04787970334291458, -0.0010852159466594458, 0.03196459636092186, 0.055236149579286575, 0.007545572705566883, -0.0150687787681818, -0.000030332319511217065, -0.0076913367956876755, -0.03137559816241264]. (VIOLATED_CONSTRAINT) (version 23.3.2.1) (from 192.168.65.1:24138) (in query: INSERT INTO default.docs (`page_content`, `embeddings`) FORMAT Native ), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<String, String, unsigned long, String, String&>(int, FormatStringHelperImpl<std::type_identity<String>::type, std::type_identity<String>::type, std::type_identity<unsigned long>::type, std::type_identity<String>::type, std::type_identity<String&>::type>, String&&, String&&, unsigned long&&, String&&, String&) @ 0x18e873cc in /usr/bin/clickhouse
3. ./build/./src/Processors/Transforms/CheckConstraintsTransform.cpp:0: DB::CheckConstraintsTransform::onConsume(DB::Chunk) @ 0x18e86c80 in /usr/bin/clickhouse
4. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<DB::ExceptionKeepingTransform::work()::$_2, void ()>>(std::__function::__policy_storage const*) @ 0x18e9a12b in /usr/bin/clickhouse
5. ./build/./src/Processors/Transforms/ExceptionKeepingTransform.cpp:103: DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x18e99fc2 in /usr/bin/clickhouse
6. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:818: DB::ExceptionKeepingTransform::work() @ 0x18e9929a in /usr/bin/clickhouse
7. ./build/./src/Processors/Executors/ExecutionThreadContext.cpp:0: DB::ExecutionThreadContext::executeTask() @ 0x18ce950c in /usr/bin/clickhouse
8. ./build/./src/Processors/Executors/PipelineExecutor.cpp:248: DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x18cdfd7b in /usr/bin/clickhouse
9. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::PipelineExecutor::executeImpl(unsigned long) @ 0x18cdf6b9 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:274: DB::PipelineExecutor::execute(unsigned long) @ 0x18cdf497 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/atomic:958: DB::CompletedPipelineExecutor::execute() @ 0x18cde2df in /usr/bin/clickhouse
12. ./build/./src/Interpreters/executeQuery.cpp:0: DB::executeQuery(DB::ReadBuffer&, DB::WriteBuffer&, bool, std::shared_ptr<DB::Context>, std::function<void (DB::QueryResultDetails const&)>, std::optional<DB::FormatSettings> const&) @ 0x17f6a6e3 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/optional:260: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c4a8e0 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
15. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
16. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
18. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
19. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
20. ? @ 0x7f3895a94ac3 in ?
21. ? @ 0x7f3895b26850 in ?

2024.10.09 23:12:07.108703 [ 39 ] {955a0899-13e2-48f8-88b9-8478a4380a85} <Error> DynamicQueryHandler: Code: 469. DB::Exception: Constraint `check_data_length` for table default.docs (3c4d917d-57dc-4cc8-ab39-33b8d956ac9c) is violated at row 1. Expression: (length(embeddings) = 768). Column values: embeddings = [0.04112676903605461, -0.008400964550673962, 0.09749477356672287, -0.053131524473428726, -0.001413525315001607, 0.03715737536549568, 0.008255580440163612, -0.025049051269888878, -0.0015678626950830221, -0.028389258310198784, 0.010690483264625072, -0.006459140218794346, 0.20259089767932892, 0.032178185880184174, 0.046765342354774475, 0.01466406974941492, -0.04373771324753761, 0.023064764216542244, 0.027008596807718277, 0.05068179965019226, -0.11421819031238556, -0.05220935121178627, 0.10694943368434906, 0.09731987863779068, -0.036210861057043076, -0.017703868448734283, -0.021764438599348068, -0.031486380845308304, 0.06449003517627716, -0.06462034583091736, 0.11916103214025497, 0.03971036896109581, -0.01853313483297825, 0.058251846581697464, 0.008044475689530373, 0.01547224447131157, -0.044564105570316315, 0.06325632333755493, 0.005558537319302559, -0.03139401599764824, -0.08913689851760864, -0.04606947302818298, -0.014500710181891918, -0.051759328693151474, 0.006230400409549475, -0.060991041362285614, 0.052895113825798035, 0.016175515949726105, -0.0173935666680336, 0.055896636098623276, -0.004420056007802486, -0.009099304676055908, 0.04762881621718407, -0.02145329862833023, -0.04269666597247124, 0.02086651511490345, 0.018043765798211098, 0.029654046520590782, 0.05177649110555649, 0.07189029455184937, -0.07093359529972076, 0.0010210160398855805, 0.03791459649801254, -0.034294936805963516, 0.0004765923658851534, 0.018332112580537796, 0.0665619820356369, -0.002618261380121112, 0.11268480122089386, -0.04894984886050224, 0.018420640379190445, -0.01757984422147274, -0.010174473747611046, 0.04525480791926384, -0.021397139877080917, 0.11532675474882126, -0.055264171212911606, -0.015345095656812191, -0.12123377621173859, -0.011908014304935932, -0.15089012682437897, 0.040806662291288376, -0.011781638488173485, -0.005612982902675867, 0.006401349790394306, -0.01635991781949997, -0.009834450669586658, 0.010021897032856941, -0.03097623586654663, -0.04822486639022827, 0.016370205208659172, -0.029412854462862015, -0.01282628532499075, -0.04488382861018181, 0.013726006262004375, -0.021837204694747925, 0.04366128891706467, -0.029287194833159447, -0.010640166699886322, -0.10984556376934052, 0.017254607751965523, -0.0004918534541502595, -0.04328940436244011, 0.03474825620651245, 0.041193265467882156, 0.05670227110385895, 0.04823417216539383, -0.019503487274050713, 0.05669773742556572, -0.010472320020198822, -0.009554700925946236, -0.03481427952647209, -0.06290591508150101, 0.020141661167144775, -0.06863225996494293, -0.04927641525864601, 0.013040315359830856, 0.010648333467543125, 0.034409452229738235, 0.07569956034421921, 0.014744537882506847, 0.04826740175485611, -0.005035950802266598, -0.012604649178683758, 0.02325516566634178, -0.054228488355875015, -0.07620903104543686, 0.0764530748128891, -0.0679018422961235, -0.011016343720257282, 0.007538978476077318, -0.03399340808391571, 0.028552360832691193, -0.036915022879838943, -0.0928267166018486, -0.04258729889988899, 0.04170601814985275, 0.0557204894721508, 0.0054741413332521915, -0.0508527010679245, 0.018909351900219917, -0.09906692057847977, -0.029620744287967682, 0.017833711579442024, -0.019879205152392387, 0.0006834550877101719, 0.047341156750917435, -0.04990822449326515, -0.01716255210340023, 0.039507120847702026, 0.002763956319540739, 0.04233676195144653, -0.09128551185131073, 0.021852998062968254, -0.045491334050893784, -0.003876769682392478, -0.04667738080024719, -0.018148822709918022, 0.02576877921819687, 0.012938815169036388, -0.01759943924844265, 0.05042668431997299, 0.0072966814041137695, 0.07770740985870361, -0.045169148594141006, -0.07323839515447617, 0.008351152762770653, 0.007953478023409843, -0.004714835435152054, -0.032919175922870636, -0.06336789578199387, -0.010174283757805824, 0.008563329465687275, 0.02098591811954975, -0.033558834344148636, -0.037677280604839325, 0.02241131290793419, -0.049901265650987625, 0.009958988055586815, -0.03820584714412689, 0.04470084607601166, 0.01590130664408207, -0.016525981947779655, -0.003101245267316699, 0.04618902504444122, 0.005928968079388142, 0.04641854390501976, 0.013662979006767273, -0.02730601839721203, -0.02260732650756836, 0.019516505300998688, 0.014044861309230328, 0.009985015727579594, 0.0036300497595220804, 0.007266989443451166, 0.06509029120206833, -0.010095532052218914, 0.018118733540177345, -0.030959732830524445, -0.02009149268269539, 0.03921203687787056, 0.017353219911456108, -0.01061128918081522, -0.04410579428076744, 0.01570095494389534, -0.007173595950007439, 0.004249447025358677, 0.0384400375187397, 0.03772586211562157, 0.05227470025420189, -0.015308933332562447, 0.038963090628385544, -0.01851087063550949, -0.04436035454273224, -0.037230417132377625, 0.04432890564203262, -0.042224857956171036, 0.038043003529310226, -0.011614635586738586, -0.009917216375470161, -0.005439909175038338, 0.005710291676223278, -0.01292689610272646, -0.017040517181158066, -0.02342803217470646, -0.007542700972408056, -0.01887032575905323, -0.00408390024676919, -0.01913602463901043, 0.0015421768184751272, 0.03318754583597183, 0.04709598049521446, 0.05091400444507599, 0.024551717564463615, 0.05177771672606468, -0.03418348729610443, -0.041375115513801575, 0.05476862192153931, -0.017739688977599144, 0.02319563925266266, 0.04009556025266647, -0.05034223198890686, -0.012569224461913109, -0.040207114070653915, 0.047189194709062576, 0.06881839036941528, 0.036453623324632645, 0.007383022923022509, -0.07399331778287888, 0.04669874534010887, 0.04590693861246109, -0.03657842054963112, -0.029057389125227928, -0.023157374933362007, 0.006855986081063747, -0.013003568165004253, 0.03766760230064392, 0.023585092276334763, -0.014273903332650661, 0.024112064391374588, 0.020958127453923225, 0.030608143657445908, 0.00935056246817112, 0.003458634717389941, 0.07281047105789185, 0.036470428109169006, -0.055507928133010864, 0.030497970059514046, 0.07009201496839523, 0.029175128787755966, -0.04006607085466385, 0.02121541276574135, -0.07111053168773651, 0.005707551725208759, 0.03345181420445442, 0.058384835720062256, 0.00447284197434783, -0.024309294298291206, 0.01540397573262453, -0.00007842402555979788, -0.005186615511775017, -0.009474387392401695, -0.017360340803861618, 0.0375961996614933, -0.024325352162122726, 0.10852240025997162, 0.04295344650745392, 0.018111594021320343, 0.014796697534620762, -0.04984721541404724, -0.014833662658929825, -0.007269750349223614, 0.028995905071496964, -0.01402225811034441, -0.00007969354192027822, -0.008047026582062244, 0.02774444781243801, 0.0040969871915876865, -0.008088630624115467, -0.017454709857702255, 0.031756941229104996, -0.037631139159202576, -0.009362776763737202, -0.03553250804543495, -0.02473743073642254, -0.005112426821142435, 0.010493204928934574, -0.01688285544514656, -0.013335518538951874, 0.0016652642516419291, 0.008578014560043812, 0.047118835151195526, -0.03651205822825432, 0.020822320133447647, 0.05174384266138077, 0.05402554199099541, 0.005726643837988377, 0.024147391319274902, -0.012216254137456417, -0.03834644332528114, -0.021724883466959, 0.022474365308880806, -0.0072288778610527515, -0.013360566459596157, 0.03644173592329025, 0.03198769688606262, -0.028750363737344742, -0.0372941717505455, -0.002340676262974739, 0.015134798362851143, 0.018716948106884956, 0.07642769813537598, -0.014287699945271015, 0.0071293264627456665, 0.00017217350250575691, -0.028243685141205788, -0.03771013393998146, 0.025617297738790512, -0.029350411146879196, 0.0410865917801857, 0.009700339287519455, -0.0030304566025733948, -0.006925365421921015, 0.025001641362905502, 0.012117253616452217, 0.019071267917752266, -0.053252384066581726, 0.03433280438184738, -0.07949414104223251, 0.01415552943944931, -0.034957777708768845, -0.044917937368154526, -0.022444983944296837, 0.01898389495909214, -0.009450245648622513, 0.05393995717167854, -0.007413389626890421, -0.042290300130844116, -0.0021597088780254126, 0.006635033525526524, 0.005249409936368465, -0.018422018736600876, 0.008196841925382614, 0.03559621796011925, 0.030688943341374397, 0.006063733249902725, -0.009056570008397102, 0.011896943673491478, 0.006002794019877911, -0.028651341795921326, 0.029948590323328972, -0.005105042830109596, -0.041034799069166183, -0.009642736054956913, -0.04087080433964729, -0.030866360291838646, 0.03304264694452286, -0.006581900641322136, 0.03131371736526489, 0.011574024334549904, 0.0020294361747801304, -0.03986697643995285, 0.06552740186452866, 0.0002521446440368891, -0.06849580258131027, 0.005251407623291016, 0.005539783742278814, -0.013817114755511284, 0.00877917930483818, 0.007843996398150921, -0.00521165831014514, 0.030877962708473206, 0.03003661334514618, -0.01015123724937439, -0.025567078962922096, -0.00979952048510313, -0.00982715655118227, -0.01679673045873642, -0.03347286581993103, 0.010995552875101566, 0.04239370673894882, 0.012884977273643017, -0.01967129297554493, -0.02690216153860092, -0.0537419393658638, 0.04612419754266739, -0.024626154452562332, 0.024760078638792038, 0.010672315023839474, -0.0009442606824450195, 0.02980009652674198, -0.03142961114645004, 0.005180883686989546, 0.015273631550371647, 0.007293933071196079, -0.013583612628281116, 0.030973216518759727, -0.037088122218847275, -0.02731720358133316, -0.029258398339152336, -0.015127088874578476, 0.024791836738586426, -0.031368620693683624, -0.03179318830370903, 0.011125358752906322, -0.026527008041739464, 0.035565946251153946, 0.007999823428690434, 0.016748348250985146, 0.0578162707388401, 0.02152731828391552, -0.024239664897322655, 0.02873917482793331, -0.016491128131747246, 0.003806576831266284, -0.0379222109913826, -0.019340209662914276, -0.028069239109754562, 0.020346377044916153, -0.04691646993160248, 0.040187425911426544, -0.030056890100240707, -0.00934668816626072, 0.034412872046232224, 0.019517192617058754, 0.00571842584758997, 0.007056301459670067, -0.031052365899086, -0.018865026533603668, 0.01035971287637949, 0.02340511791408062, 0.03356312960386276, 0.024721812456846237, 0.020413683727383614, 0.06188393384218216, 0.0024855586234480143, -0.034079745411872864, 0.013799524866044521, -0.0264658872038126, 0.022548187524080276, 0.004792942199856043, 0.0048643918707966805, -0.02826474793255329, 0.007719140965491533, -0.0002229060628451407, -0.014499436132609844, -0.058232128620147705, 0.006874094717204571, -0.020141853019595146, 0.011796528473496437, -0.03683674708008766, -0.020144635811448097, -0.06310122460126877, -0.0005744993686676025, -0.009568058885633945, 0.03347845748066902, -0.028822394087910652, 0.008713101968169212, -0.01366719976067543, 0.000556181010324508, 0.03903563320636749, 0.010797100141644478, 0.01823129877448082, -0.0009091593092307448, 0.032228969037532806, -0.004630065523087978, -0.005639039445668459, 0.020894596353173256, -0.00008655933197587729, -0.020166857168078423, 0.011366728693246841, -0.024981791153550148, -0.028785396367311478, -0.0005089910700917244, 0.025930508971214294, 0.024389345198869705, 0.028883565217256546, -0.03519399091601372, 0.046732936054468155, -0.0015605516964569688, -0.020675430074334145, 0.03479232266545296, -0.03526531532406807, -0.03545811399817467, 0.024641871452331543, -0.0017004553228616714, 0.019755203276872635, 0.015506728552281857, 0.012084905058145523, -0.003097117878496647, -0.0360398069024086, -0.0027035255916416645, 0.030154524371027946, -0.040230561047792435, 0.008995968848466873, -0.04338430240750313, -0.0011625747429206967, 0.005406067240983248, 0.00898006372153759, 0.025237154215574265, -0.02205396443605423, 0.02120666205883026, -0.008092467673122883, 0.053548622876405716, -0.00878408458083868, -0.0008121957071125507, 0.008075183257460594, -0.013216770254075527, 0.003094600047916174, -0.005302043631672859, -0.014354857616126537, 0.009537110105156898, 0.05724840238690376, 0.0038471973966807127, 0.013702616095542908, -0.013545074500143528, 0.028473442420363426, 0.07334710657596588, 0.007879437878727913, -0.010901509784162045, -0.016215741634368896, -0.013836121186614037, -0.0039771017618477345, 0.05668671429157257, -0.01651117205619812, 0.02169436402618885, -0.003131014760583639, -0.0020890343002974987, 0.018677733838558197, 0.01342421118170023, -0.03208912909030914, 0.02090190351009369, 0.06153852492570877, -0.0017614222597330809, 0.007354092784225941, -0.020615138113498688, 0.028870582580566406, 0.03088679350912571, 0.00023880874505266547, -0.027481626719236374, -0.010605577379465103, -0.05585501715540886, -0.02246074564754963, -0.003517249133437872, 0.037035197019577026, -0.03140551969408989, -0.027843017131090164, 0.024822216480970383, -0.03815183788537979, -0.028419118374586105, -0.001893513253889978, 0.021165264770388603, -0.03769949823617935, 0.02438555657863617, -0.0329190157353878, -0.012152718380093575, -0.008549747057259083, -0.014017218723893166, 0.03758098557591438, 0.017697574570775032, 0.0314563512802124, -0.020938124507665634, -0.004193033557385206, 0.00010984546679537743, -0.05198754742741585, 0.03512177616357803, -0.004685565363615751, 0.013876876793801785, -0.0030888968612998724, 0.019371680915355682, -0.05528497323393822, 0.008958532474935055, 0.0006540937465615571, 0.00017407086852472275, -0.0056823864579200745, 0.02045457623898983, -0.01926295831799507, -0.007989882491528988, -0.012086545117199421, 0.01420773658901453, -0.011442702263593674, -0.05625816062092781, -0.03793339058756828, -0.008988410234451294, 0.002976102288812399, -0.011346818879246712, -0.023046011105179787, -0.010411012917757034, -0.00815978366881609, 0.003365460317581892, 0.02891707420349121, -0.015214743092656136, 0.0053184968419373035, 0.02783309295773506, -0.03096819296479225, 0.0023907998111099005, -0.026923296973109245, -0.022503618150949478, -0.043741073459386826, -0.02819158136844635, 0.018597133457660675, 0.002268814481794834, -0.0029174548108130693, -0.025284741073846817, -0.00319598987698555, -0.03348339721560478, 0.01935933157801628, 0.039952851831912994, 0.04389861971139908, 0.024804934859275818, 0.0007417522720061243, -0.02417057938873768, -0.007191809359937906, 0.01685091108083725, -0.03149881586432457, -0.000010680488230718765, 0.041556090116500854, -0.003227245295420289, -0.04296642541885376, 0.029496148228645325, -0.05517983064055443, -0.026096805930137634, 0.025703152641654015, -0.04826205223798752, 0.011460854671895504, 0.025536416098475456, 0.06379643827676773, 0.04230910912156105, -0.027765994891524315, -0.024022798985242844, -0.011495410464704037, 0.022165372967720032, -0.016285767778754234, 0.03393073007464409, -0.04509823024272919, 0.012565627694129944, -0.0021136151626706123, -0.020885808393359184, -0.024248279631137848, 0.009134472347795963, -0.018834421411156654, -0.0217552799731493, -0.05108245462179184, 0.006296403240412474, 0.017696307972073555, 0.04843733832240105, 0.012255779467523098, 0.04236619547009468, -0.0453970767557621, 0.021040739491581917, -0.026848934590816498, -0.04417773708701134, -0.02701510116457939, -0.02679886482656002, 0.00868728756904602, 0.012282646261155605, -0.0023587073665112257, 0.0077600120566785336, -0.008334517478942871, -0.014376750215888023, 0.00024675397435203195, -0.04333096742630005, 0.02545076794922352, 0.04097384959459305, -0.006867955904453993, -0.004614207427948713, 0.006639937870204449, -0.025192759931087494, 0.005046755541115999, 0.029727432876825333, -0.0036288874689489603, 0.028330594301223755, -0.05291871726512909, 0.016500743106007576, -0.024655256420373917, 0.027101678773760796, -0.036831893026828766, -0.029537169262766838, -0.007847853004932404, -0.01710391230881214, 0.004529262892901897, -0.017477143555879593, -0.011326992884278297, 0.03385044261813164, 0.0025562187656760216, -0.030649572610855103, 0.028829025104641914, -0.01702794060111046, 0.003773796372115612, 0.06318812817335129, 0.024801107123494148, 0.0005973030929453671, -0.006220902781933546, -0.020438410341739655, 0.03914552927017212, 0.02747317962348461, -0.009098367765545845, -0.030245523899793625, -0.011044243350625038, 0.0008789818966761231, 0.035039544105529785, 0.022321708500385284, 0.025502661243081093, 0.03415408357977867, 0.011689180508255959, 0.029431642964482307, -0.014848055317997932, -0.013332908041775227, -0.04088233783841133, 0.0016417226288467646, -0.0001908252015709877, -0.048127591609954834, 0.01309671439230442, 0.017438720911741257, -0.023462088778614998, 0.028764156624674797, 0.015662427991628647, 0.015431550331413746, -0.01649722456932068, 0.00826359260827303, -0.002190323080867529, -0.006923543754965067, -0.012776247225701809, -0.03024160861968994, 0.021992236375808716, -0.009583735838532448, 0.006758818868547678, 0.011797710321843624, 0.06525582820177078, -0.01793454773724079, -0.009243237785995007, 0.016094516962766647, -0.011445008218288422, -0.01743880845606327, -0.008408263325691223, 0.01403969619423151, -0.010894207283854485, 0.013176471926271915, -0.017324630171060562, -0.03186485171318054, -0.03562108427286148, 0.0384221114218235, 0.008773223496973515, -0.0024316865019500256, -0.007962893694639206, -0.012082628905773163, -0.008132019080221653, -0.045298200100660324, -0.037971559911966324, -0.011736966669559479, 0.025261100381612778, -0.02263030968606472, 0.001445906120352447, -0.016075950115919113, 0.0295853354036808, 0.016559265553951263, -0.009476060047745705, -0.024880675598978996, 0.005245420150458813, 0.024844862520694733, -0.007902298122644424, -0.014811310917139053, 0.018835658207535744, 0.013316920027136803, 0.02936268411576748, -0.013327701948583126, 0.013596398755908012, -0.010030603967607021, 0.02471514418721199, 0.010211591608822346, -0.006804019678384066, -0.015354492701590061, -0.004576915875077248, 0.03325419872999191, 0.006882003508508205, 0.013088996522128582, 0.01640736311674118, -0.018102262169122696, 0.0014430301962420344, 0.02442939206957817, -0.01429260615259409, 0.015081748366355896, -0.02540522813796997, -0.0119558647274971, -0.004332041367888451, -0.008295868523418903, -0.020444106310606003, -0.007604793645441532, 0.003364169504493475, 0.00020354773732833564, -0.002697459189221263, -0.005108331795781851, 0.008935454301536083, -0.02733936719596386, 0.0063319639302790165, 0.01937936432659626, -0.040439147502183914, 0.0017137906979769468, -0.011859148740768433, -0.0034289464820176363, 0.0036989920772612095, 0.007740485016256571, 0.015089968219399452, -0.007275377865880728, -0.009799518622457981, 0.016716966405510902, -0.0032311684917658567, -0.060726191848516464, 0.002828961471095681, 0.011269385926425457, 0.02417968399822712, -0.026233196258544922, -0.018231205642223358, -0.011497975327074528, -0.009086895734071732, 0.01099392119795084, 0.04455692321062088, 0.0019239230314269662, -0.02908186987042427, 0.02461799792945385, -0.0021742903627455235, -0.004481333773583174, 0.011874686926603317, 0.019026774913072586, 0.01927514187991619, -0.023444704711437225, 0.014641212299466133, 0.0012568593956530094, 0.0016372279496863484, -0.015481566078960896, 0.00914992019534111, 0.017788812518119812, -0.003122493391856551, -0.008762910030782223, -0.00434125354513526, 0.04606098309159279, -0.008591116406023502, 0.0005484759458340704, -0.001336159068159759, -0.017760811373591423, 0.025090107694268227, 0.001943016890436411, -0.010332999750971794, 0.042990852147340775, 0.012340242974460125, 0.010870733298361301, -0.012363673187792301, 0.024340881034731865, 0.002102173864841461, -0.012059740722179413, 0.01977889984846115, -0.01981772854924202, -0.01408790610730648, 0.012559263966977596, -0.002082603285089135, 0.007528300397098064, 0.026997674256563187, -0.01052336860448122, -0.014920263551175594, 0.005067087709903717, 0.003544847946614027, -0.018898144364356995, -0.0081374766305089, -0.036997027695178986, 0.0003397548571228981, -0.019712885841727257, -0.004398426041007042, -0.039350081235170364, 0.01599687524139881, 0.026161037385463715, -0.0076543721370399, -0.011813698336482048, 0.0046318829990923405, -0.015193561092019081, 0.0026564705185592175, 0.005674352403730154, -0.019270414486527443, 0.01656905561685562, 0.015603264793753624, -0.014052958227694035, 0.006996374111622572, -0.02792644128203392, -0.035882655531167984, -0.011499639600515366, -0.0038525101263076067, -0.004764233715832233, 0.02546367421746254, 0.04385506361722946, 0.015397674404084682, -0.0013809357769787312, -0.0009901036974042654, 0.0001122518369811587, -0.003334264736622572, 0.03538162261247635, -0.0015743070980533957, -0.002375634852796793, -0.016721803694963455, 0.020702945068478584, -0.01892886310815811, -0.005655535496771336, -0.010076671838760376, -0.012540903873741627, -0.008144616149365902, 0.01843920163810253, 0.0018893360393121839, -0.002516418229788542, -0.008176185190677643, 0.001942258095368743, 0.024492410942912102, 0.020326241850852966, 0.028259750455617905, 0.0042038061656057835, -0.020344149321317673, 0.015674380585551262, 0.014548246748745441, 0.027964357286691666, 0.00888014119118452, -0.012406482361257076, -0.05167323723435402, -0.03078628145158291, -0.005042042583227158, 0.02372106723487377, -0.00736968033015728, 0.010218181647360325, -0.013124516233801842, -0.008044169284403324, 0.010520095005631447, 0.005561995320022106, 0.021618319675326347, 0.02862992323935032, 0.009091737680137157, 0.021043425425887108, 0.01773924194276333, 0.04213305190205574, -0.006726520601660013, 0.04071580618619919, -0.03269629925489426, 0.018825065344572067, 0.046047136187553406, -0.02938213385641575, 0.015778064727783203, -0.006057696882635355, 0.006428316235542297, -0.01420268602669239, 0.030464045703411102, -0.002448837971314788, 0.012781074270606041, -0.016828753054142, -0.023663189262151718, 0.018488630652427673, -0.045323457568883896, 0.0037064175121486187, 0.002913739299401641, -0.008330711163580418, 0.024225609377026558, -0.017567850649356842, 0.0018023320008069277, -0.006980669219046831, -0.019382553175091743, -0.001860154210589826, 0.016808219254016876, 0.0061479429714381695, 0.01058582216501236, -0.042127709835767746, -0.02071322686970234, 0.025002174079418182, -0.030113685876131058, -0.02306627295911312, -0.03290226683020592, -0.009672964923083782, 0.03738393262028694, 0.040425095707178116, -0.03907371312379837, -0.03412050008773804, 0.008126838132739067, 0.024371294304728508, -0.04400717467069626, 0.0003857500269077718, 0.016115102916955948, -0.029309015721082687, 0.01950220949947834, -0.006159611511975527, -0.004895802121609449, -0.016210295259952545, -0.013117247261106968, -0.006657449062913656, 0.004355574958026409, 0.023292301222682, -0.0007659733528271317, 0.0014287902740761638, -0.0056495340541005135, -0.02707950957119465, -0.03222488984465599, 0.004794982261955738, -0.0022141151130199432, -0.04787970334291458, -0.0010852159466594458, 0.03196459636092186, 0.055236149579286575, 0.007545572705566883, -0.0150687787681818, -0.000030332319511217065, -0.0076913367956876755, -0.03137559816241264]. (VIOLATED_CONSTRAINT), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<String, String, unsigned long, String, String&>(int, FormatStringHelperImpl<std::type_identity<String>::type, std::type_identity<String>::type, std::type_identity<unsigned long>::type, std::type_identity<String>::type, std::type_identity<String&>::type>, String&&, String&&, unsigned long&&, String&&, String&) @ 0x18e873cc in /usr/bin/clickhouse
3. ./build/./src/Processors/Transforms/CheckConstraintsTransform.cpp:0: DB::CheckConstraintsTransform::onConsume(DB::Chunk) @ 0x18e86c80 in /usr/bin/clickhouse
4. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<DB::ExceptionKeepingTransform::work()::$_2, void ()>>(std::__function::__policy_storage const*) @ 0x18e9a12b in /usr/bin/clickhouse
5. ./build/./src/Processors/Transforms/ExceptionKeepingTransform.cpp:103: DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x18e99fc2 in /usr/bin/clickhouse
6. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:818: DB::ExceptionKeepingTransform::work() @ 0x18e9929a in /usr/bin/clickhouse
7. ./build/./src/Processors/Executors/ExecutionThreadContext.cpp:0: DB::ExecutionThreadContext::executeTask() @ 0x18ce950c in /usr/bin/clickhouse
8. ./build/./src/Processors/Executors/PipelineExecutor.cpp:248: DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x18cdfd7b in /usr/bin/clickhouse
9. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::PipelineExecutor::executeImpl(unsigned long) @ 0x18cdf6b9 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:274: DB::PipelineExecutor::execute(unsigned long) @ 0x18cdf497 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/atomic:958: DB::CompletedPipelineExecutor::execute() @ 0x18cde2df in /usr/bin/clickhouse
12. ./build/./src/Interpreters/executeQuery.cpp:0: DB::executeQuery(DB::ReadBuffer&, DB::WriteBuffer&, bool, std::shared_ptr<DB::Context>, std::function<void (DB::QueryResultDetails const&)>, std::optional<DB::FormatSettings> const&) @ 0x17f6a6e3 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/optional:260: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c4a8e0 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
15. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
16. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
18. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
19. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
20. ? @ 0x7f3895a94ac3 in ?
21. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.09 23:13:11.836347 [ 238 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.89 GiB (attempt to allocate chunk of 4360448 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:157: DB::WriteBufferFromFileBase::WriteBufferFromFileBase(unsigned long, char*, unsigned long) @ 0x127a5e2c in /usr/bin/clickhouse
10. ./build/./src/IO/WriteBufferFromFileDescriptor.cpp:93: DB::WriteBufferFromFileDescriptor::WriteBufferFromFileDescriptor(int, unsigned long, char*, unsigned long, String) @ 0x127a599b in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::WriteBufferFromFile::WriteBufferFromFile(String const&, unsigned long, int, unsigned int, char*, unsigned long) @ 0x12825d14 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/string:1499: std::__unique_if<DB::WriteBufferFromFile>::__unique_single std::make_unique[abi:v15000]<DB::WriteBufferFromFile, std::__fs::filesystem::path, unsigned long&, int&>(std::__fs::filesystem::path&&, unsigned long&, int&) @ 0x1717a40f in /usr/bin/clickhouse
13. ./build/./src/Disks/DiskLocal.cpp:0: DB::DiskLocal::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1717144d in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/DataPartStorageOnDiskFull.cpp:0: DB::DataPartStorageOnDiskFull::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1878a0c5 in /usr/bin/clickhouse
15. ./build/./src/Storages/MergeTree/IDataPartStorage.h:0: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f41e4 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
17. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
20. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
24. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
27. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
28. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
29. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
31. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.09 23:13:56.724743 [ 239 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360288 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:157: DB::WriteBufferFromFileBase::WriteBufferFromFileBase(unsigned long, char*, unsigned long) @ 0x127a5e2c in /usr/bin/clickhouse
10. ./build/./src/IO/WriteBufferFromFileDescriptor.cpp:93: DB::WriteBufferFromFileDescriptor::WriteBufferFromFileDescriptor(int, unsigned long, char*, unsigned long, String) @ 0x127a599b in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::WriteBufferFromFile::WriteBufferFromFile(String const&, unsigned long, int, unsigned int, char*, unsigned long) @ 0x12825d14 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/string:1499: std::__unique_if<DB::WriteBufferFromFile>::__unique_single std::make_unique[abi:v15000]<DB::WriteBufferFromFile, std::__fs::filesystem::path, unsigned long&, int&>(std::__fs::filesystem::path&&, unsigned long&, int&) @ 0x1717a40f in /usr/bin/clickhouse
13. ./build/./src/Disks/DiskLocal.cpp:0: DB::DiskLocal::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1717144d in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/DataPartStorageOnDiskFull.cpp:0: DB::DataPartStorageOnDiskFull::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1878a0c5 in /usr/bin/clickhouse
15. ./build/./src/Storages/MergeTree/IDataPartStorage.h:0: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f41e4 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
17. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
20. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
24. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
27. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
28. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
29. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
31. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.09 23:15:48.992234 [ 39 ] {7275f69c-b56e-4ca9-906c-c8daec6550f4} <Error> executeQuery: Code: 469. DB::Exception: Constraint `check_data_length` for table default.docs (6886a049-4115-4e25-a298-8a6827c7eb19) is violated at row 1. Expression: (length(embeddings) = 768). Column values: embeddings = [0.04112676903605461, -0.008400964550673962, 0.09749477356672287, -0.053131524473428726, -0.001413525315001607, 0.03715737536549568, 0.008255580440163612, -0.025049051269888878, -0.0015678626950830221, -0.028389258310198784, 0.010690483264625072, -0.006459140218794346, 0.20259089767932892, 0.032178185880184174, 0.046765342354774475, 0.01466406974941492, -0.04373771324753761, 0.023064764216542244, 0.027008596807718277, 0.05068179965019226, -0.11421819031238556, -0.05220935121178627, 0.10694943368434906, 0.09731987863779068, -0.036210861057043076, -0.017703868448734283, -0.021764438599348068, -0.031486380845308304, 0.06449003517627716, -0.06462034583091736, 0.11916103214025497, 0.03971036896109581, -0.01853313483297825, 0.058251846581697464, 0.008044475689530373, 0.01547224447131157, -0.044564105570316315, 0.06325632333755493, 0.005558537319302559, -0.03139401599764824, -0.08913689851760864, -0.04606947302818298, -0.014500710181891918, -0.051759328693151474, 0.006230400409549475, -0.060991041362285614, 0.052895113825798035, 0.016175515949726105, -0.0173935666680336, 0.055896636098623276, -0.004420056007802486, -0.009099304676055908, 0.04762881621718407, -0.02145329862833023, -0.04269666597247124, 0.02086651511490345, 0.018043765798211098, 0.029654046520590782, 0.05177649110555649, 0.07189029455184937, -0.07093359529972076, 0.0010210160398855805, 0.03791459649801254, -0.034294936805963516, 0.0004765923658851534, 0.018332112580537796, 0.0665619820356369, -0.002618261380121112, 0.11268480122089386, -0.04894984886050224, 0.018420640379190445, -0.01757984422147274, -0.010174473747611046, 0.04525480791926384, -0.021397139877080917, 0.11532675474882126, -0.055264171212911606, -0.015345095656812191, -0.12123377621173859, -0.011908014304935932, -0.15089012682437897, 0.040806662291288376, -0.011781638488173485, -0.005612982902675867, 0.006401349790394306, -0.01635991781949997, -0.009834450669586658, 0.010021897032856941, -0.03097623586654663, -0.04822486639022827, 0.016370205208659172, -0.029412854462862015, -0.01282628532499075, -0.04488382861018181, 0.013726006262004375, -0.021837204694747925, 0.04366128891706467, -0.029287194833159447, -0.010640166699886322, -0.10984556376934052, 0.017254607751965523, -0.0004918534541502595, -0.04328940436244011, 0.03474825620651245, 0.041193265467882156, 0.05670227110385895, 0.04823417216539383, -0.019503487274050713, 0.05669773742556572, -0.010472320020198822, -0.009554700925946236, -0.03481427952647209, -0.06290591508150101, 0.020141661167144775, -0.06863225996494293, -0.04927641525864601, 0.013040315359830856, 0.010648333467543125, 0.034409452229738235, 0.07569956034421921, 0.014744537882506847, 0.04826740175485611, -0.005035950802266598, -0.012604649178683758, 0.02325516566634178, -0.054228488355875015, -0.07620903104543686, 0.0764530748128891, -0.0679018422961235, -0.011016343720257282, 0.007538978476077318, -0.03399340808391571, 0.028552360832691193, -0.036915022879838943, -0.0928267166018486, -0.04258729889988899, 0.04170601814985275, 0.0557204894721508, 0.0054741413332521915, -0.0508527010679245, 0.018909351900219917, -0.09906692057847977, -0.029620744287967682, 0.017833711579442024, -0.019879205152392387, 0.0006834550877101719, 0.047341156750917435, -0.04990822449326515, -0.01716255210340023, 0.039507120847702026, 0.002763956319540739, 0.04233676195144653, -0.09128551185131073, 0.021852998062968254, -0.045491334050893784, -0.003876769682392478, -0.04667738080024719, -0.018148822709918022, 0.02576877921819687, 0.012938815169036388, -0.01759943924844265, 0.05042668431997299, 0.0072966814041137695, 0.07770740985870361, -0.045169148594141006, -0.07323839515447617, 0.008351152762770653, 0.007953478023409843, -0.004714835435152054, -0.032919175922870636, -0.06336789578199387, -0.010174283757805824, 0.008563329465687275, 0.02098591811954975, -0.033558834344148636, -0.037677280604839325, 0.02241131290793419, -0.049901265650987625, 0.009958988055586815, -0.03820584714412689, 0.04470084607601166, 0.01590130664408207, -0.016525981947779655, -0.003101245267316699, 0.04618902504444122, 0.005928968079388142, 0.04641854390501976, 0.013662979006767273, -0.02730601839721203, -0.02260732650756836, 0.019516505300998688, 0.014044861309230328, 0.009985015727579594, 0.0036300497595220804, 0.007266989443451166, 0.06509029120206833, -0.010095532052218914, 0.018118733540177345, -0.030959732830524445, -0.02009149268269539, 0.03921203687787056, 0.017353219911456108, -0.01061128918081522, -0.04410579428076744, 0.01570095494389534, -0.007173595950007439, 0.004249447025358677, 0.0384400375187397, 0.03772586211562157, 0.05227470025420189, -0.015308933332562447, 0.038963090628385544, -0.01851087063550949, -0.04436035454273224, -0.037230417132377625, 0.04432890564203262, -0.042224857956171036, 0.038043003529310226, -0.011614635586738586, -0.009917216375470161, -0.005439909175038338, 0.005710291676223278, -0.01292689610272646, -0.017040517181158066, -0.02342803217470646, -0.007542700972408056, -0.01887032575905323, -0.00408390024676919, -0.01913602463901043, 0.0015421768184751272, 0.03318754583597183, 0.04709598049521446, 0.05091400444507599, 0.024551717564463615, 0.05177771672606468, -0.03418348729610443, -0.041375115513801575, 0.05476862192153931, -0.017739688977599144, 0.02319563925266266, 0.04009556025266647, -0.05034223198890686, -0.012569224461913109, -0.040207114070653915, 0.047189194709062576, 0.06881839036941528, 0.036453623324632645, 0.007383022923022509, -0.07399331778287888, 0.04669874534010887, 0.04590693861246109, -0.03657842054963112, -0.029057389125227928, -0.023157374933362007, 0.006855986081063747, -0.013003568165004253, 0.03766760230064392, 0.023585092276334763, -0.014273903332650661, 0.024112064391374588, 0.020958127453923225, 0.030608143657445908, 0.00935056246817112, 0.003458634717389941, 0.07281047105789185, 0.036470428109169006, -0.055507928133010864, 0.030497970059514046, 0.07009201496839523, 0.029175128787755966, -0.04006607085466385, 0.02121541276574135, -0.07111053168773651, 0.005707551725208759, 0.03345181420445442, 0.058384835720062256, 0.00447284197434783, -0.024309294298291206, 0.01540397573262453, -0.00007842402555979788, -0.005186615511775017, -0.009474387392401695, -0.017360340803861618, 0.0375961996614933, -0.024325352162122726, 0.10852240025997162, 0.04295344650745392, 0.018111594021320343, 0.014796697534620762, -0.04984721541404724, -0.014833662658929825, -0.007269750349223614, 0.028995905071496964, -0.01402225811034441, -0.00007969354192027822, -0.008047026582062244, 0.02774444781243801, 0.0040969871915876865, -0.008088630624115467, -0.017454709857702255, 0.031756941229104996, -0.037631139159202576, -0.009362776763737202, -0.03553250804543495, -0.02473743073642254, -0.005112426821142435, 0.010493204928934574, -0.01688285544514656, -0.013335518538951874, 0.0016652642516419291, 0.008578014560043812, 0.047118835151195526, -0.03651205822825432, 0.020822320133447647, 0.05174384266138077, 0.05402554199099541, 0.005726643837988377, 0.024147391319274902, -0.012216254137456417, -0.03834644332528114, -0.021724883466959, 0.022474365308880806, -0.0072288778610527515, -0.013360566459596157, 0.03644173592329025, 0.03198769688606262, -0.028750363737344742, -0.0372941717505455, -0.002340676262974739, 0.015134798362851143, 0.018716948106884956, 0.07642769813537598, -0.014287699945271015, 0.0071293264627456665, 0.00017217350250575691, -0.028243685141205788, -0.03771013393998146, 0.025617297738790512, -0.029350411146879196, 0.0410865917801857, 0.009700339287519455, -0.0030304566025733948, -0.006925365421921015, 0.025001641362905502, 0.012117253616452217, 0.019071267917752266, -0.053252384066581726, 0.03433280438184738, -0.07949414104223251, 0.01415552943944931, -0.034957777708768845, -0.044917937368154526, -0.022444983944296837, 0.01898389495909214, -0.009450245648622513, 0.05393995717167854, -0.007413389626890421, -0.042290300130844116, -0.0021597088780254126, 0.006635033525526524, 0.005249409936368465, -0.018422018736600876, 0.008196841925382614, 0.03559621796011925, 0.030688943341374397, 0.006063733249902725, -0.009056570008397102, 0.011896943673491478, 0.006002794019877911, -0.028651341795921326, 0.029948590323328972, -0.005105042830109596, -0.041034799069166183, -0.009642736054956913, -0.04087080433964729, -0.030866360291838646, 0.03304264694452286, -0.006581900641322136, 0.03131371736526489, 0.011574024334549904, 0.0020294361747801304, -0.03986697643995285, 0.06552740186452866, 0.0002521446440368891, -0.06849580258131027, 0.005251407623291016, 0.005539783742278814, -0.013817114755511284, 0.00877917930483818, 0.007843996398150921, -0.00521165831014514, 0.030877962708473206, 0.03003661334514618, -0.01015123724937439, -0.025567078962922096, -0.00979952048510313, -0.00982715655118227, -0.01679673045873642, -0.03347286581993103, 0.010995552875101566, 0.04239370673894882, 0.012884977273643017, -0.01967129297554493, -0.02690216153860092, -0.0537419393658638, 0.04612419754266739, -0.024626154452562332, 0.024760078638792038, 0.010672315023839474, -0.0009442606824450195, 0.02980009652674198, -0.03142961114645004, 0.005180883686989546, 0.015273631550371647, 0.007293933071196079, -0.013583612628281116, 0.030973216518759727, -0.037088122218847275, -0.02731720358133316, -0.029258398339152336, -0.015127088874578476, 0.024791836738586426, -0.031368620693683624, -0.03179318830370903, 0.011125358752906322, -0.026527008041739464, 0.035565946251153946, 0.007999823428690434, 0.016748348250985146, 0.0578162707388401, 0.02152731828391552, -0.024239664897322655, 0.02873917482793331, -0.016491128131747246, 0.003806576831266284, -0.0379222109913826, -0.019340209662914276, -0.028069239109754562, 0.020346377044916153, -0.04691646993160248, 0.040187425911426544, -0.030056890100240707, -0.00934668816626072, 0.034412872046232224, 0.019517192617058754, 0.00571842584758997, 0.007056301459670067, -0.031052365899086, -0.018865026533603668, 0.01035971287637949, 0.02340511791408062, 0.03356312960386276, 0.024721812456846237, 0.020413683727383614, 0.06188393384218216, 0.0024855586234480143, -0.034079745411872864, 0.013799524866044521, -0.0264658872038126, 0.022548187524080276, 0.004792942199856043, 0.0048643918707966805, -0.02826474793255329, 0.007719140965491533, -0.0002229060628451407, -0.014499436132609844, -0.058232128620147705, 0.006874094717204571, -0.020141853019595146, 0.011796528473496437, -0.03683674708008766, -0.020144635811448097, -0.06310122460126877, -0.0005744993686676025, -0.009568058885633945, 0.03347845748066902, -0.028822394087910652, 0.008713101968169212, -0.01366719976067543, 0.000556181010324508, 0.03903563320636749, 0.010797100141644478, 0.01823129877448082, -0.0009091593092307448, 0.032228969037532806, -0.004630065523087978, -0.005639039445668459, 0.020894596353173256, -0.00008655933197587729, -0.020166857168078423, 0.011366728693246841, -0.024981791153550148, -0.028785396367311478, -0.0005089910700917244, 0.025930508971214294, 0.024389345198869705, 0.028883565217256546, -0.03519399091601372, 0.046732936054468155, -0.0015605516964569688, -0.020675430074334145, 0.03479232266545296, -0.03526531532406807, -0.03545811399817467, 0.024641871452331543, -0.0017004553228616714, 0.019755203276872635, 0.015506728552281857, 0.012084905058145523, -0.003097117878496647, -0.0360398069024086, -0.0027035255916416645, 0.030154524371027946, -0.040230561047792435, 0.008995968848466873, -0.04338430240750313, -0.0011625747429206967, 0.005406067240983248, 0.00898006372153759, 0.025237154215574265, -0.02205396443605423, 0.02120666205883026, -0.008092467673122883, 0.053548622876405716, -0.00878408458083868, -0.0008121957071125507, 0.008075183257460594, -0.013216770254075527, 0.003094600047916174, -0.005302043631672859, -0.014354857616126537, 0.009537110105156898, 0.05724840238690376, 0.0038471973966807127, 0.013702616095542908, -0.013545074500143528, 0.028473442420363426, 0.07334710657596588, 0.007879437878727913, -0.010901509784162045, -0.016215741634368896, -0.013836121186614037, -0.0039771017618477345, 0.05668671429157257, -0.01651117205619812, 0.02169436402618885, -0.003131014760583639, -0.0020890343002974987, 0.018677733838558197, 0.01342421118170023, -0.03208912909030914, 0.02090190351009369, 0.06153852492570877, -0.0017614222597330809, 0.007354092784225941, -0.020615138113498688, 0.028870582580566406, 0.03088679350912571, 0.00023880874505266547, -0.027481626719236374, -0.010605577379465103, -0.05585501715540886, -0.02246074564754963, -0.003517249133437872, 0.037035197019577026, -0.03140551969408989, -0.027843017131090164, 0.024822216480970383, -0.03815183788537979, -0.028419118374586105, -0.001893513253889978, 0.021165264770388603, -0.03769949823617935, 0.02438555657863617, -0.0329190157353878, -0.012152718380093575, -0.008549747057259083, -0.014017218723893166, 0.03758098557591438, 0.017697574570775032, 0.0314563512802124, -0.020938124507665634, -0.004193033557385206, 0.00010984546679537743, -0.05198754742741585, 0.03512177616357803, -0.004685565363615751, 0.013876876793801785, -0.0030888968612998724, 0.019371680915355682, -0.05528497323393822, 0.008958532474935055, 0.0006540937465615571, 0.00017407086852472275, -0.0056823864579200745, 0.02045457623898983, -0.01926295831799507, -0.007989882491528988, -0.012086545117199421, 0.01420773658901453, -0.011442702263593674, -0.05625816062092781, -0.03793339058756828, -0.008988410234451294, 0.002976102288812399, -0.011346818879246712, -0.023046011105179787, -0.010411012917757034, -0.00815978366881609, 0.003365460317581892, 0.02891707420349121, -0.015214743092656136, 0.0053184968419373035, 0.02783309295773506, -0.03096819296479225, 0.0023907998111099005, -0.026923296973109245, -0.022503618150949478, -0.043741073459386826, -0.02819158136844635, 0.018597133457660675, 0.002268814481794834, -0.0029174548108130693, -0.025284741073846817, -0.00319598987698555, -0.03348339721560478, 0.01935933157801628, 0.039952851831912994, 0.04389861971139908, 0.024804934859275818, 0.0007417522720061243, -0.02417057938873768, -0.007191809359937906, 0.01685091108083725, -0.03149881586432457, -0.000010680488230718765, 0.041556090116500854, -0.003227245295420289, -0.04296642541885376, 0.029496148228645325, -0.05517983064055443, -0.026096805930137634, 0.025703152641654015, -0.04826205223798752, 0.011460854671895504, 0.025536416098475456, 0.06379643827676773, 0.04230910912156105, -0.027765994891524315, -0.024022798985242844, -0.011495410464704037, 0.022165372967720032, -0.016285767778754234, 0.03393073007464409, -0.04509823024272919, 0.012565627694129944, -0.0021136151626706123, -0.020885808393359184, -0.024248279631137848, 0.009134472347795963, -0.018834421411156654, -0.0217552799731493, -0.05108245462179184, 0.006296403240412474, 0.017696307972073555, 0.04843733832240105, 0.012255779467523098, 0.04236619547009468, -0.0453970767557621, 0.021040739491581917, -0.026848934590816498, -0.04417773708701134, -0.02701510116457939, -0.02679886482656002, 0.00868728756904602, 0.012282646261155605, -0.0023587073665112257, 0.0077600120566785336, -0.008334517478942871, -0.014376750215888023, 0.00024675397435203195, -0.04333096742630005, 0.02545076794922352, 0.04097384959459305, -0.006867955904453993, -0.004614207427948713, 0.006639937870204449, -0.025192759931087494, 0.005046755541115999, 0.029727432876825333, -0.0036288874689489603, 0.028330594301223755, -0.05291871726512909, 0.016500743106007576, -0.024655256420373917, 0.027101678773760796, -0.036831893026828766, -0.029537169262766838, -0.007847853004932404, -0.01710391230881214, 0.004529262892901897, -0.017477143555879593, -0.011326992884278297, 0.03385044261813164, 0.0025562187656760216, -0.030649572610855103, 0.028829025104641914, -0.01702794060111046, 0.003773796372115612, 0.06318812817335129, 0.024801107123494148, 0.0005973030929453671, -0.006220902781933546, -0.020438410341739655, 0.03914552927017212, 0.02747317962348461, -0.009098367765545845, -0.030245523899793625, -0.011044243350625038, 0.0008789818966761231, 0.035039544105529785, 0.022321708500385284, 0.025502661243081093, 0.03415408357977867, 0.011689180508255959, 0.029431642964482307, -0.014848055317997932, -0.013332908041775227, -0.04088233783841133, 0.0016417226288467646, -0.0001908252015709877, -0.048127591609954834, 0.01309671439230442, 0.017438720911741257, -0.023462088778614998, 0.028764156624674797, 0.015662427991628647, 0.015431550331413746, -0.01649722456932068, 0.00826359260827303, -0.002190323080867529, -0.006923543754965067, -0.012776247225701809, -0.03024160861968994, 0.021992236375808716, -0.009583735838532448, 0.006758818868547678, 0.011797710321843624, 0.06525582820177078, -0.01793454773724079, -0.009243237785995007, 0.016094516962766647, -0.011445008218288422, -0.01743880845606327, -0.008408263325691223, 0.01403969619423151, -0.010894207283854485, 0.013176471926271915, -0.017324630171060562, -0.03186485171318054, -0.03562108427286148, 0.0384221114218235, 0.008773223496973515, -0.0024316865019500256, -0.007962893694639206, -0.012082628905773163, -0.008132019080221653, -0.045298200100660324, -0.037971559911966324, -0.011736966669559479, 0.025261100381612778, -0.02263030968606472, 0.001445906120352447, -0.016075950115919113, 0.0295853354036808, 0.016559265553951263, -0.009476060047745705, -0.024880675598978996, 0.005245420150458813, 0.024844862520694733, -0.007902298122644424, -0.014811310917139053, 0.018835658207535744, 0.013316920027136803, 0.02936268411576748, -0.013327701948583126, 0.013596398755908012, -0.010030603967607021, 0.02471514418721199, 0.010211591608822346, -0.006804019678384066, -0.015354492701590061, -0.004576915875077248, 0.03325419872999191, 0.006882003508508205, 0.013088996522128582, 0.01640736311674118, -0.018102262169122696, 0.0014430301962420344, 0.02442939206957817, -0.01429260615259409, 0.015081748366355896, -0.02540522813796997, -0.0119558647274971, -0.004332041367888451, -0.008295868523418903, -0.020444106310606003, -0.007604793645441532, 0.003364169504493475, 0.00020354773732833564, -0.002697459189221263, -0.005108331795781851, 0.008935454301536083, -0.02733936719596386, 0.0063319639302790165, 0.01937936432659626, -0.040439147502183914, 0.0017137906979769468, -0.011859148740768433, -0.0034289464820176363, 0.0036989920772612095, 0.007740485016256571, 0.015089968219399452, -0.007275377865880728, -0.009799518622457981, 0.016716966405510902, -0.0032311684917658567, -0.060726191848516464, 0.002828961471095681, 0.011269385926425457, 0.02417968399822712, -0.026233196258544922, -0.018231205642223358, -0.011497975327074528, -0.009086895734071732, 0.01099392119795084, 0.04455692321062088, 0.0019239230314269662, -0.02908186987042427, 0.02461799792945385, -0.0021742903627455235, -0.004481333773583174, 0.011874686926603317, 0.019026774913072586, 0.01927514187991619, -0.023444704711437225, 0.014641212299466133, 0.0012568593956530094, 0.0016372279496863484, -0.015481566078960896, 0.00914992019534111, 0.017788812518119812, -0.003122493391856551, -0.008762910030782223, -0.00434125354513526, 0.04606098309159279, -0.008591116406023502, 0.0005484759458340704, -0.001336159068159759, -0.017760811373591423, 0.025090107694268227, 0.001943016890436411, -0.010332999750971794, 0.042990852147340775, 0.012340242974460125, 0.010870733298361301, -0.012363673187792301, 0.024340881034731865, 0.002102173864841461, -0.012059740722179413, 0.01977889984846115, -0.01981772854924202, -0.01408790610730648, 0.012559263966977596, -0.002082603285089135, 0.007528300397098064, 0.026997674256563187, -0.01052336860448122, -0.014920263551175594, 0.005067087709903717, 0.003544847946614027, -0.018898144364356995, -0.0081374766305089, -0.036997027695178986, 0.0003397548571228981, -0.019712885841727257, -0.004398426041007042, -0.039350081235170364, 0.01599687524139881, 0.026161037385463715, -0.0076543721370399, -0.011813698336482048, 0.0046318829990923405, -0.015193561092019081, 0.0026564705185592175, 0.005674352403730154, -0.019270414486527443, 0.01656905561685562, 0.015603264793753624, -0.014052958227694035, 0.006996374111622572, -0.02792644128203392, -0.035882655531167984, -0.011499639600515366, -0.0038525101263076067, -0.004764233715832233, 0.02546367421746254, 0.04385506361722946, 0.015397674404084682, -0.0013809357769787312, -0.0009901036974042654, 0.0001122518369811587, -0.003334264736622572, 0.03538162261247635, -0.0015743070980533957, -0.002375634852796793, -0.016721803694963455, 0.020702945068478584, -0.01892886310815811, -0.005655535496771336, -0.010076671838760376, -0.012540903873741627, -0.008144616149365902, 0.01843920163810253, 0.0018893360393121839, -0.002516418229788542, -0.008176185190677643, 0.001942258095368743, 0.024492410942912102, 0.020326241850852966, 0.028259750455617905, 0.0042038061656057835, -0.020344149321317673, 0.015674380585551262, 0.014548246748745441, 0.027964357286691666, 0.00888014119118452, -0.012406482361257076, -0.05167323723435402, -0.03078628145158291, -0.005042042583227158, 0.02372106723487377, -0.00736968033015728, 0.010218181647360325, -0.013124516233801842, -0.008044169284403324, 0.010520095005631447, 0.005561995320022106, 0.021618319675326347, 0.02862992323935032, 0.009091737680137157, 0.021043425425887108, 0.01773924194276333, 0.04213305190205574, -0.006726520601660013, 0.04071580618619919, -0.03269629925489426, 0.018825065344572067, 0.046047136187553406, -0.02938213385641575, 0.015778064727783203, -0.006057696882635355, 0.006428316235542297, -0.01420268602669239, 0.030464045703411102, -0.002448837971314788, 0.012781074270606041, -0.016828753054142, -0.023663189262151718, 0.018488630652427673, -0.045323457568883896, 0.0037064175121486187, 0.002913739299401641, -0.008330711163580418, 0.024225609377026558, -0.017567850649356842, 0.0018023320008069277, -0.006980669219046831, -0.019382553175091743, -0.001860154210589826, 0.016808219254016876, 0.0061479429714381695, 0.01058582216501236, -0.042127709835767746, -0.02071322686970234, 0.025002174079418182, -0.030113685876131058, -0.02306627295911312, -0.03290226683020592, -0.009672964923083782, 0.03738393262028694, 0.040425095707178116, -0.03907371312379837, -0.03412050008773804, 0.008126838132739067, 0.024371294304728508, -0.04400717467069626, 0.0003857500269077718, 0.016115102916955948, -0.029309015721082687, 0.01950220949947834, -0.006159611511975527, -0.004895802121609449, -0.016210295259952545, -0.013117247261106968, -0.006657449062913656, 0.004355574958026409, 0.023292301222682, -0.0007659733528271317, 0.0014287902740761638, -0.0056495340541005135, -0.02707950957119465, -0.03222488984465599, 0.004794982261955738, -0.0022141151130199432, -0.04787970334291458, -0.0010852159466594458, 0.03196459636092186, 0.055236149579286575, 0.007545572705566883, -0.0150687787681818, -0.000030332319511217065, -0.0076913367956876755, -0.03137559816241264]. (VIOLATED_CONSTRAINT) (version 23.3.2.1) (from 192.168.65.1:39072) (in query: INSERT INTO default.docs (`page_content`, `embeddings`) FORMAT Native ), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<String, String, unsigned long, String, String&>(int, FormatStringHelperImpl<std::type_identity<String>::type, std::type_identity<String>::type, std::type_identity<unsigned long>::type, std::type_identity<String>::type, std::type_identity<String&>::type>, String&&, String&&, unsigned long&&, String&&, String&) @ 0x18e873cc in /usr/bin/clickhouse
3. ./build/./src/Processors/Transforms/CheckConstraintsTransform.cpp:0: DB::CheckConstraintsTransform::onConsume(DB::Chunk) @ 0x18e86c80 in /usr/bin/clickhouse
4. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<DB::ExceptionKeepingTransform::work()::$_2, void ()>>(std::__function::__policy_storage const*) @ 0x18e9a12b in /usr/bin/clickhouse
5. ./build/./src/Processors/Transforms/ExceptionKeepingTransform.cpp:103: DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x18e99fc2 in /usr/bin/clickhouse
6. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:818: DB::ExceptionKeepingTransform::work() @ 0x18e9929a in /usr/bin/clickhouse
7. ./build/./src/Processors/Executors/ExecutionThreadContext.cpp:0: DB::ExecutionThreadContext::executeTask() @ 0x18ce950c in /usr/bin/clickhouse
8. ./build/./src/Processors/Executors/PipelineExecutor.cpp:248: DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x18cdfd7b in /usr/bin/clickhouse
9. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::PipelineExecutor::executeImpl(unsigned long) @ 0x18cdf6b9 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:274: DB::PipelineExecutor::execute(unsigned long) @ 0x18cdf497 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/atomic:958: DB::CompletedPipelineExecutor::execute() @ 0x18cde2df in /usr/bin/clickhouse
12. ./build/./src/Interpreters/executeQuery.cpp:0: DB::executeQuery(DB::ReadBuffer&, DB::WriteBuffer&, bool, std::shared_ptr<DB::Context>, std::function<void (DB::QueryResultDetails const&)>, std::optional<DB::FormatSettings> const&) @ 0x17f6a6e3 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/optional:260: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c4a8e0 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
15. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
16. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
18. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
19. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
20. ? @ 0x7f3895a94ac3 in ?
21. ? @ 0x7f3895b26850 in ?

2024.10.09 23:15:48.998440 [ 39 ] {7275f69c-b56e-4ca9-906c-c8daec6550f4} <Error> DynamicQueryHandler: Code: 469. DB::Exception: Constraint `check_data_length` for table default.docs (6886a049-4115-4e25-a298-8a6827c7eb19) is violated at row 1. Expression: (length(embeddings) = 768). Column values: embeddings = [0.04112676903605461, -0.008400964550673962, 0.09749477356672287, -0.053131524473428726, -0.001413525315001607, 0.03715737536549568, 0.008255580440163612, -0.025049051269888878, -0.0015678626950830221, -0.028389258310198784, 0.010690483264625072, -0.006459140218794346, 0.20259089767932892, 0.032178185880184174, 0.046765342354774475, 0.01466406974941492, -0.04373771324753761, 0.023064764216542244, 0.027008596807718277, 0.05068179965019226, -0.11421819031238556, -0.05220935121178627, 0.10694943368434906, 0.09731987863779068, -0.036210861057043076, -0.017703868448734283, -0.021764438599348068, -0.031486380845308304, 0.06449003517627716, -0.06462034583091736, 0.11916103214025497, 0.03971036896109581, -0.01853313483297825, 0.058251846581697464, 0.008044475689530373, 0.01547224447131157, -0.044564105570316315, 0.06325632333755493, 0.005558537319302559, -0.03139401599764824, -0.08913689851760864, -0.04606947302818298, -0.014500710181891918, -0.051759328693151474, 0.006230400409549475, -0.060991041362285614, 0.052895113825798035, 0.016175515949726105, -0.0173935666680336, 0.055896636098623276, -0.004420056007802486, -0.009099304676055908, 0.04762881621718407, -0.02145329862833023, -0.04269666597247124, 0.02086651511490345, 0.018043765798211098, 0.029654046520590782, 0.05177649110555649, 0.07189029455184937, -0.07093359529972076, 0.0010210160398855805, 0.03791459649801254, -0.034294936805963516, 0.0004765923658851534, 0.018332112580537796, 0.0665619820356369, -0.002618261380121112, 0.11268480122089386, -0.04894984886050224, 0.018420640379190445, -0.01757984422147274, -0.010174473747611046, 0.04525480791926384, -0.021397139877080917, 0.11532675474882126, -0.055264171212911606, -0.015345095656812191, -0.12123377621173859, -0.011908014304935932, -0.15089012682437897, 0.040806662291288376, -0.011781638488173485, -0.005612982902675867, 0.006401349790394306, -0.01635991781949997, -0.009834450669586658, 0.010021897032856941, -0.03097623586654663, -0.04822486639022827, 0.016370205208659172, -0.029412854462862015, -0.01282628532499075, -0.04488382861018181, 0.013726006262004375, -0.021837204694747925, 0.04366128891706467, -0.029287194833159447, -0.010640166699886322, -0.10984556376934052, 0.017254607751965523, -0.0004918534541502595, -0.04328940436244011, 0.03474825620651245, 0.041193265467882156, 0.05670227110385895, 0.04823417216539383, -0.019503487274050713, 0.05669773742556572, -0.010472320020198822, -0.009554700925946236, -0.03481427952647209, -0.06290591508150101, 0.020141661167144775, -0.06863225996494293, -0.04927641525864601, 0.013040315359830856, 0.010648333467543125, 0.034409452229738235, 0.07569956034421921, 0.014744537882506847, 0.04826740175485611, -0.005035950802266598, -0.012604649178683758, 0.02325516566634178, -0.054228488355875015, -0.07620903104543686, 0.0764530748128891, -0.0679018422961235, -0.011016343720257282, 0.007538978476077318, -0.03399340808391571, 0.028552360832691193, -0.036915022879838943, -0.0928267166018486, -0.04258729889988899, 0.04170601814985275, 0.0557204894721508, 0.0054741413332521915, -0.0508527010679245, 0.018909351900219917, -0.09906692057847977, -0.029620744287967682, 0.017833711579442024, -0.019879205152392387, 0.0006834550877101719, 0.047341156750917435, -0.04990822449326515, -0.01716255210340023, 0.039507120847702026, 0.002763956319540739, 0.04233676195144653, -0.09128551185131073, 0.021852998062968254, -0.045491334050893784, -0.003876769682392478, -0.04667738080024719, -0.018148822709918022, 0.02576877921819687, 0.012938815169036388, -0.01759943924844265, 0.05042668431997299, 0.0072966814041137695, 0.07770740985870361, -0.045169148594141006, -0.07323839515447617, 0.008351152762770653, 0.007953478023409843, -0.004714835435152054, -0.032919175922870636, -0.06336789578199387, -0.010174283757805824, 0.008563329465687275, 0.02098591811954975, -0.033558834344148636, -0.037677280604839325, 0.02241131290793419, -0.049901265650987625, 0.009958988055586815, -0.03820584714412689, 0.04470084607601166, 0.01590130664408207, -0.016525981947779655, -0.003101245267316699, 0.04618902504444122, 0.005928968079388142, 0.04641854390501976, 0.013662979006767273, -0.02730601839721203, -0.02260732650756836, 0.019516505300998688, 0.014044861309230328, 0.009985015727579594, 0.0036300497595220804, 0.007266989443451166, 0.06509029120206833, -0.010095532052218914, 0.018118733540177345, -0.030959732830524445, -0.02009149268269539, 0.03921203687787056, 0.017353219911456108, -0.01061128918081522, -0.04410579428076744, 0.01570095494389534, -0.007173595950007439, 0.004249447025358677, 0.0384400375187397, 0.03772586211562157, 0.05227470025420189, -0.015308933332562447, 0.038963090628385544, -0.01851087063550949, -0.04436035454273224, -0.037230417132377625, 0.04432890564203262, -0.042224857956171036, 0.038043003529310226, -0.011614635586738586, -0.009917216375470161, -0.005439909175038338, 0.005710291676223278, -0.01292689610272646, -0.017040517181158066, -0.02342803217470646, -0.007542700972408056, -0.01887032575905323, -0.00408390024676919, -0.01913602463901043, 0.0015421768184751272, 0.03318754583597183, 0.04709598049521446, 0.05091400444507599, 0.024551717564463615, 0.05177771672606468, -0.03418348729610443, -0.041375115513801575, 0.05476862192153931, -0.017739688977599144, 0.02319563925266266, 0.04009556025266647, -0.05034223198890686, -0.012569224461913109, -0.040207114070653915, 0.047189194709062576, 0.06881839036941528, 0.036453623324632645, 0.007383022923022509, -0.07399331778287888, 0.04669874534010887, 0.04590693861246109, -0.03657842054963112, -0.029057389125227928, -0.023157374933362007, 0.006855986081063747, -0.013003568165004253, 0.03766760230064392, 0.023585092276334763, -0.014273903332650661, 0.024112064391374588, 0.020958127453923225, 0.030608143657445908, 0.00935056246817112, 0.003458634717389941, 0.07281047105789185, 0.036470428109169006, -0.055507928133010864, 0.030497970059514046, 0.07009201496839523, 0.029175128787755966, -0.04006607085466385, 0.02121541276574135, -0.07111053168773651, 0.005707551725208759, 0.03345181420445442, 0.058384835720062256, 0.00447284197434783, -0.024309294298291206, 0.01540397573262453, -0.00007842402555979788, -0.005186615511775017, -0.009474387392401695, -0.017360340803861618, 0.0375961996614933, -0.024325352162122726, 0.10852240025997162, 0.04295344650745392, 0.018111594021320343, 0.014796697534620762, -0.04984721541404724, -0.014833662658929825, -0.007269750349223614, 0.028995905071496964, -0.01402225811034441, -0.00007969354192027822, -0.008047026582062244, 0.02774444781243801, 0.0040969871915876865, -0.008088630624115467, -0.017454709857702255, 0.031756941229104996, -0.037631139159202576, -0.009362776763737202, -0.03553250804543495, -0.02473743073642254, -0.005112426821142435, 0.010493204928934574, -0.01688285544514656, -0.013335518538951874, 0.0016652642516419291, 0.008578014560043812, 0.047118835151195526, -0.03651205822825432, 0.020822320133447647, 0.05174384266138077, 0.05402554199099541, 0.005726643837988377, 0.024147391319274902, -0.012216254137456417, -0.03834644332528114, -0.021724883466959, 0.022474365308880806, -0.0072288778610527515, -0.013360566459596157, 0.03644173592329025, 0.03198769688606262, -0.028750363737344742, -0.0372941717505455, -0.002340676262974739, 0.015134798362851143, 0.018716948106884956, 0.07642769813537598, -0.014287699945271015, 0.0071293264627456665, 0.00017217350250575691, -0.028243685141205788, -0.03771013393998146, 0.025617297738790512, -0.029350411146879196, 0.0410865917801857, 0.009700339287519455, -0.0030304566025733948, -0.006925365421921015, 0.025001641362905502, 0.012117253616452217, 0.019071267917752266, -0.053252384066581726, 0.03433280438184738, -0.07949414104223251, 0.01415552943944931, -0.034957777708768845, -0.044917937368154526, -0.022444983944296837, 0.01898389495909214, -0.009450245648622513, 0.05393995717167854, -0.007413389626890421, -0.042290300130844116, -0.0021597088780254126, 0.006635033525526524, 0.005249409936368465, -0.018422018736600876, 0.008196841925382614, 0.03559621796011925, 0.030688943341374397, 0.006063733249902725, -0.009056570008397102, 0.011896943673491478, 0.006002794019877911, -0.028651341795921326, 0.029948590323328972, -0.005105042830109596, -0.041034799069166183, -0.009642736054956913, -0.04087080433964729, -0.030866360291838646, 0.03304264694452286, -0.006581900641322136, 0.03131371736526489, 0.011574024334549904, 0.0020294361747801304, -0.03986697643995285, 0.06552740186452866, 0.0002521446440368891, -0.06849580258131027, 0.005251407623291016, 0.005539783742278814, -0.013817114755511284, 0.00877917930483818, 0.007843996398150921, -0.00521165831014514, 0.030877962708473206, 0.03003661334514618, -0.01015123724937439, -0.025567078962922096, -0.00979952048510313, -0.00982715655118227, -0.01679673045873642, -0.03347286581993103, 0.010995552875101566, 0.04239370673894882, 0.012884977273643017, -0.01967129297554493, -0.02690216153860092, -0.0537419393658638, 0.04612419754266739, -0.024626154452562332, 0.024760078638792038, 0.010672315023839474, -0.0009442606824450195, 0.02980009652674198, -0.03142961114645004, 0.005180883686989546, 0.015273631550371647, 0.007293933071196079, -0.013583612628281116, 0.030973216518759727, -0.037088122218847275, -0.02731720358133316, -0.029258398339152336, -0.015127088874578476, 0.024791836738586426, -0.031368620693683624, -0.03179318830370903, 0.011125358752906322, -0.026527008041739464, 0.035565946251153946, 0.007999823428690434, 0.016748348250985146, 0.0578162707388401, 0.02152731828391552, -0.024239664897322655, 0.02873917482793331, -0.016491128131747246, 0.003806576831266284, -0.0379222109913826, -0.019340209662914276, -0.028069239109754562, 0.020346377044916153, -0.04691646993160248, 0.040187425911426544, -0.030056890100240707, -0.00934668816626072, 0.034412872046232224, 0.019517192617058754, 0.00571842584758997, 0.007056301459670067, -0.031052365899086, -0.018865026533603668, 0.01035971287637949, 0.02340511791408062, 0.03356312960386276, 0.024721812456846237, 0.020413683727383614, 0.06188393384218216, 0.0024855586234480143, -0.034079745411872864, 0.013799524866044521, -0.0264658872038126, 0.022548187524080276, 0.004792942199856043, 0.0048643918707966805, -0.02826474793255329, 0.007719140965491533, -0.0002229060628451407, -0.014499436132609844, -0.058232128620147705, 0.006874094717204571, -0.020141853019595146, 0.011796528473496437, -0.03683674708008766, -0.020144635811448097, -0.06310122460126877, -0.0005744993686676025, -0.009568058885633945, 0.03347845748066902, -0.028822394087910652, 0.008713101968169212, -0.01366719976067543, 0.000556181010324508, 0.03903563320636749, 0.010797100141644478, 0.01823129877448082, -0.0009091593092307448, 0.032228969037532806, -0.004630065523087978, -0.005639039445668459, 0.020894596353173256, -0.00008655933197587729, -0.020166857168078423, 0.011366728693246841, -0.024981791153550148, -0.028785396367311478, -0.0005089910700917244, 0.025930508971214294, 0.024389345198869705, 0.028883565217256546, -0.03519399091601372, 0.046732936054468155, -0.0015605516964569688, -0.020675430074334145, 0.03479232266545296, -0.03526531532406807, -0.03545811399817467, 0.024641871452331543, -0.0017004553228616714, 0.019755203276872635, 0.015506728552281857, 0.012084905058145523, -0.003097117878496647, -0.0360398069024086, -0.0027035255916416645, 0.030154524371027946, -0.040230561047792435, 0.008995968848466873, -0.04338430240750313, -0.0011625747429206967, 0.005406067240983248, 0.00898006372153759, 0.025237154215574265, -0.02205396443605423, 0.02120666205883026, -0.008092467673122883, 0.053548622876405716, -0.00878408458083868, -0.0008121957071125507, 0.008075183257460594, -0.013216770254075527, 0.003094600047916174, -0.005302043631672859, -0.014354857616126537, 0.009537110105156898, 0.05724840238690376, 0.0038471973966807127, 0.013702616095542908, -0.013545074500143528, 0.028473442420363426, 0.07334710657596588, 0.007879437878727913, -0.010901509784162045, -0.016215741634368896, -0.013836121186614037, -0.0039771017618477345, 0.05668671429157257, -0.01651117205619812, 0.02169436402618885, -0.003131014760583639, -0.0020890343002974987, 0.018677733838558197, 0.01342421118170023, -0.03208912909030914, 0.02090190351009369, 0.06153852492570877, -0.0017614222597330809, 0.007354092784225941, -0.020615138113498688, 0.028870582580566406, 0.03088679350912571, 0.00023880874505266547, -0.027481626719236374, -0.010605577379465103, -0.05585501715540886, -0.02246074564754963, -0.003517249133437872, 0.037035197019577026, -0.03140551969408989, -0.027843017131090164, 0.024822216480970383, -0.03815183788537979, -0.028419118374586105, -0.001893513253889978, 0.021165264770388603, -0.03769949823617935, 0.02438555657863617, -0.0329190157353878, -0.012152718380093575, -0.008549747057259083, -0.014017218723893166, 0.03758098557591438, 0.017697574570775032, 0.0314563512802124, -0.020938124507665634, -0.004193033557385206, 0.00010984546679537743, -0.05198754742741585, 0.03512177616357803, -0.004685565363615751, 0.013876876793801785, -0.0030888968612998724, 0.019371680915355682, -0.05528497323393822, 0.008958532474935055, 0.0006540937465615571, 0.00017407086852472275, -0.0056823864579200745, 0.02045457623898983, -0.01926295831799507, -0.007989882491528988, -0.012086545117199421, 0.01420773658901453, -0.011442702263593674, -0.05625816062092781, -0.03793339058756828, -0.008988410234451294, 0.002976102288812399, -0.011346818879246712, -0.023046011105179787, -0.010411012917757034, -0.00815978366881609, 0.003365460317581892, 0.02891707420349121, -0.015214743092656136, 0.0053184968419373035, 0.02783309295773506, -0.03096819296479225, 0.0023907998111099005, -0.026923296973109245, -0.022503618150949478, -0.043741073459386826, -0.02819158136844635, 0.018597133457660675, 0.002268814481794834, -0.0029174548108130693, -0.025284741073846817, -0.00319598987698555, -0.03348339721560478, 0.01935933157801628, 0.039952851831912994, 0.04389861971139908, 0.024804934859275818, 0.0007417522720061243, -0.02417057938873768, -0.007191809359937906, 0.01685091108083725, -0.03149881586432457, -0.000010680488230718765, 0.041556090116500854, -0.003227245295420289, -0.04296642541885376, 0.029496148228645325, -0.05517983064055443, -0.026096805930137634, 0.025703152641654015, -0.04826205223798752, 0.011460854671895504, 0.025536416098475456, 0.06379643827676773, 0.04230910912156105, -0.027765994891524315, -0.024022798985242844, -0.011495410464704037, 0.022165372967720032, -0.016285767778754234, 0.03393073007464409, -0.04509823024272919, 0.012565627694129944, -0.0021136151626706123, -0.020885808393359184, -0.024248279631137848, 0.009134472347795963, -0.018834421411156654, -0.0217552799731493, -0.05108245462179184, 0.006296403240412474, 0.017696307972073555, 0.04843733832240105, 0.012255779467523098, 0.04236619547009468, -0.0453970767557621, 0.021040739491581917, -0.026848934590816498, -0.04417773708701134, -0.02701510116457939, -0.02679886482656002, 0.00868728756904602, 0.012282646261155605, -0.0023587073665112257, 0.0077600120566785336, -0.008334517478942871, -0.014376750215888023, 0.00024675397435203195, -0.04333096742630005, 0.02545076794922352, 0.04097384959459305, -0.006867955904453993, -0.004614207427948713, 0.006639937870204449, -0.025192759931087494, 0.005046755541115999, 0.029727432876825333, -0.0036288874689489603, 0.028330594301223755, -0.05291871726512909, 0.016500743106007576, -0.024655256420373917, 0.027101678773760796, -0.036831893026828766, -0.029537169262766838, -0.007847853004932404, -0.01710391230881214, 0.004529262892901897, -0.017477143555879593, -0.011326992884278297, 0.03385044261813164, 0.0025562187656760216, -0.030649572610855103, 0.028829025104641914, -0.01702794060111046, 0.003773796372115612, 0.06318812817335129, 0.024801107123494148, 0.0005973030929453671, -0.006220902781933546, -0.020438410341739655, 0.03914552927017212, 0.02747317962348461, -0.009098367765545845, -0.030245523899793625, -0.011044243350625038, 0.0008789818966761231, 0.035039544105529785, 0.022321708500385284, 0.025502661243081093, 0.03415408357977867, 0.011689180508255959, 0.029431642964482307, -0.014848055317997932, -0.013332908041775227, -0.04088233783841133, 0.0016417226288467646, -0.0001908252015709877, -0.048127591609954834, 0.01309671439230442, 0.017438720911741257, -0.023462088778614998, 0.028764156624674797, 0.015662427991628647, 0.015431550331413746, -0.01649722456932068, 0.00826359260827303, -0.002190323080867529, -0.006923543754965067, -0.012776247225701809, -0.03024160861968994, 0.021992236375808716, -0.009583735838532448, 0.006758818868547678, 0.011797710321843624, 0.06525582820177078, -0.01793454773724079, -0.009243237785995007, 0.016094516962766647, -0.011445008218288422, -0.01743880845606327, -0.008408263325691223, 0.01403969619423151, -0.010894207283854485, 0.013176471926271915, -0.017324630171060562, -0.03186485171318054, -0.03562108427286148, 0.0384221114218235, 0.008773223496973515, -0.0024316865019500256, -0.007962893694639206, -0.012082628905773163, -0.008132019080221653, -0.045298200100660324, -0.037971559911966324, -0.011736966669559479, 0.025261100381612778, -0.02263030968606472, 0.001445906120352447, -0.016075950115919113, 0.0295853354036808, 0.016559265553951263, -0.009476060047745705, -0.024880675598978996, 0.005245420150458813, 0.024844862520694733, -0.007902298122644424, -0.014811310917139053, 0.018835658207535744, 0.013316920027136803, 0.02936268411576748, -0.013327701948583126, 0.013596398755908012, -0.010030603967607021, 0.02471514418721199, 0.010211591608822346, -0.006804019678384066, -0.015354492701590061, -0.004576915875077248, 0.03325419872999191, 0.006882003508508205, 0.013088996522128582, 0.01640736311674118, -0.018102262169122696, 0.0014430301962420344, 0.02442939206957817, -0.01429260615259409, 0.015081748366355896, -0.02540522813796997, -0.0119558647274971, -0.004332041367888451, -0.008295868523418903, -0.020444106310606003, -0.007604793645441532, 0.003364169504493475, 0.00020354773732833564, -0.002697459189221263, -0.005108331795781851, 0.008935454301536083, -0.02733936719596386, 0.0063319639302790165, 0.01937936432659626, -0.040439147502183914, 0.0017137906979769468, -0.011859148740768433, -0.0034289464820176363, 0.0036989920772612095, 0.007740485016256571, 0.015089968219399452, -0.007275377865880728, -0.009799518622457981, 0.016716966405510902, -0.0032311684917658567, -0.060726191848516464, 0.002828961471095681, 0.011269385926425457, 0.02417968399822712, -0.026233196258544922, -0.018231205642223358, -0.011497975327074528, -0.009086895734071732, 0.01099392119795084, 0.04455692321062088, 0.0019239230314269662, -0.02908186987042427, 0.02461799792945385, -0.0021742903627455235, -0.004481333773583174, 0.011874686926603317, 0.019026774913072586, 0.01927514187991619, -0.023444704711437225, 0.014641212299466133, 0.0012568593956530094, 0.0016372279496863484, -0.015481566078960896, 0.00914992019534111, 0.017788812518119812, -0.003122493391856551, -0.008762910030782223, -0.00434125354513526, 0.04606098309159279, -0.008591116406023502, 0.0005484759458340704, -0.001336159068159759, -0.017760811373591423, 0.025090107694268227, 0.001943016890436411, -0.010332999750971794, 0.042990852147340775, 0.012340242974460125, 0.010870733298361301, -0.012363673187792301, 0.024340881034731865, 0.002102173864841461, -0.012059740722179413, 0.01977889984846115, -0.01981772854924202, -0.01408790610730648, 0.012559263966977596, -0.002082603285089135, 0.007528300397098064, 0.026997674256563187, -0.01052336860448122, -0.014920263551175594, 0.005067087709903717, 0.003544847946614027, -0.018898144364356995, -0.0081374766305089, -0.036997027695178986, 0.0003397548571228981, -0.019712885841727257, -0.004398426041007042, -0.039350081235170364, 0.01599687524139881, 0.026161037385463715, -0.0076543721370399, -0.011813698336482048, 0.0046318829990923405, -0.015193561092019081, 0.0026564705185592175, 0.005674352403730154, -0.019270414486527443, 0.01656905561685562, 0.015603264793753624, -0.014052958227694035, 0.006996374111622572, -0.02792644128203392, -0.035882655531167984, -0.011499639600515366, -0.0038525101263076067, -0.004764233715832233, 0.02546367421746254, 0.04385506361722946, 0.015397674404084682, -0.0013809357769787312, -0.0009901036974042654, 0.0001122518369811587, -0.003334264736622572, 0.03538162261247635, -0.0015743070980533957, -0.002375634852796793, -0.016721803694963455, 0.020702945068478584, -0.01892886310815811, -0.005655535496771336, -0.010076671838760376, -0.012540903873741627, -0.008144616149365902, 0.01843920163810253, 0.0018893360393121839, -0.002516418229788542, -0.008176185190677643, 0.001942258095368743, 0.024492410942912102, 0.020326241850852966, 0.028259750455617905, 0.0042038061656057835, -0.020344149321317673, 0.015674380585551262, 0.014548246748745441, 0.027964357286691666, 0.00888014119118452, -0.012406482361257076, -0.05167323723435402, -0.03078628145158291, -0.005042042583227158, 0.02372106723487377, -0.00736968033015728, 0.010218181647360325, -0.013124516233801842, -0.008044169284403324, 0.010520095005631447, 0.005561995320022106, 0.021618319675326347, 0.02862992323935032, 0.009091737680137157, 0.021043425425887108, 0.01773924194276333, 0.04213305190205574, -0.006726520601660013, 0.04071580618619919, -0.03269629925489426, 0.018825065344572067, 0.046047136187553406, -0.02938213385641575, 0.015778064727783203, -0.006057696882635355, 0.006428316235542297, -0.01420268602669239, 0.030464045703411102, -0.002448837971314788, 0.012781074270606041, -0.016828753054142, -0.023663189262151718, 0.018488630652427673, -0.045323457568883896, 0.0037064175121486187, 0.002913739299401641, -0.008330711163580418, 0.024225609377026558, -0.017567850649356842, 0.0018023320008069277, -0.006980669219046831, -0.019382553175091743, -0.001860154210589826, 0.016808219254016876, 0.0061479429714381695, 0.01058582216501236, -0.042127709835767746, -0.02071322686970234, 0.025002174079418182, -0.030113685876131058, -0.02306627295911312, -0.03290226683020592, -0.009672964923083782, 0.03738393262028694, 0.040425095707178116, -0.03907371312379837, -0.03412050008773804, 0.008126838132739067, 0.024371294304728508, -0.04400717467069626, 0.0003857500269077718, 0.016115102916955948, -0.029309015721082687, 0.01950220949947834, -0.006159611511975527, -0.004895802121609449, -0.016210295259952545, -0.013117247261106968, -0.006657449062913656, 0.004355574958026409, 0.023292301222682, -0.0007659733528271317, 0.0014287902740761638, -0.0056495340541005135, -0.02707950957119465, -0.03222488984465599, 0.004794982261955738, -0.0022141151130199432, -0.04787970334291458, -0.0010852159466594458, 0.03196459636092186, 0.055236149579286575, 0.007545572705566883, -0.0150687787681818, -0.000030332319511217065, -0.0076913367956876755, -0.03137559816241264]. (VIOLATED_CONSTRAINT), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<String, String, unsigned long, String, String&>(int, FormatStringHelperImpl<std::type_identity<String>::type, std::type_identity<String>::type, std::type_identity<unsigned long>::type, std::type_identity<String>::type, std::type_identity<String&>::type>, String&&, String&&, unsigned long&&, String&&, String&) @ 0x18e873cc in /usr/bin/clickhouse
3. ./build/./src/Processors/Transforms/CheckConstraintsTransform.cpp:0: DB::CheckConstraintsTransform::onConsume(DB::Chunk) @ 0x18e86c80 in /usr/bin/clickhouse
4. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<DB::ExceptionKeepingTransform::work()::$_2, void ()>>(std::__function::__policy_storage const*) @ 0x18e9a12b in /usr/bin/clickhouse
5. ./build/./src/Processors/Transforms/ExceptionKeepingTransform.cpp:103: DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x18e99fc2 in /usr/bin/clickhouse
6. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:818: DB::ExceptionKeepingTransform::work() @ 0x18e9929a in /usr/bin/clickhouse
7. ./build/./src/Processors/Executors/ExecutionThreadContext.cpp:0: DB::ExecutionThreadContext::executeTask() @ 0x18ce950c in /usr/bin/clickhouse
8. ./build/./src/Processors/Executors/PipelineExecutor.cpp:248: DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x18cdfd7b in /usr/bin/clickhouse
9. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::PipelineExecutor::executeImpl(unsigned long) @ 0x18cdf6b9 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:274: DB::PipelineExecutor::execute(unsigned long) @ 0x18cdf497 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/atomic:958: DB::CompletedPipelineExecutor::execute() @ 0x18cde2df in /usr/bin/clickhouse
12. ./build/./src/Interpreters/executeQuery.cpp:0: DB::executeQuery(DB::ReadBuffer&, DB::WriteBuffer&, bool, std::shared_ptr<DB::Context>, std::function<void (DB::QueryResultDetails const&)>, std::optional<DB::FormatSettings> const&) @ 0x17f6a6e3 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/optional:260: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c4a8e0 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
15. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
16. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
18. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
19. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
20. ? @ 0x7f3895a94ac3 in ?
21. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.09 23:17:30.225109 [ 39 ] {adf9244e-bc72-4e5f-bae0-2e81a5fc40e8} <Error> executeQuery: Code: 469. DB::Exception: Constraint `check_data_length` for table default.docs (33d266a7-7d7f-4175-907f-80540f4ae542) is violated at row 1. Expression: (length(embeddings) = 768). Column values: embeddings = [0.04112676903605461, -0.008400964550673962, 0.09749477356672287, -0.053131524473428726, -0.001413525315001607, 0.03715737536549568, 0.008255580440163612, -0.025049051269888878, -0.0015678626950830221, -0.028389258310198784, 0.010690483264625072, -0.006459140218794346, 0.20259089767932892, 0.032178185880184174, 0.046765342354774475, 0.01466406974941492, -0.04373771324753761, 0.023064764216542244, 0.027008596807718277, 0.05068179965019226, -0.11421819031238556, -0.05220935121178627, 0.10694943368434906, 0.09731987863779068, -0.036210861057043076, -0.017703868448734283, -0.021764438599348068, -0.031486380845308304, 0.06449003517627716, -0.06462034583091736, 0.11916103214025497, 0.03971036896109581, -0.01853313483297825, 0.058251846581697464, 0.008044475689530373, 0.01547224447131157, -0.044564105570316315, 0.06325632333755493, 0.005558537319302559, -0.03139401599764824, -0.08913689851760864, -0.04606947302818298, -0.014500710181891918, -0.051759328693151474, 0.006230400409549475, -0.060991041362285614, 0.052895113825798035, 0.016175515949726105, -0.0173935666680336, 0.055896636098623276, -0.004420056007802486, -0.009099304676055908, 0.04762881621718407, -0.02145329862833023, -0.04269666597247124, 0.02086651511490345, 0.018043765798211098, 0.029654046520590782, 0.05177649110555649, 0.07189029455184937, -0.07093359529972076, 0.0010210160398855805, 0.03791459649801254, -0.034294936805963516, 0.0004765923658851534, 0.018332112580537796, 0.0665619820356369, -0.002618261380121112, 0.11268480122089386, -0.04894984886050224, 0.018420640379190445, -0.01757984422147274, -0.010174473747611046, 0.04525480791926384, -0.021397139877080917, 0.11532675474882126, -0.055264171212911606, -0.015345095656812191, -0.12123377621173859, -0.011908014304935932, -0.15089012682437897, 0.040806662291288376, -0.011781638488173485, -0.005612982902675867, 0.006401349790394306, -0.01635991781949997, -0.009834450669586658, 0.010021897032856941, -0.03097623586654663, -0.04822486639022827, 0.016370205208659172, -0.029412854462862015, -0.01282628532499075, -0.04488382861018181, 0.013726006262004375, -0.021837204694747925, 0.04366128891706467, -0.029287194833159447, -0.010640166699886322, -0.10984556376934052, 0.017254607751965523, -0.0004918534541502595, -0.04328940436244011, 0.03474825620651245, 0.041193265467882156, 0.05670227110385895, 0.04823417216539383, -0.019503487274050713, 0.05669773742556572, -0.010472320020198822, -0.009554700925946236, -0.03481427952647209, -0.06290591508150101, 0.020141661167144775, -0.06863225996494293, -0.04927641525864601, 0.013040315359830856, 0.010648333467543125, 0.034409452229738235, 0.07569956034421921, 0.014744537882506847, 0.04826740175485611, -0.005035950802266598, -0.012604649178683758, 0.02325516566634178, -0.054228488355875015, -0.07620903104543686, 0.0764530748128891, -0.0679018422961235, -0.011016343720257282, 0.007538978476077318, -0.03399340808391571, 0.028552360832691193, -0.036915022879838943, -0.0928267166018486, -0.04258729889988899, 0.04170601814985275, 0.0557204894721508, 0.0054741413332521915, -0.0508527010679245, 0.018909351900219917, -0.09906692057847977, -0.029620744287967682, 0.017833711579442024, -0.019879205152392387, 0.0006834550877101719, 0.047341156750917435, -0.04990822449326515, -0.01716255210340023, 0.039507120847702026, 0.002763956319540739, 0.04233676195144653, -0.09128551185131073, 0.021852998062968254, -0.045491334050893784, -0.003876769682392478, -0.04667738080024719, -0.018148822709918022, 0.02576877921819687, 0.012938815169036388, -0.01759943924844265, 0.05042668431997299, 0.0072966814041137695, 0.07770740985870361, -0.045169148594141006, -0.07323839515447617, 0.008351152762770653, 0.007953478023409843, -0.004714835435152054, -0.032919175922870636, -0.06336789578199387, -0.010174283757805824, 0.008563329465687275, 0.02098591811954975, -0.033558834344148636, -0.037677280604839325, 0.02241131290793419, -0.049901265650987625, 0.009958988055586815, -0.03820584714412689, 0.04470084607601166, 0.01590130664408207, -0.016525981947779655, -0.003101245267316699, 0.04618902504444122, 0.005928968079388142, 0.04641854390501976, 0.013662979006767273, -0.02730601839721203, -0.02260732650756836, 0.019516505300998688, 0.014044861309230328, 0.009985015727579594, 0.0036300497595220804, 0.007266989443451166, 0.06509029120206833, -0.010095532052218914, 0.018118733540177345, -0.030959732830524445, -0.02009149268269539, 0.03921203687787056, 0.017353219911456108, -0.01061128918081522, -0.04410579428076744, 0.01570095494389534, -0.007173595950007439, 0.004249447025358677, 0.0384400375187397, 0.03772586211562157, 0.05227470025420189, -0.015308933332562447, 0.038963090628385544, -0.01851087063550949, -0.04436035454273224, -0.037230417132377625, 0.04432890564203262, -0.042224857956171036, 0.038043003529310226, -0.011614635586738586, -0.009917216375470161, -0.005439909175038338, 0.005710291676223278, -0.01292689610272646, -0.017040517181158066, -0.02342803217470646, -0.007542700972408056, -0.01887032575905323, -0.00408390024676919, -0.01913602463901043, 0.0015421768184751272, 0.03318754583597183, 0.04709598049521446, 0.05091400444507599, 0.024551717564463615, 0.05177771672606468, -0.03418348729610443, -0.041375115513801575, 0.05476862192153931, -0.017739688977599144, 0.02319563925266266, 0.04009556025266647, -0.05034223198890686, -0.012569224461913109, -0.040207114070653915, 0.047189194709062576, 0.06881839036941528, 0.036453623324632645, 0.007383022923022509, -0.07399331778287888, 0.04669874534010887, 0.04590693861246109, -0.03657842054963112, -0.029057389125227928, -0.023157374933362007, 0.006855986081063747, -0.013003568165004253, 0.03766760230064392, 0.023585092276334763, -0.014273903332650661, 0.024112064391374588, 0.020958127453923225, 0.030608143657445908, 0.00935056246817112, 0.003458634717389941, 0.07281047105789185, 0.036470428109169006, -0.055507928133010864, 0.030497970059514046, 0.07009201496839523, 0.029175128787755966, -0.04006607085466385, 0.02121541276574135, -0.07111053168773651, 0.005707551725208759, 0.03345181420445442, 0.058384835720062256, 0.00447284197434783, -0.024309294298291206, 0.01540397573262453, -0.00007842402555979788, -0.005186615511775017, -0.009474387392401695, -0.017360340803861618, 0.0375961996614933, -0.024325352162122726, 0.10852240025997162, 0.04295344650745392, 0.018111594021320343, 0.014796697534620762, -0.04984721541404724, -0.014833662658929825, -0.007269750349223614, 0.028995905071496964, -0.01402225811034441, -0.00007969354192027822, -0.008047026582062244, 0.02774444781243801, 0.0040969871915876865, -0.008088630624115467, -0.017454709857702255, 0.031756941229104996, -0.037631139159202576, -0.009362776763737202, -0.03553250804543495, -0.02473743073642254, -0.005112426821142435, 0.010493204928934574, -0.01688285544514656, -0.013335518538951874, 0.0016652642516419291, 0.008578014560043812, 0.047118835151195526, -0.03651205822825432, 0.020822320133447647, 0.05174384266138077, 0.05402554199099541, 0.005726643837988377, 0.024147391319274902, -0.012216254137456417, -0.03834644332528114, -0.021724883466959, 0.022474365308880806, -0.0072288778610527515, -0.013360566459596157, 0.03644173592329025, 0.03198769688606262, -0.028750363737344742, -0.0372941717505455, -0.002340676262974739, 0.015134798362851143, 0.018716948106884956, 0.07642769813537598, -0.014287699945271015, 0.0071293264627456665, 0.00017217350250575691, -0.028243685141205788, -0.03771013393998146, 0.025617297738790512, -0.029350411146879196, 0.0410865917801857, 0.009700339287519455, -0.0030304566025733948, -0.006925365421921015, 0.025001641362905502, 0.012117253616452217, 0.019071267917752266, -0.053252384066581726, 0.03433280438184738, -0.07949414104223251, 0.01415552943944931, -0.034957777708768845, -0.044917937368154526, -0.022444983944296837, 0.01898389495909214, -0.009450245648622513, 0.05393995717167854, -0.007413389626890421, -0.042290300130844116, -0.0021597088780254126, 0.006635033525526524, 0.005249409936368465, -0.018422018736600876, 0.008196841925382614, 0.03559621796011925, 0.030688943341374397, 0.006063733249902725, -0.009056570008397102, 0.011896943673491478, 0.006002794019877911, -0.028651341795921326, 0.029948590323328972, -0.005105042830109596, -0.041034799069166183, -0.009642736054956913, -0.04087080433964729, -0.030866360291838646, 0.03304264694452286, -0.006581900641322136, 0.03131371736526489, 0.011574024334549904, 0.0020294361747801304, -0.03986697643995285, 0.06552740186452866, 0.0002521446440368891, -0.06849580258131027, 0.005251407623291016, 0.005539783742278814, -0.013817114755511284, 0.00877917930483818, 0.007843996398150921, -0.00521165831014514, 0.030877962708473206, 0.03003661334514618, -0.01015123724937439, -0.025567078962922096, -0.00979952048510313, -0.00982715655118227, -0.01679673045873642, -0.03347286581993103, 0.010995552875101566, 0.04239370673894882, 0.012884977273643017, -0.01967129297554493, -0.02690216153860092, -0.0537419393658638, 0.04612419754266739, -0.024626154452562332, 0.024760078638792038, 0.010672315023839474, -0.0009442606824450195, 0.02980009652674198, -0.03142961114645004, 0.005180883686989546, 0.015273631550371647, 0.007293933071196079, -0.013583612628281116, 0.030973216518759727, -0.037088122218847275, -0.02731720358133316, -0.029258398339152336, -0.015127088874578476, 0.024791836738586426, -0.031368620693683624, -0.03179318830370903, 0.011125358752906322, -0.026527008041739464, 0.035565946251153946, 0.007999823428690434, 0.016748348250985146, 0.0578162707388401, 0.02152731828391552, -0.024239664897322655, 0.02873917482793331, -0.016491128131747246, 0.003806576831266284, -0.0379222109913826, -0.019340209662914276, -0.028069239109754562, 0.020346377044916153, -0.04691646993160248, 0.040187425911426544, -0.030056890100240707, -0.00934668816626072, 0.034412872046232224, 0.019517192617058754, 0.00571842584758997, 0.007056301459670067, -0.031052365899086, -0.018865026533603668, 0.01035971287637949, 0.02340511791408062, 0.03356312960386276, 0.024721812456846237, 0.020413683727383614, 0.06188393384218216, 0.0024855586234480143, -0.034079745411872864, 0.013799524866044521, -0.0264658872038126, 0.022548187524080276, 0.004792942199856043, 0.0048643918707966805, -0.02826474793255329, 0.007719140965491533, -0.0002229060628451407, -0.014499436132609844, -0.058232128620147705, 0.006874094717204571, -0.020141853019595146, 0.011796528473496437, -0.03683674708008766, -0.020144635811448097, -0.06310122460126877, -0.0005744993686676025, -0.009568058885633945, 0.03347845748066902, -0.028822394087910652, 0.008713101968169212, -0.01366719976067543, 0.000556181010324508, 0.03903563320636749, 0.010797100141644478, 0.01823129877448082, -0.0009091593092307448, 0.032228969037532806, -0.004630065523087978, -0.005639039445668459, 0.020894596353173256, -0.00008655933197587729, -0.020166857168078423, 0.011366728693246841, -0.024981791153550148, -0.028785396367311478, -0.0005089910700917244, 0.025930508971214294, 0.024389345198869705, 0.028883565217256546, -0.03519399091601372, 0.046732936054468155, -0.0015605516964569688, -0.020675430074334145, 0.03479232266545296, -0.03526531532406807, -0.03545811399817467, 0.024641871452331543, -0.0017004553228616714, 0.019755203276872635, 0.015506728552281857, 0.012084905058145523, -0.003097117878496647, -0.0360398069024086, -0.0027035255916416645, 0.030154524371027946, -0.040230561047792435, 0.008995968848466873, -0.04338430240750313, -0.0011625747429206967, 0.005406067240983248, 0.00898006372153759, 0.025237154215574265, -0.02205396443605423, 0.02120666205883026, -0.008092467673122883, 0.053548622876405716, -0.00878408458083868, -0.0008121957071125507, 0.008075183257460594, -0.013216770254075527, 0.003094600047916174, -0.005302043631672859, -0.014354857616126537, 0.009537110105156898, 0.05724840238690376, 0.0038471973966807127, 0.013702616095542908, -0.013545074500143528, 0.028473442420363426, 0.07334710657596588, 0.007879437878727913, -0.010901509784162045, -0.016215741634368896, -0.013836121186614037, -0.0039771017618477345, 0.05668671429157257, -0.01651117205619812, 0.02169436402618885, -0.003131014760583639, -0.0020890343002974987, 0.018677733838558197, 0.01342421118170023, -0.03208912909030914, 0.02090190351009369, 0.06153852492570877, -0.0017614222597330809, 0.007354092784225941, -0.020615138113498688, 0.028870582580566406, 0.03088679350912571, 0.00023880874505266547, -0.027481626719236374, -0.010605577379465103, -0.05585501715540886, -0.02246074564754963, -0.003517249133437872, 0.037035197019577026, -0.03140551969408989, -0.027843017131090164, 0.024822216480970383, -0.03815183788537979, -0.028419118374586105, -0.001893513253889978, 0.021165264770388603, -0.03769949823617935, 0.02438555657863617, -0.0329190157353878, -0.012152718380093575, -0.008549747057259083, -0.014017218723893166, 0.03758098557591438, 0.017697574570775032, 0.0314563512802124, -0.020938124507665634, -0.004193033557385206, 0.00010984546679537743, -0.05198754742741585, 0.03512177616357803, -0.004685565363615751, 0.013876876793801785, -0.0030888968612998724, 0.019371680915355682, -0.05528497323393822, 0.008958532474935055, 0.0006540937465615571, 0.00017407086852472275, -0.0056823864579200745, 0.02045457623898983, -0.01926295831799507, -0.007989882491528988, -0.012086545117199421, 0.01420773658901453, -0.011442702263593674, -0.05625816062092781, -0.03793339058756828, -0.008988410234451294, 0.002976102288812399, -0.011346818879246712, -0.023046011105179787, -0.010411012917757034, -0.00815978366881609, 0.003365460317581892, 0.02891707420349121, -0.015214743092656136, 0.0053184968419373035, 0.02783309295773506, -0.03096819296479225, 0.0023907998111099005, -0.026923296973109245, -0.022503618150949478, -0.043741073459386826, -0.02819158136844635, 0.018597133457660675, 0.002268814481794834, -0.0029174548108130693, -0.025284741073846817, -0.00319598987698555, -0.03348339721560478, 0.01935933157801628, 0.039952851831912994, 0.04389861971139908, 0.024804934859275818, 0.0007417522720061243, -0.02417057938873768, -0.007191809359937906, 0.01685091108083725, -0.03149881586432457, -0.000010680488230718765, 0.041556090116500854, -0.003227245295420289, -0.04296642541885376, 0.029496148228645325, -0.05517983064055443, -0.026096805930137634, 0.025703152641654015, -0.04826205223798752, 0.011460854671895504, 0.025536416098475456, 0.06379643827676773, 0.04230910912156105, -0.027765994891524315, -0.024022798985242844, -0.011495410464704037, 0.022165372967720032, -0.016285767778754234, 0.03393073007464409, -0.04509823024272919, 0.012565627694129944, -0.0021136151626706123, -0.020885808393359184, -0.024248279631137848, 0.009134472347795963, -0.018834421411156654, -0.0217552799731493, -0.05108245462179184, 0.006296403240412474, 0.017696307972073555, 0.04843733832240105, 0.012255779467523098, 0.04236619547009468, -0.0453970767557621, 0.021040739491581917, -0.026848934590816498, -0.04417773708701134, -0.02701510116457939, -0.02679886482656002, 0.00868728756904602, 0.012282646261155605, -0.0023587073665112257, 0.0077600120566785336, -0.008334517478942871, -0.014376750215888023, 0.00024675397435203195, -0.04333096742630005, 0.02545076794922352, 0.04097384959459305, -0.006867955904453993, -0.004614207427948713, 0.006639937870204449, -0.025192759931087494, 0.005046755541115999, 0.029727432876825333, -0.0036288874689489603, 0.028330594301223755, -0.05291871726512909, 0.016500743106007576, -0.024655256420373917, 0.027101678773760796, -0.036831893026828766, -0.029537169262766838, -0.007847853004932404, -0.01710391230881214, 0.004529262892901897, -0.017477143555879593, -0.011326992884278297, 0.03385044261813164, 0.0025562187656760216, -0.030649572610855103, 0.028829025104641914, -0.01702794060111046, 0.003773796372115612, 0.06318812817335129, 0.024801107123494148, 0.0005973030929453671, -0.006220902781933546, -0.020438410341739655, 0.03914552927017212, 0.02747317962348461, -0.009098367765545845, -0.030245523899793625, -0.011044243350625038, 0.0008789818966761231, 0.035039544105529785, 0.022321708500385284, 0.025502661243081093, 0.03415408357977867, 0.011689180508255959, 0.029431642964482307, -0.014848055317997932, -0.013332908041775227, -0.04088233783841133, 0.0016417226288467646, -0.0001908252015709877, -0.048127591609954834, 0.01309671439230442, 0.017438720911741257, -0.023462088778614998, 0.028764156624674797, 0.015662427991628647, 0.015431550331413746, -0.01649722456932068, 0.00826359260827303, -0.002190323080867529, -0.006923543754965067, -0.012776247225701809, -0.03024160861968994, 0.021992236375808716, -0.009583735838532448, 0.006758818868547678, 0.011797710321843624, 0.06525582820177078, -0.01793454773724079, -0.009243237785995007, 0.016094516962766647, -0.011445008218288422, -0.01743880845606327, -0.008408263325691223, 0.01403969619423151, -0.010894207283854485, 0.013176471926271915, -0.017324630171060562, -0.03186485171318054, -0.03562108427286148, 0.0384221114218235, 0.008773223496973515, -0.0024316865019500256, -0.007962893694639206, -0.012082628905773163, -0.008132019080221653, -0.045298200100660324, -0.037971559911966324, -0.011736966669559479, 0.025261100381612778, -0.02263030968606472, 0.001445906120352447, -0.016075950115919113, 0.0295853354036808, 0.016559265553951263, -0.009476060047745705, -0.024880675598978996, 0.005245420150458813, 0.024844862520694733, -0.007902298122644424, -0.014811310917139053, 0.018835658207535744, 0.013316920027136803, 0.02936268411576748, -0.013327701948583126, 0.013596398755908012, -0.010030603967607021, 0.02471514418721199, 0.010211591608822346, -0.006804019678384066, -0.015354492701590061, -0.004576915875077248, 0.03325419872999191, 0.006882003508508205, 0.013088996522128582, 0.01640736311674118, -0.018102262169122696, 0.0014430301962420344, 0.02442939206957817, -0.01429260615259409, 0.015081748366355896, -0.02540522813796997, -0.0119558647274971, -0.004332041367888451, -0.008295868523418903, -0.020444106310606003, -0.007604793645441532, 0.003364169504493475, 0.00020354773732833564, -0.002697459189221263, -0.005108331795781851, 0.008935454301536083, -0.02733936719596386, 0.0063319639302790165, 0.01937936432659626, -0.040439147502183914, 0.0017137906979769468, -0.011859148740768433, -0.0034289464820176363, 0.0036989920772612095, 0.007740485016256571, 0.015089968219399452, -0.007275377865880728, -0.009799518622457981, 0.016716966405510902, -0.0032311684917658567, -0.060726191848516464, 0.002828961471095681, 0.011269385926425457, 0.02417968399822712, -0.026233196258544922, -0.018231205642223358, -0.011497975327074528, -0.009086895734071732, 0.01099392119795084, 0.04455692321062088, 0.0019239230314269662, -0.02908186987042427, 0.02461799792945385, -0.0021742903627455235, -0.004481333773583174, 0.011874686926603317, 0.019026774913072586, 0.01927514187991619, -0.023444704711437225, 0.014641212299466133, 0.0012568593956530094, 0.0016372279496863484, -0.015481566078960896, 0.00914992019534111, 0.017788812518119812, -0.003122493391856551, -0.008762910030782223, -0.00434125354513526, 0.04606098309159279, -0.008591116406023502, 0.0005484759458340704, -0.001336159068159759, -0.017760811373591423, 0.025090107694268227, 0.001943016890436411, -0.010332999750971794, 0.042990852147340775, 0.012340242974460125, 0.010870733298361301, -0.012363673187792301, 0.024340881034731865, 0.002102173864841461, -0.012059740722179413, 0.01977889984846115, -0.01981772854924202, -0.01408790610730648, 0.012559263966977596, -0.002082603285089135, 0.007528300397098064, 0.026997674256563187, -0.01052336860448122, -0.014920263551175594, 0.005067087709903717, 0.003544847946614027, -0.018898144364356995, -0.0081374766305089, -0.036997027695178986, 0.0003397548571228981, -0.019712885841727257, -0.004398426041007042, -0.039350081235170364, 0.01599687524139881, 0.026161037385463715, -0.0076543721370399, -0.011813698336482048, 0.0046318829990923405, -0.015193561092019081, 0.0026564705185592175, 0.005674352403730154, -0.019270414486527443, 0.01656905561685562, 0.015603264793753624, -0.014052958227694035, 0.006996374111622572, -0.02792644128203392, -0.035882655531167984, -0.011499639600515366, -0.0038525101263076067, -0.004764233715832233, 0.02546367421746254, 0.04385506361722946, 0.015397674404084682, -0.0013809357769787312, -0.0009901036974042654, 0.0001122518369811587, -0.003334264736622572, 0.03538162261247635, -0.0015743070980533957, -0.002375634852796793, -0.016721803694963455, 0.020702945068478584, -0.01892886310815811, -0.005655535496771336, -0.010076671838760376, -0.012540903873741627, -0.008144616149365902, 0.01843920163810253, 0.0018893360393121839, -0.002516418229788542, -0.008176185190677643, 0.001942258095368743, 0.024492410942912102, 0.020326241850852966, 0.028259750455617905, 0.0042038061656057835, -0.020344149321317673, 0.015674380585551262, 0.014548246748745441, 0.027964357286691666, 0.00888014119118452, -0.012406482361257076, -0.05167323723435402, -0.03078628145158291, -0.005042042583227158, 0.02372106723487377, -0.00736968033015728, 0.010218181647360325, -0.013124516233801842, -0.008044169284403324, 0.010520095005631447, 0.005561995320022106, 0.021618319675326347, 0.02862992323935032, 0.009091737680137157, 0.021043425425887108, 0.01773924194276333, 0.04213305190205574, -0.006726520601660013, 0.04071580618619919, -0.03269629925489426, 0.018825065344572067, 0.046047136187553406, -0.02938213385641575, 0.015778064727783203, -0.006057696882635355, 0.006428316235542297, -0.01420268602669239, 0.030464045703411102, -0.002448837971314788, 0.012781074270606041, -0.016828753054142, -0.023663189262151718, 0.018488630652427673, -0.045323457568883896, 0.0037064175121486187, 0.002913739299401641, -0.008330711163580418, 0.024225609377026558, -0.017567850649356842, 0.0018023320008069277, -0.006980669219046831, -0.019382553175091743, -0.001860154210589826, 0.016808219254016876, 0.0061479429714381695, 0.01058582216501236, -0.042127709835767746, -0.02071322686970234, 0.025002174079418182, -0.030113685876131058, -0.02306627295911312, -0.03290226683020592, -0.009672964923083782, 0.03738393262028694, 0.040425095707178116, -0.03907371312379837, -0.03412050008773804, 0.008126838132739067, 0.024371294304728508, -0.04400717467069626, 0.0003857500269077718, 0.016115102916955948, -0.029309015721082687, 0.01950220949947834, -0.006159611511975527, -0.004895802121609449, -0.016210295259952545, -0.013117247261106968, -0.006657449062913656, 0.004355574958026409, 0.023292301222682, -0.0007659733528271317, 0.0014287902740761638, -0.0056495340541005135, -0.02707950957119465, -0.03222488984465599, 0.004794982261955738, -0.0022141151130199432, -0.04787970334291458, -0.0010852159466594458, 0.03196459636092186, 0.055236149579286575, 0.007545572705566883, -0.0150687787681818, -0.000030332319511217065, -0.0076913367956876755, -0.03137559816241264]. (VIOLATED_CONSTRAINT) (version 23.3.2.1) (from 192.168.65.1:59040) (in query: INSERT INTO default.docs (`page_content`, `embeddings`) FORMAT Native ), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<String, String, unsigned long, String, String&>(int, FormatStringHelperImpl<std::type_identity<String>::type, std::type_identity<String>::type, std::type_identity<unsigned long>::type, std::type_identity<String>::type, std::type_identity<String&>::type>, String&&, String&&, unsigned long&&, String&&, String&) @ 0x18e873cc in /usr/bin/clickhouse
3. ./build/./src/Processors/Transforms/CheckConstraintsTransform.cpp:0: DB::CheckConstraintsTransform::onConsume(DB::Chunk) @ 0x18e86c80 in /usr/bin/clickhouse
4. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<DB::ExceptionKeepingTransform::work()::$_2, void ()>>(std::__function::__policy_storage const*) @ 0x18e9a12b in /usr/bin/clickhouse
5. ./build/./src/Processors/Transforms/ExceptionKeepingTransform.cpp:103: DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x18e99fc2 in /usr/bin/clickhouse
6. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:818: DB::ExceptionKeepingTransform::work() @ 0x18e9929a in /usr/bin/clickhouse
7. ./build/./src/Processors/Executors/ExecutionThreadContext.cpp:0: DB::ExecutionThreadContext::executeTask() @ 0x18ce950c in /usr/bin/clickhouse
8. ./build/./src/Processors/Executors/PipelineExecutor.cpp:248: DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x18cdfd7b in /usr/bin/clickhouse
9. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::PipelineExecutor::executeImpl(unsigned long) @ 0x18cdf6b9 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:274: DB::PipelineExecutor::execute(unsigned long) @ 0x18cdf497 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/atomic:958: DB::CompletedPipelineExecutor::execute() @ 0x18cde2df in /usr/bin/clickhouse
12. ./build/./src/Interpreters/executeQuery.cpp:0: DB::executeQuery(DB::ReadBuffer&, DB::WriteBuffer&, bool, std::shared_ptr<DB::Context>, std::function<void (DB::QueryResultDetails const&)>, std::optional<DB::FormatSettings> const&) @ 0x17f6a6e3 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/optional:260: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c4a8e0 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
15. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
16. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
18. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
19. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
20. ? @ 0x7f3895a94ac3 in ?
21. ? @ 0x7f3895b26850 in ?

2024.10.09 23:17:30.234985 [ 39 ] {adf9244e-bc72-4e5f-bae0-2e81a5fc40e8} <Error> DynamicQueryHandler: Code: 469. DB::Exception: Constraint `check_data_length` for table default.docs (33d266a7-7d7f-4175-907f-80540f4ae542) is violated at row 1. Expression: (length(embeddings) = 768). Column values: embeddings = [0.04112676903605461, -0.008400964550673962, 0.09749477356672287, -0.053131524473428726, -0.001413525315001607, 0.03715737536549568, 0.008255580440163612, -0.025049051269888878, -0.0015678626950830221, -0.028389258310198784, 0.010690483264625072, -0.006459140218794346, 0.20259089767932892, 0.032178185880184174, 0.046765342354774475, 0.01466406974941492, -0.04373771324753761, 0.023064764216542244, 0.027008596807718277, 0.05068179965019226, -0.11421819031238556, -0.05220935121178627, 0.10694943368434906, 0.09731987863779068, -0.036210861057043076, -0.017703868448734283, -0.021764438599348068, -0.031486380845308304, 0.06449003517627716, -0.06462034583091736, 0.11916103214025497, 0.03971036896109581, -0.01853313483297825, 0.058251846581697464, 0.008044475689530373, 0.01547224447131157, -0.044564105570316315, 0.06325632333755493, 0.005558537319302559, -0.03139401599764824, -0.08913689851760864, -0.04606947302818298, -0.014500710181891918, -0.051759328693151474, 0.006230400409549475, -0.060991041362285614, 0.052895113825798035, 0.016175515949726105, -0.0173935666680336, 0.055896636098623276, -0.004420056007802486, -0.009099304676055908, 0.04762881621718407, -0.02145329862833023, -0.04269666597247124, 0.02086651511490345, 0.018043765798211098, 0.029654046520590782, 0.05177649110555649, 0.07189029455184937, -0.07093359529972076, 0.0010210160398855805, 0.03791459649801254, -0.034294936805963516, 0.0004765923658851534, 0.018332112580537796, 0.0665619820356369, -0.002618261380121112, 0.11268480122089386, -0.04894984886050224, 0.018420640379190445, -0.01757984422147274, -0.010174473747611046, 0.04525480791926384, -0.021397139877080917, 0.11532675474882126, -0.055264171212911606, -0.015345095656812191, -0.12123377621173859, -0.011908014304935932, -0.15089012682437897, 0.040806662291288376, -0.011781638488173485, -0.005612982902675867, 0.006401349790394306, -0.01635991781949997, -0.009834450669586658, 0.010021897032856941, -0.03097623586654663, -0.04822486639022827, 0.016370205208659172, -0.029412854462862015, -0.01282628532499075, -0.04488382861018181, 0.013726006262004375, -0.021837204694747925, 0.04366128891706467, -0.029287194833159447, -0.010640166699886322, -0.10984556376934052, 0.017254607751965523, -0.0004918534541502595, -0.04328940436244011, 0.03474825620651245, 0.041193265467882156, 0.05670227110385895, 0.04823417216539383, -0.019503487274050713, 0.05669773742556572, -0.010472320020198822, -0.009554700925946236, -0.03481427952647209, -0.06290591508150101, 0.020141661167144775, -0.06863225996494293, -0.04927641525864601, 0.013040315359830856, 0.010648333467543125, 0.034409452229738235, 0.07569956034421921, 0.014744537882506847, 0.04826740175485611, -0.005035950802266598, -0.012604649178683758, 0.02325516566634178, -0.054228488355875015, -0.07620903104543686, 0.0764530748128891, -0.0679018422961235, -0.011016343720257282, 0.007538978476077318, -0.03399340808391571, 0.028552360832691193, -0.036915022879838943, -0.0928267166018486, -0.04258729889988899, 0.04170601814985275, 0.0557204894721508, 0.0054741413332521915, -0.0508527010679245, 0.018909351900219917, -0.09906692057847977, -0.029620744287967682, 0.017833711579442024, -0.019879205152392387, 0.0006834550877101719, 0.047341156750917435, -0.04990822449326515, -0.01716255210340023, 0.039507120847702026, 0.002763956319540739, 0.04233676195144653, -0.09128551185131073, 0.021852998062968254, -0.045491334050893784, -0.003876769682392478, -0.04667738080024719, -0.018148822709918022, 0.02576877921819687, 0.012938815169036388, -0.01759943924844265, 0.05042668431997299, 0.0072966814041137695, 0.07770740985870361, -0.045169148594141006, -0.07323839515447617, 0.008351152762770653, 0.007953478023409843, -0.004714835435152054, -0.032919175922870636, -0.06336789578199387, -0.010174283757805824, 0.008563329465687275, 0.02098591811954975, -0.033558834344148636, -0.037677280604839325, 0.02241131290793419, -0.049901265650987625, 0.009958988055586815, -0.03820584714412689, 0.04470084607601166, 0.01590130664408207, -0.016525981947779655, -0.003101245267316699, 0.04618902504444122, 0.005928968079388142, 0.04641854390501976, 0.013662979006767273, -0.02730601839721203, -0.02260732650756836, 0.019516505300998688, 0.014044861309230328, 0.009985015727579594, 0.0036300497595220804, 0.007266989443451166, 0.06509029120206833, -0.010095532052218914, 0.018118733540177345, -0.030959732830524445, -0.02009149268269539, 0.03921203687787056, 0.017353219911456108, -0.01061128918081522, -0.04410579428076744, 0.01570095494389534, -0.007173595950007439, 0.004249447025358677, 0.0384400375187397, 0.03772586211562157, 0.05227470025420189, -0.015308933332562447, 0.038963090628385544, -0.01851087063550949, -0.04436035454273224, -0.037230417132377625, 0.04432890564203262, -0.042224857956171036, 0.038043003529310226, -0.011614635586738586, -0.009917216375470161, -0.005439909175038338, 0.005710291676223278, -0.01292689610272646, -0.017040517181158066, -0.02342803217470646, -0.007542700972408056, -0.01887032575905323, -0.00408390024676919, -0.01913602463901043, 0.0015421768184751272, 0.03318754583597183, 0.04709598049521446, 0.05091400444507599, 0.024551717564463615, 0.05177771672606468, -0.03418348729610443, -0.041375115513801575, 0.05476862192153931, -0.017739688977599144, 0.02319563925266266, 0.04009556025266647, -0.05034223198890686, -0.012569224461913109, -0.040207114070653915, 0.047189194709062576, 0.06881839036941528, 0.036453623324632645, 0.007383022923022509, -0.07399331778287888, 0.04669874534010887, 0.04590693861246109, -0.03657842054963112, -0.029057389125227928, -0.023157374933362007, 0.006855986081063747, -0.013003568165004253, 0.03766760230064392, 0.023585092276334763, -0.014273903332650661, 0.024112064391374588, 0.020958127453923225, 0.030608143657445908, 0.00935056246817112, 0.003458634717389941, 0.07281047105789185, 0.036470428109169006, -0.055507928133010864, 0.030497970059514046, 0.07009201496839523, 0.029175128787755966, -0.04006607085466385, 0.02121541276574135, -0.07111053168773651, 0.005707551725208759, 0.03345181420445442, 0.058384835720062256, 0.00447284197434783, -0.024309294298291206, 0.01540397573262453, -0.00007842402555979788, -0.005186615511775017, -0.009474387392401695, -0.017360340803861618, 0.0375961996614933, -0.024325352162122726, 0.10852240025997162, 0.04295344650745392, 0.018111594021320343, 0.014796697534620762, -0.04984721541404724, -0.014833662658929825, -0.007269750349223614, 0.028995905071496964, -0.01402225811034441, -0.00007969354192027822, -0.008047026582062244, 0.02774444781243801, 0.0040969871915876865, -0.008088630624115467, -0.017454709857702255, 0.031756941229104996, -0.037631139159202576, -0.009362776763737202, -0.03553250804543495, -0.02473743073642254, -0.005112426821142435, 0.010493204928934574, -0.01688285544514656, -0.013335518538951874, 0.0016652642516419291, 0.008578014560043812, 0.047118835151195526, -0.03651205822825432, 0.020822320133447647, 0.05174384266138077, 0.05402554199099541, 0.005726643837988377, 0.024147391319274902, -0.012216254137456417, -0.03834644332528114, -0.021724883466959, 0.022474365308880806, -0.0072288778610527515, -0.013360566459596157, 0.03644173592329025, 0.03198769688606262, -0.028750363737344742, -0.0372941717505455, -0.002340676262974739, 0.015134798362851143, 0.018716948106884956, 0.07642769813537598, -0.014287699945271015, 0.0071293264627456665, 0.00017217350250575691, -0.028243685141205788, -0.03771013393998146, 0.025617297738790512, -0.029350411146879196, 0.0410865917801857, 0.009700339287519455, -0.0030304566025733948, -0.006925365421921015, 0.025001641362905502, 0.012117253616452217, 0.019071267917752266, -0.053252384066581726, 0.03433280438184738, -0.07949414104223251, 0.01415552943944931, -0.034957777708768845, -0.044917937368154526, -0.022444983944296837, 0.01898389495909214, -0.009450245648622513, 0.05393995717167854, -0.007413389626890421, -0.042290300130844116, -0.0021597088780254126, 0.006635033525526524, 0.005249409936368465, -0.018422018736600876, 0.008196841925382614, 0.03559621796011925, 0.030688943341374397, 0.006063733249902725, -0.009056570008397102, 0.011896943673491478, 0.006002794019877911, -0.028651341795921326, 0.029948590323328972, -0.005105042830109596, -0.041034799069166183, -0.009642736054956913, -0.04087080433964729, -0.030866360291838646, 0.03304264694452286, -0.006581900641322136, 0.03131371736526489, 0.011574024334549904, 0.0020294361747801304, -0.03986697643995285, 0.06552740186452866, 0.0002521446440368891, -0.06849580258131027, 0.005251407623291016, 0.005539783742278814, -0.013817114755511284, 0.00877917930483818, 0.007843996398150921, -0.00521165831014514, 0.030877962708473206, 0.03003661334514618, -0.01015123724937439, -0.025567078962922096, -0.00979952048510313, -0.00982715655118227, -0.01679673045873642, -0.03347286581993103, 0.010995552875101566, 0.04239370673894882, 0.012884977273643017, -0.01967129297554493, -0.02690216153860092, -0.0537419393658638, 0.04612419754266739, -0.024626154452562332, 0.024760078638792038, 0.010672315023839474, -0.0009442606824450195, 0.02980009652674198, -0.03142961114645004, 0.005180883686989546, 0.015273631550371647, 0.007293933071196079, -0.013583612628281116, 0.030973216518759727, -0.037088122218847275, -0.02731720358133316, -0.029258398339152336, -0.015127088874578476, 0.024791836738586426, -0.031368620693683624, -0.03179318830370903, 0.011125358752906322, -0.026527008041739464, 0.035565946251153946, 0.007999823428690434, 0.016748348250985146, 0.0578162707388401, 0.02152731828391552, -0.024239664897322655, 0.02873917482793331, -0.016491128131747246, 0.003806576831266284, -0.0379222109913826, -0.019340209662914276, -0.028069239109754562, 0.020346377044916153, -0.04691646993160248, 0.040187425911426544, -0.030056890100240707, -0.00934668816626072, 0.034412872046232224, 0.019517192617058754, 0.00571842584758997, 0.007056301459670067, -0.031052365899086, -0.018865026533603668, 0.01035971287637949, 0.02340511791408062, 0.03356312960386276, 0.024721812456846237, 0.020413683727383614, 0.06188393384218216, 0.0024855586234480143, -0.034079745411872864, 0.013799524866044521, -0.0264658872038126, 0.022548187524080276, 0.004792942199856043, 0.0048643918707966805, -0.02826474793255329, 0.007719140965491533, -0.0002229060628451407, -0.014499436132609844, -0.058232128620147705, 0.006874094717204571, -0.020141853019595146, 0.011796528473496437, -0.03683674708008766, -0.020144635811448097, -0.06310122460126877, -0.0005744993686676025, -0.009568058885633945, 0.03347845748066902, -0.028822394087910652, 0.008713101968169212, -0.01366719976067543, 0.000556181010324508, 0.03903563320636749, 0.010797100141644478, 0.01823129877448082, -0.0009091593092307448, 0.032228969037532806, -0.004630065523087978, -0.005639039445668459, 0.020894596353173256, -0.00008655933197587729, -0.020166857168078423, 0.011366728693246841, -0.024981791153550148, -0.028785396367311478, -0.0005089910700917244, 0.025930508971214294, 0.024389345198869705, 0.028883565217256546, -0.03519399091601372, 0.046732936054468155, -0.0015605516964569688, -0.020675430074334145, 0.03479232266545296, -0.03526531532406807, -0.03545811399817467, 0.024641871452331543, -0.0017004553228616714, 0.019755203276872635, 0.015506728552281857, 0.012084905058145523, -0.003097117878496647, -0.0360398069024086, -0.0027035255916416645, 0.030154524371027946, -0.040230561047792435, 0.008995968848466873, -0.04338430240750313, -0.0011625747429206967, 0.005406067240983248, 0.00898006372153759, 0.025237154215574265, -0.02205396443605423, 0.02120666205883026, -0.008092467673122883, 0.053548622876405716, -0.00878408458083868, -0.0008121957071125507, 0.008075183257460594, -0.013216770254075527, 0.003094600047916174, -0.005302043631672859, -0.014354857616126537, 0.009537110105156898, 0.05724840238690376, 0.0038471973966807127, 0.013702616095542908, -0.013545074500143528, 0.028473442420363426, 0.07334710657596588, 0.007879437878727913, -0.010901509784162045, -0.016215741634368896, -0.013836121186614037, -0.0039771017618477345, 0.05668671429157257, -0.01651117205619812, 0.02169436402618885, -0.003131014760583639, -0.0020890343002974987, 0.018677733838558197, 0.01342421118170023, -0.03208912909030914, 0.02090190351009369, 0.06153852492570877, -0.0017614222597330809, 0.007354092784225941, -0.020615138113498688, 0.028870582580566406, 0.03088679350912571, 0.00023880874505266547, -0.027481626719236374, -0.010605577379465103, -0.05585501715540886, -0.02246074564754963, -0.003517249133437872, 0.037035197019577026, -0.03140551969408989, -0.027843017131090164, 0.024822216480970383, -0.03815183788537979, -0.028419118374586105, -0.001893513253889978, 0.021165264770388603, -0.03769949823617935, 0.02438555657863617, -0.0329190157353878, -0.012152718380093575, -0.008549747057259083, -0.014017218723893166, 0.03758098557591438, 0.017697574570775032, 0.0314563512802124, -0.020938124507665634, -0.004193033557385206, 0.00010984546679537743, -0.05198754742741585, 0.03512177616357803, -0.004685565363615751, 0.013876876793801785, -0.0030888968612998724, 0.019371680915355682, -0.05528497323393822, 0.008958532474935055, 0.0006540937465615571, 0.00017407086852472275, -0.0056823864579200745, 0.02045457623898983, -0.01926295831799507, -0.007989882491528988, -0.012086545117199421, 0.01420773658901453, -0.011442702263593674, -0.05625816062092781, -0.03793339058756828, -0.008988410234451294, 0.002976102288812399, -0.011346818879246712, -0.023046011105179787, -0.010411012917757034, -0.00815978366881609, 0.003365460317581892, 0.02891707420349121, -0.015214743092656136, 0.0053184968419373035, 0.02783309295773506, -0.03096819296479225, 0.0023907998111099005, -0.026923296973109245, -0.022503618150949478, -0.043741073459386826, -0.02819158136844635, 0.018597133457660675, 0.002268814481794834, -0.0029174548108130693, -0.025284741073846817, -0.00319598987698555, -0.03348339721560478, 0.01935933157801628, 0.039952851831912994, 0.04389861971139908, 0.024804934859275818, 0.0007417522720061243, -0.02417057938873768, -0.007191809359937906, 0.01685091108083725, -0.03149881586432457, -0.000010680488230718765, 0.041556090116500854, -0.003227245295420289, -0.04296642541885376, 0.029496148228645325, -0.05517983064055443, -0.026096805930137634, 0.025703152641654015, -0.04826205223798752, 0.011460854671895504, 0.025536416098475456, 0.06379643827676773, 0.04230910912156105, -0.027765994891524315, -0.024022798985242844, -0.011495410464704037, 0.022165372967720032, -0.016285767778754234, 0.03393073007464409, -0.04509823024272919, 0.012565627694129944, -0.0021136151626706123, -0.020885808393359184, -0.024248279631137848, 0.009134472347795963, -0.018834421411156654, -0.0217552799731493, -0.05108245462179184, 0.006296403240412474, 0.017696307972073555, 0.04843733832240105, 0.012255779467523098, 0.04236619547009468, -0.0453970767557621, 0.021040739491581917, -0.026848934590816498, -0.04417773708701134, -0.02701510116457939, -0.02679886482656002, 0.00868728756904602, 0.012282646261155605, -0.0023587073665112257, 0.0077600120566785336, -0.008334517478942871, -0.014376750215888023, 0.00024675397435203195, -0.04333096742630005, 0.02545076794922352, 0.04097384959459305, -0.006867955904453993, -0.004614207427948713, 0.006639937870204449, -0.025192759931087494, 0.005046755541115999, 0.029727432876825333, -0.0036288874689489603, 0.028330594301223755, -0.05291871726512909, 0.016500743106007576, -0.024655256420373917, 0.027101678773760796, -0.036831893026828766, -0.029537169262766838, -0.007847853004932404, -0.01710391230881214, 0.004529262892901897, -0.017477143555879593, -0.011326992884278297, 0.03385044261813164, 0.0025562187656760216, -0.030649572610855103, 0.028829025104641914, -0.01702794060111046, 0.003773796372115612, 0.06318812817335129, 0.024801107123494148, 0.0005973030929453671, -0.006220902781933546, -0.020438410341739655, 0.03914552927017212, 0.02747317962348461, -0.009098367765545845, -0.030245523899793625, -0.011044243350625038, 0.0008789818966761231, 0.035039544105529785, 0.022321708500385284, 0.025502661243081093, 0.03415408357977867, 0.011689180508255959, 0.029431642964482307, -0.014848055317997932, -0.013332908041775227, -0.04088233783841133, 0.0016417226288467646, -0.0001908252015709877, -0.048127591609954834, 0.01309671439230442, 0.017438720911741257, -0.023462088778614998, 0.028764156624674797, 0.015662427991628647, 0.015431550331413746, -0.01649722456932068, 0.00826359260827303, -0.002190323080867529, -0.006923543754965067, -0.012776247225701809, -0.03024160861968994, 0.021992236375808716, -0.009583735838532448, 0.006758818868547678, 0.011797710321843624, 0.06525582820177078, -0.01793454773724079, -0.009243237785995007, 0.016094516962766647, -0.011445008218288422, -0.01743880845606327, -0.008408263325691223, 0.01403969619423151, -0.010894207283854485, 0.013176471926271915, -0.017324630171060562, -0.03186485171318054, -0.03562108427286148, 0.0384221114218235, 0.008773223496973515, -0.0024316865019500256, -0.007962893694639206, -0.012082628905773163, -0.008132019080221653, -0.045298200100660324, -0.037971559911966324, -0.011736966669559479, 0.025261100381612778, -0.02263030968606472, 0.001445906120352447, -0.016075950115919113, 0.0295853354036808, 0.016559265553951263, -0.009476060047745705, -0.024880675598978996, 0.005245420150458813, 0.024844862520694733, -0.007902298122644424, -0.014811310917139053, 0.018835658207535744, 0.013316920027136803, 0.02936268411576748, -0.013327701948583126, 0.013596398755908012, -0.010030603967607021, 0.02471514418721199, 0.010211591608822346, -0.006804019678384066, -0.015354492701590061, -0.004576915875077248, 0.03325419872999191, 0.006882003508508205, 0.013088996522128582, 0.01640736311674118, -0.018102262169122696, 0.0014430301962420344, 0.02442939206957817, -0.01429260615259409, 0.015081748366355896, -0.02540522813796997, -0.0119558647274971, -0.004332041367888451, -0.008295868523418903, -0.020444106310606003, -0.007604793645441532, 0.003364169504493475, 0.00020354773732833564, -0.002697459189221263, -0.005108331795781851, 0.008935454301536083, -0.02733936719596386, 0.0063319639302790165, 0.01937936432659626, -0.040439147502183914, 0.0017137906979769468, -0.011859148740768433, -0.0034289464820176363, 0.0036989920772612095, 0.007740485016256571, 0.015089968219399452, -0.007275377865880728, -0.009799518622457981, 0.016716966405510902, -0.0032311684917658567, -0.060726191848516464, 0.002828961471095681, 0.011269385926425457, 0.02417968399822712, -0.026233196258544922, -0.018231205642223358, -0.011497975327074528, -0.009086895734071732, 0.01099392119795084, 0.04455692321062088, 0.0019239230314269662, -0.02908186987042427, 0.02461799792945385, -0.0021742903627455235, -0.004481333773583174, 0.011874686926603317, 0.019026774913072586, 0.01927514187991619, -0.023444704711437225, 0.014641212299466133, 0.0012568593956530094, 0.0016372279496863484, -0.015481566078960896, 0.00914992019534111, 0.017788812518119812, -0.003122493391856551, -0.008762910030782223, -0.00434125354513526, 0.04606098309159279, -0.008591116406023502, 0.0005484759458340704, -0.001336159068159759, -0.017760811373591423, 0.025090107694268227, 0.001943016890436411, -0.010332999750971794, 0.042990852147340775, 0.012340242974460125, 0.010870733298361301, -0.012363673187792301, 0.024340881034731865, 0.002102173864841461, -0.012059740722179413, 0.01977889984846115, -0.01981772854924202, -0.01408790610730648, 0.012559263966977596, -0.002082603285089135, 0.007528300397098064, 0.026997674256563187, -0.01052336860448122, -0.014920263551175594, 0.005067087709903717, 0.003544847946614027, -0.018898144364356995, -0.0081374766305089, -0.036997027695178986, 0.0003397548571228981, -0.019712885841727257, -0.004398426041007042, -0.039350081235170364, 0.01599687524139881, 0.026161037385463715, -0.0076543721370399, -0.011813698336482048, 0.0046318829990923405, -0.015193561092019081, 0.0026564705185592175, 0.005674352403730154, -0.019270414486527443, 0.01656905561685562, 0.015603264793753624, -0.014052958227694035, 0.006996374111622572, -0.02792644128203392, -0.035882655531167984, -0.011499639600515366, -0.0038525101263076067, -0.004764233715832233, 0.02546367421746254, 0.04385506361722946, 0.015397674404084682, -0.0013809357769787312, -0.0009901036974042654, 0.0001122518369811587, -0.003334264736622572, 0.03538162261247635, -0.0015743070980533957, -0.002375634852796793, -0.016721803694963455, 0.020702945068478584, -0.01892886310815811, -0.005655535496771336, -0.010076671838760376, -0.012540903873741627, -0.008144616149365902, 0.01843920163810253, 0.0018893360393121839, -0.002516418229788542, -0.008176185190677643, 0.001942258095368743, 0.024492410942912102, 0.020326241850852966, 0.028259750455617905, 0.0042038061656057835, -0.020344149321317673, 0.015674380585551262, 0.014548246748745441, 0.027964357286691666, 0.00888014119118452, -0.012406482361257076, -0.05167323723435402, -0.03078628145158291, -0.005042042583227158, 0.02372106723487377, -0.00736968033015728, 0.010218181647360325, -0.013124516233801842, -0.008044169284403324, 0.010520095005631447, 0.005561995320022106, 0.021618319675326347, 0.02862992323935032, 0.009091737680137157, 0.021043425425887108, 0.01773924194276333, 0.04213305190205574, -0.006726520601660013, 0.04071580618619919, -0.03269629925489426, 0.018825065344572067, 0.046047136187553406, -0.02938213385641575, 0.015778064727783203, -0.006057696882635355, 0.006428316235542297, -0.01420268602669239, 0.030464045703411102, -0.002448837971314788, 0.012781074270606041, -0.016828753054142, -0.023663189262151718, 0.018488630652427673, -0.045323457568883896, 0.0037064175121486187, 0.002913739299401641, -0.008330711163580418, 0.024225609377026558, -0.017567850649356842, 0.0018023320008069277, -0.006980669219046831, -0.019382553175091743, -0.001860154210589826, 0.016808219254016876, 0.0061479429714381695, 0.01058582216501236, -0.042127709835767746, -0.02071322686970234, 0.025002174079418182, -0.030113685876131058, -0.02306627295911312, -0.03290226683020592, -0.009672964923083782, 0.03738393262028694, 0.040425095707178116, -0.03907371312379837, -0.03412050008773804, 0.008126838132739067, 0.024371294304728508, -0.04400717467069626, 0.0003857500269077718, 0.016115102916955948, -0.029309015721082687, 0.01950220949947834, -0.006159611511975527, -0.004895802121609449, -0.016210295259952545, -0.013117247261106968, -0.006657449062913656, 0.004355574958026409, 0.023292301222682, -0.0007659733528271317, 0.0014287902740761638, -0.0056495340541005135, -0.02707950957119465, -0.03222488984465599, 0.004794982261955738, -0.0022141151130199432, -0.04787970334291458, -0.0010852159466594458, 0.03196459636092186, 0.055236149579286575, 0.007545572705566883, -0.0150687787681818, -0.000030332319511217065, -0.0076913367956876755, -0.03137559816241264]. (VIOLATED_CONSTRAINT), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<String, String, unsigned long, String, String&>(int, FormatStringHelperImpl<std::type_identity<String>::type, std::type_identity<String>::type, std::type_identity<unsigned long>::type, std::type_identity<String>::type, std::type_identity<String&>::type>, String&&, String&&, unsigned long&&, String&&, String&) @ 0x18e873cc in /usr/bin/clickhouse
3. ./build/./src/Processors/Transforms/CheckConstraintsTransform.cpp:0: DB::CheckConstraintsTransform::onConsume(DB::Chunk) @ 0x18e86c80 in /usr/bin/clickhouse
4. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<DB::ExceptionKeepingTransform::work()::$_2, void ()>>(std::__function::__policy_storage const*) @ 0x18e9a12b in /usr/bin/clickhouse
5. ./build/./src/Processors/Transforms/ExceptionKeepingTransform.cpp:103: DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x18e99fc2 in /usr/bin/clickhouse
6. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:818: DB::ExceptionKeepingTransform::work() @ 0x18e9929a in /usr/bin/clickhouse
7. ./build/./src/Processors/Executors/ExecutionThreadContext.cpp:0: DB::ExecutionThreadContext::executeTask() @ 0x18ce950c in /usr/bin/clickhouse
8. ./build/./src/Processors/Executors/PipelineExecutor.cpp:248: DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x18cdfd7b in /usr/bin/clickhouse
9. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::PipelineExecutor::executeImpl(unsigned long) @ 0x18cdf6b9 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:274: DB::PipelineExecutor::execute(unsigned long) @ 0x18cdf497 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/atomic:958: DB::CompletedPipelineExecutor::execute() @ 0x18cde2df in /usr/bin/clickhouse
12. ./build/./src/Interpreters/executeQuery.cpp:0: DB::executeQuery(DB::ReadBuffer&, DB::WriteBuffer&, bool, std::shared_ptr<DB::Context>, std::function<void (DB::QueryResultDetails const&)>, std::optional<DB::FormatSettings> const&) @ 0x17f6a6e3 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/optional:260: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c4a8e0 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
15. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
16. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
18. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
19. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
20. ? @ 0x7f3895a94ac3 in ?
21. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.09 23:19:27.664575 [ 39 ] {3130636b-cab4-45e1-b381-c0b7c7aac742} <Error> executeQuery: Code: 62. DB::Exception: Syntax error: failed at position 74 ('0.00173875') (line 3, col 44): 0.00173875  0.0231368  ...  0.03880655 -0.00204463
 -0.01360729]) as dist 
        FROM default.docs 
        ORDER BY dist 
        LIMIT 3
    
 FORMAT Native. Expected one of: comma or closing bracket, token, DoubleColon, Comma, ClosingSquareBracket, OR, AND, BETWEEN, NOT BETWEEN, LIKE, ILIKE, NOT LIKE, NOT ILIKE, REGEXP, IN, NOT IN, GLOBAL IN, GLOBAL NOT IN, MOD, DIV, IS NULL, IS NOT NULL, alias, AS, end of query. (SYNTAX_ERROR) (version 23.3.2.1) (from 192.168.65.1:50182) (in query:  SELECT page_content, distance(embeddings, [-0.02439346 0.00173875 0.0231368 ... 0.03880655 -0.00204463 -0.01360729]) as dist FROM default.docs ORDER BY dist LIMIT 3 FORMAT Native), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::createDeprecated(String const&, int, bool) @ 0xddbad8d in /usr/bin/clickhouse
3. ./build/./src/Parsers/parseQuery.cpp:362: DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, String const&, bool, unsigned long, unsigned long) @ 0x19435880 in /usr/bin/clickhouse
4. ./build/./src/Parsers/parseQuery.cpp:374: DB::parseQuery(DB::IParser&, char const*, char const*, String const&, unsigned long, unsigned long) @ 0x19435900 in /usr/bin/clickhouse
5. ./build/./src/Interpreters/executeQuery.cpp:0: DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x17f5b76c in /usr/bin/clickhouse
6. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:612: DB::executeQuery(DB::ReadBuffer&, DB::WriteBuffer&, bool, std::shared_ptr<DB::Context>, std::function<void (DB::QueryResultDetails const&)>, std::optional<DB::FormatSettings> const&) @ 0x17f6a022 in /usr/bin/clickhouse
7. ./build/./contrib/llvm-project/libcxx/include/optional:260: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c4a8e0 in /usr/bin/clickhouse
8. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
9. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
10. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
12. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
13. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
14. ? @ 0x7f3895a94ac3 in ?
15. ? @ 0x7f3895b26850 in ?

2024.10.09 23:19:27.670122 [ 39 ] {3130636b-cab4-45e1-b381-c0b7c7aac742} <Error> DynamicQueryHandler: Code: 62. DB::Exception: Syntax error: failed at position 74 ('0.00173875') (line 3, col 44): 0.00173875  0.0231368  ...  0.03880655 -0.00204463
 -0.01360729]) as dist 
        FROM default.docs 
        ORDER BY dist 
        LIMIT 3
    
 FORMAT Native. Expected one of: comma or closing bracket, token, DoubleColon, Comma, ClosingSquareBracket, OR, AND, BETWEEN, NOT BETWEEN, LIKE, ILIKE, NOT LIKE, NOT ILIKE, REGEXP, IN, NOT IN, GLOBAL IN, GLOBAL NOT IN, MOD, DIV, IS NULL, IS NOT NULL, alias, AS, end of query. (SYNTAX_ERROR), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::createDeprecated(String const&, int, bool) @ 0xddbad8d in /usr/bin/clickhouse
3. ./build/./src/Parsers/parseQuery.cpp:362: DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, String const&, bool, unsigned long, unsigned long) @ 0x19435880 in /usr/bin/clickhouse
4. ./build/./src/Parsers/parseQuery.cpp:374: DB::parseQuery(DB::IParser&, char const*, char const*, String const&, unsigned long, unsigned long) @ 0x19435900 in /usr/bin/clickhouse
5. ./build/./src/Interpreters/executeQuery.cpp:0: DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x17f5b76c in /usr/bin/clickhouse
6. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:612: DB::executeQuery(DB::ReadBuffer&, DB::WriteBuffer&, bool, std::shared_ptr<DB::Context>, std::function<void (DB::QueryResultDetails const&)>, std::optional<DB::FormatSettings> const&) @ 0x17f6a022 in /usr/bin/clickhouse
7. ./build/./contrib/llvm-project/libcxx/include/optional:260: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c4a8e0 in /usr/bin/clickhouse
8. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
9. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
10. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
12. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
13. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
14. ? @ 0x7f3895a94ac3 in ?
15. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.09 23:22:27.691717 [ 39 ] {c496ff47-caf2-4c35-a732-c19cc094192d} <Error> executeQuery: Code: 62. DB::Exception: Syntax error: failed at position 74 ('0.00850882') (line 3, col 44): 0.00850882  0.01167181 ...  0.04060476 -0.00396987
 -0.04934154]) as dist 
        FROM default.docs 
        ORDER BY dist 
        LIMIT 3
    
 FORMAT Native. Expected one of: comma or closing bracket, token, DoubleColon, Comma, ClosingSquareBracket, OR, AND, BETWEEN, NOT BETWEEN, LIKE, ILIKE, NOT LIKE, NOT ILIKE, REGEXP, IN, NOT IN, GLOBAL IN, GLOBAL NOT IN, MOD, DIV, IS NULL, IS NOT NULL, alias, AS, end of query. (SYNTAX_ERROR) (version 23.3.2.1) (from 192.168.65.1:29998) (in query:  SELECT page_content, distance(embeddings, [-0.00425883 0.00850882 0.01167181 ... 0.04060476 -0.00396987 -0.04934154]) as dist FROM default.docs ORDER BY dist LIMIT 3 FORMAT Native), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::createDeprecated(String const&, int, bool) @ 0xddbad8d in /usr/bin/clickhouse
3. ./build/./src/Parsers/parseQuery.cpp:362: DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, String const&, bool, unsigned long, unsigned long) @ 0x19435880 in /usr/bin/clickhouse
4. ./build/./src/Parsers/parseQuery.cpp:374: DB::parseQuery(DB::IParser&, char const*, char const*, String const&, unsigned long, unsigned long) @ 0x19435900 in /usr/bin/clickhouse
5. ./build/./src/Interpreters/executeQuery.cpp:0: DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x17f5b76c in /usr/bin/clickhouse
6. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:612: DB::executeQuery(DB::ReadBuffer&, DB::WriteBuffer&, bool, std::shared_ptr<DB::Context>, std::function<void (DB::QueryResultDetails const&)>, std::optional<DB::FormatSettings> const&) @ 0x17f6a022 in /usr/bin/clickhouse
7. ./build/./contrib/llvm-project/libcxx/include/optional:260: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c4a8e0 in /usr/bin/clickhouse
8. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
9. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
10. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
12. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
13. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
14. ? @ 0x7f3895a94ac3 in ?
15. ? @ 0x7f3895b26850 in ?

2024.10.09 23:22:27.694499 [ 39 ] {c496ff47-caf2-4c35-a732-c19cc094192d} <Error> DynamicQueryHandler: Code: 62. DB::Exception: Syntax error: failed at position 74 ('0.00850882') (line 3, col 44): 0.00850882  0.01167181 ...  0.04060476 -0.00396987
 -0.04934154]) as dist 
        FROM default.docs 
        ORDER BY dist 
        LIMIT 3
    
 FORMAT Native. Expected one of: comma or closing bracket, token, DoubleColon, Comma, ClosingSquareBracket, OR, AND, BETWEEN, NOT BETWEEN, LIKE, ILIKE, NOT LIKE, NOT ILIKE, REGEXP, IN, NOT IN, GLOBAL IN, GLOBAL NOT IN, MOD, DIV, IS NULL, IS NOT NULL, alias, AS, end of query. (SYNTAX_ERROR), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::createDeprecated(String const&, int, bool) @ 0xddbad8d in /usr/bin/clickhouse
3. ./build/./src/Parsers/parseQuery.cpp:362: DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, String const&, bool, unsigned long, unsigned long) @ 0x19435880 in /usr/bin/clickhouse
4. ./build/./src/Parsers/parseQuery.cpp:374: DB::parseQuery(DB::IParser&, char const*, char const*, String const&, unsigned long, unsigned long) @ 0x19435900 in /usr/bin/clickhouse
5. ./build/./src/Interpreters/executeQuery.cpp:0: DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x17f5b76c in /usr/bin/clickhouse
6. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:612: DB::executeQuery(DB::ReadBuffer&, DB::WriteBuffer&, bool, std::shared_ptr<DB::Context>, std::function<void (DB::QueryResultDetails const&)>, std::optional<DB::FormatSettings> const&) @ 0x17f6a022 in /usr/bin/clickhouse
7. ./build/./contrib/llvm-project/libcxx/include/optional:260: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c4a8e0 in /usr/bin/clickhouse
8. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
9. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
10. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
12. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
13. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
14. ? @ 0x7f3895a94ac3 in ?
15. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.09 23:25:07.083059 [ 39 ] {859433b8-2acf-404b-b9a2-b39cebdde258} <Error> executeQuery: Code: 62. DB::Exception: Syntax error: failed at position 86 ('0.0269929') (line 3, col 56): 0.0269929  ...  0.0400366  -0.00303583
 -0.01164571]) as dist 
        FROM default.docs 
        ORDER BY dist 
        LIMIT 3
    
 FORMAT Native. Expected one of: token, DoubleColon, Comma, ClosingSquareBracket, OR, AND, BETWEEN, NOT BETWEEN, LIKE, ILIKE, NOT LIKE, NOT ILIKE, REGEXP, IN, NOT IN, GLOBAL IN, GLOBAL NOT IN, MOD, DIV, IS NULL, IS NOT NULL, alias, AS, end of query. (SYNTAX_ERROR) (version 23.3.2.1) (from 192.168.65.1:18959) (in query:  SELECT page_content, distance(embeddings, [-0.02962006 -0.00159443 0.0269929 ... 0.0400366 -0.00303583 -0.01164571]) as dist FROM default.docs ORDER BY dist LIMIT 3 FORMAT Native), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::createDeprecated(String const&, int, bool) @ 0xddbad8d in /usr/bin/clickhouse
3. ./build/./src/Parsers/parseQuery.cpp:362: DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, String const&, bool, unsigned long, unsigned long) @ 0x19435880 in /usr/bin/clickhouse
4. ./build/./src/Parsers/parseQuery.cpp:374: DB::parseQuery(DB::IParser&, char const*, char const*, String const&, unsigned long, unsigned long) @ 0x19435900 in /usr/bin/clickhouse
5. ./build/./src/Interpreters/executeQuery.cpp:0: DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x17f5b76c in /usr/bin/clickhouse
6. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:612: DB::executeQuery(DB::ReadBuffer&, DB::WriteBuffer&, bool, std::shared_ptr<DB::Context>, std::function<void (DB::QueryResultDetails const&)>, std::optional<DB::FormatSettings> const&) @ 0x17f6a022 in /usr/bin/clickhouse
7. ./build/./contrib/llvm-project/libcxx/include/optional:260: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c4a8e0 in /usr/bin/clickhouse
8. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
9. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
10. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
12. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
13. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
14. ? @ 0x7f3895a94ac3 in ?
15. ? @ 0x7f3895b26850 in ?

2024.10.09 23:25:07.085189 [ 39 ] {859433b8-2acf-404b-b9a2-b39cebdde258} <Error> DynamicQueryHandler: Code: 62. DB::Exception: Syntax error: failed at position 86 ('0.0269929') (line 3, col 56): 0.0269929  ...  0.0400366  -0.00303583
 -0.01164571]) as dist 
        FROM default.docs 
        ORDER BY dist 
        LIMIT 3
    
 FORMAT Native. Expected one of: token, DoubleColon, Comma, ClosingSquareBracket, OR, AND, BETWEEN, NOT BETWEEN, LIKE, ILIKE, NOT LIKE, NOT ILIKE, REGEXP, IN, NOT IN, GLOBAL IN, GLOBAL NOT IN, MOD, DIV, IS NULL, IS NOT NULL, alias, AS, end of query. (SYNTAX_ERROR), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::createDeprecated(String const&, int, bool) @ 0xddbad8d in /usr/bin/clickhouse
3. ./build/./src/Parsers/parseQuery.cpp:362: DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, String const&, bool, unsigned long, unsigned long) @ 0x19435880 in /usr/bin/clickhouse
4. ./build/./src/Parsers/parseQuery.cpp:374: DB::parseQuery(DB::IParser&, char const*, char const*, String const&, unsigned long, unsigned long) @ 0x19435900 in /usr/bin/clickhouse
5. ./build/./src/Interpreters/executeQuery.cpp:0: DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x17f5b76c in /usr/bin/clickhouse
6. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:612: DB::executeQuery(DB::ReadBuffer&, DB::WriteBuffer&, bool, std::shared_ptr<DB::Context>, std::function<void (DB::QueryResultDetails const&)>, std::optional<DB::FormatSettings> const&) @ 0x17f6a022 in /usr/bin/clickhouse
7. ./build/./contrib/llvm-project/libcxx/include/optional:260: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c4a8e0 in /usr/bin/clickhouse
8. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
9. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
10. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
12. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
13. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
14. ? @ 0x7f3895a94ac3 in ?
15. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.09 23:25:17.692334 [ 226 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360448 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:157: DB::WriteBufferFromFileBase::WriteBufferFromFileBase(unsigned long, char*, unsigned long) @ 0x127a5e2c in /usr/bin/clickhouse
10. ./build/./src/IO/WriteBufferFromFileDescriptor.cpp:93: DB::WriteBufferFromFileDescriptor::WriteBufferFromFileDescriptor(int, unsigned long, char*, unsigned long, String) @ 0x127a599b in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::WriteBufferFromFile::WriteBufferFromFile(String const&, unsigned long, int, unsigned int, char*, unsigned long) @ 0x12825d14 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/string:1499: std::__unique_if<DB::WriteBufferFromFile>::__unique_single std::make_unique[abi:v15000]<DB::WriteBufferFromFile, std::__fs::filesystem::path, unsigned long&, int&>(std::__fs::filesystem::path&&, unsigned long&, int&) @ 0x1717a40f in /usr/bin/clickhouse
13. ./build/./src/Disks/DiskLocal.cpp:0: DB::DiskLocal::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1717144d in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/DataPartStorageOnDiskFull.cpp:0: DB::DataPartStorageOnDiskFull::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1878a0c5 in /usr/bin/clickhouse
15. ./build/./src/Storages/MergeTree/IDataPartStorage.h:0: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f41e4 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
17. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
20. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
24. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
27. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
28. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
29. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
31. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.09 23:26:50.276413 [ 39 ] {4ed411b9-ee65-437b-a609-c4e180c4ae1f} <Error> executeQuery: Code: 62. DB::Exception: Syntax error: failed at position 86 ('0.0269929') (line 3, col 56): 0.0269929  ...  0.0400366  -0.00303583
 -0.01164571]) as dist 
        FROM default.docs 
        ORDER BY dist 
        LIMIT 3
    
 FORMAT Native. Expected one of: token, DoubleColon, Comma, ClosingSquareBracket, OR, AND, BETWEEN, NOT BETWEEN, LIKE, ILIKE, NOT LIKE, NOT ILIKE, REGEXP, IN, NOT IN, GLOBAL IN, GLOBAL NOT IN, MOD, DIV, IS NULL, IS NOT NULL, alias, AS, end of query. (SYNTAX_ERROR) (version 23.3.2.1) (from 192.168.65.1:52659) (in query:  SELECT page_content, distance(embeddings, [-0.02962006 -0.00159443 0.0269929 ... 0.0400366 -0.00303583 -0.01164571]) as dist FROM default.docs ORDER BY dist LIMIT 3 FORMAT Native), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::createDeprecated(String const&, int, bool) @ 0xddbad8d in /usr/bin/clickhouse
3. ./build/./src/Parsers/parseQuery.cpp:362: DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, String const&, bool, unsigned long, unsigned long) @ 0x19435880 in /usr/bin/clickhouse
4. ./build/./src/Parsers/parseQuery.cpp:374: DB::parseQuery(DB::IParser&, char const*, char const*, String const&, unsigned long, unsigned long) @ 0x19435900 in /usr/bin/clickhouse
5. ./build/./src/Interpreters/executeQuery.cpp:0: DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x17f5b76c in /usr/bin/clickhouse
6. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:612: DB::executeQuery(DB::ReadBuffer&, DB::WriteBuffer&, bool, std::shared_ptr<DB::Context>, std::function<void (DB::QueryResultDetails const&)>, std::optional<DB::FormatSettings> const&) @ 0x17f6a022 in /usr/bin/clickhouse
7. ./build/./contrib/llvm-project/libcxx/include/optional:260: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c4a8e0 in /usr/bin/clickhouse
8. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
9. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
10. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
12. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
13. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
14. ? @ 0x7f3895a94ac3 in ?
15. ? @ 0x7f3895b26850 in ?

2024.10.09 23:26:50.278062 [ 39 ] {4ed411b9-ee65-437b-a609-c4e180c4ae1f} <Error> DynamicQueryHandler: Code: 62. DB::Exception: Syntax error: failed at position 86 ('0.0269929') (line 3, col 56): 0.0269929  ...  0.0400366  -0.00303583
 -0.01164571]) as dist 
        FROM default.docs 
        ORDER BY dist 
        LIMIT 3
    
 FORMAT Native. Expected one of: token, DoubleColon, Comma, ClosingSquareBracket, OR, AND, BETWEEN, NOT BETWEEN, LIKE, ILIKE, NOT LIKE, NOT ILIKE, REGEXP, IN, NOT IN, GLOBAL IN, GLOBAL NOT IN, MOD, DIV, IS NULL, IS NOT NULL, alias, AS, end of query. (SYNTAX_ERROR), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::createDeprecated(String const&, int, bool) @ 0xddbad8d in /usr/bin/clickhouse
3. ./build/./src/Parsers/parseQuery.cpp:362: DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, String const&, bool, unsigned long, unsigned long) @ 0x19435880 in /usr/bin/clickhouse
4. ./build/./src/Parsers/parseQuery.cpp:374: DB::parseQuery(DB::IParser&, char const*, char const*, String const&, unsigned long, unsigned long) @ 0x19435900 in /usr/bin/clickhouse
5. ./build/./src/Interpreters/executeQuery.cpp:0: DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x17f5b76c in /usr/bin/clickhouse
6. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:612: DB::executeQuery(DB::ReadBuffer&, DB::WriteBuffer&, bool, std::shared_ptr<DB::Context>, std::function<void (DB::QueryResultDetails const&)>, std::optional<DB::FormatSettings> const&) @ 0x17f6a022 in /usr/bin/clickhouse
7. ./build/./contrib/llvm-project/libcxx/include/optional:260: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c4a8e0 in /usr/bin/clickhouse
8. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
9. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
10. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
12. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
13. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
14. ? @ 0x7f3895a94ac3 in ?
15. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.09 23:32:36.214495 [ 39 ] {24105692-8c81-4396-91de-a30fc5d168ca} <Error> executeQuery: Code: 62. DB::Exception: Not support more than one function among vector scan, text search, or hybrid search in one query now. (SYNTAX_ERROR) (version 23.3.2.1) (from 192.168.65.1:29609) (in query:  SELECT keywords, distance(embeddings, [-0.054709501564502716, -0.01140053290873766, -0.04685644805431366, 0.04971540346741676, 0.08216571062803268, -0.1349666714668274, -0.13401925563812256, -0.009401926770806313, 0.01849384605884552, 0.02598581463098526, -0.1388469636440277, -0.024734575301408768, 0.0010359049774706364, -0.09202125668525696, -0.04844799265265465, -0.10980517417192459, 0.05556179955601692, -0.06170753389596939, 0.001347975223325193, -0.017361456528306007, -0.026865243911743164, -0.03410956636071205, 0.044621944427490234, -0.031989116221666336, 0.09925514459609985, 0.08755580335855484, -0.01904907450079918, 0.005060505587607622, 0.032565437257289886, 0.02875930815935135, 0.047820184379816055, -0.039546843618154526, -0.07131914794445038, -0.0035022550728172064, 0.03659830987453461, 0.08840600401163101, -0.023179005831480026, 0.08227159082889557, 0.03170226514339447, 0.06605158001184464, 0.0506376251578331, 0.00977302249521017, 0.02003619633615017, 0.017574891448020935, -0.0356876477599144, 0.01713152416050434, -0.06364750117063522, -0.014249611645936966, -0.0733797550201416, -0.06545846164226532, 0.03440629318356514, -0.008226579986512661, -0.09031408280134201, 0.06707321107387543, 0.016287734732031822, -0.12059218436479568, 0.04471950605511665, -0.005161702632904053, 0.03172316774725914, -0.045614998787641525, -0.0395355150103569, -0.033068280667066574, -0.004188463557511568, 0.05503859743475914, -0.014147698879241943, 0.049888480454683304, -0.07202812284231186, -0.03261515125632286, 0.09038082510232925, -0.1295306235551834, -0.06133893132209778, 0.022782983258366585, 0.008405906148254871, -0.004292458761483431, -0.05958266928792, 0.014831112697720528, -0.09486810863018036, 0.01067100465297699, -0.043902914971113205, 0.05588260665535927, -0.028513215482234955, 0.06748427450656891, 0.04371466115117073, -0.046074431389570236, -0.1026984453201294, 0.017819546163082123, 0.014076552353799343, 0.06737488508224487, -0.0652647390961647, -0.06289109587669373, 0.019843101501464844, -0.007105599623173475, 0.02718888781964779, 0.018660737201571465, 0.08309122174978256, 0.03472788259387016, -0.12089452147483826, 0.04323890432715416, 0.006406539119780064, -0.018308745697140694, 0.03192800283432007, -0.05489920824766159, -0.05666154623031616, -0.04139045625925064, 0.04689552262425423, 0.06613337248563766, 0.025467531755566597, -0.016717206686735153, 0.0010192295303568244, -0.017689179629087448, 0.0002835413906723261, 0.00033809299929998815, 0.00212353584356606, 0.04636271297931671, 0.017374685034155846, 0.03218512237071991, 0.04967133328318596, 0.0017892566975206137, -0.015652531757950783, -0.039951033890247345, -0.006801650859415531, -0.0836016982793808, 0.011986448429524899, 0.02348700538277626, -0.053180474787950516, -0.042024463415145874, 0.059211499989032745, -0.008331592194736004, 0.037564001977443695, -0.006923378445208073, -0.021546488627791405, 0.006343455519527197, -0.011014246381819248, -0.018998902291059494, -0.0059452238492667675, -0.012741374783217907, 0.015731852501630783, 0.009364715777337551, -0.006213606335222721, 0.01250496320426464, 0.010317860171198845, -0.07298292219638824, -0.027248365804553032, 0.05004489794373512, -0.03448612615466118, -0.033633384853601456, -0.03874223306775093, 0.021618520841002464, -0.02278466895222664, -0.009682835079729557, 0.07510213553905487, 0.03078361041843891, 0.0061830878257751465, -0.029686518013477325, -0.00016941614740062505, 0.014803263358771801, -0.001435809419490397, -0.016359524801373482, 0.01871819980442524, 0.027206601575016975, -0.01782826893031597, 0.005074284505099058, -0.03510405495762825, -0.02885357290506363, -0.007172154262661934, 0.04054395481944084, 0.01824050582945347, 0.06246767193078995, 0.026149678975343704, -0.02749113366007805, 0.015545918606221676, 0.0930979996919632, -0.00990181416273117, 0.0008413656614720821, 0.04606097936630249, 0.004259091801941395, 0.04652789607644081, -0.023790650069713593, -0.01470326166599989, -0.0002751360589172691, 0.061247047036886215, 0.009872965514659882, -0.0052938940934836864, 0.045654699206352234, 0.020236076787114143, -0.018131515011191368, -0.011328248307108879, -0.048109021037817, 0.019833877682685852, 0.04195738211274147, 0.03978081792593002, 0.03429313749074936, -0.03549719229340553, 0.07073580473661423, -0.021657953038811684, -0.036820441484451294, -0.025706207379698753, 0.003769057337194681, 0.03290987387299538, -0.021520761772990227, -0.001244714600034058, 0.01851598173379898, -0.023915134370326996, 0.08697444200515747, -0.010729770176112652, 0.011199716478586197, 0.03421718254685402, -0.034286998212337494, -0.002492978936061263, -0.0434107631444931, 0.04791213199496269, -0.0029480853118002415, 0.06704608350992203, 0.010676072910428047, 0.012552446685731411, -0.013332251459360123, -0.006054611410945654, -0.02518065832555294, 0.03719474375247955, -0.038566041737794876, -0.0018783709965646267, 0.036744456738233566, -0.008840530179440975, 0.07187488675117493, -0.04724486544728279, -0.051086366176605225, 0.04570920392870903, -0.01996835321187973, -0.038881853222846985, 0.05775464326143265, 0.015003347769379616, 0.05435073375701904, -0.07032054662704468, -0.013354523107409477, -0.008694893680512905, -0.022983577102422714, 0.027126075699925423, 0.015042219310998917, 0.008179009892046452, -0.008917582221329212, 0.002796618500724435, -0.02797548472881317, 0.015716517344117165, -0.042170450091362, -0.08211558312177658, -0.009833128191530704, -0.02315496653318405, -0.01306177768856287, -0.0481235608458519, -0.045319829136133194, -0.04487141594290733, -0.02241307683289051, 0.023200681433081627, -0.005867185536772013, 0.03130028024315834, 0.03943358361721039, -0.026955949142575264, 0.033198583871126175, -0.031935930252075195, -0.0025374109391123056, -0.002570732729509473, -0.02277042530477047, -0.009559635072946548, 0.018951404839754105, -0.019275009632110596, 0.04509629309177399, -0.01915431208908558, -0.0065764435566961765, 0.021455422043800354, -0.043456319719552994, -0.031406696885824203, 0.027184294536709785, 0.009223591536283493, 0.03695548325777054, 0.01764756068587303, -0.026085639372467995, 0.02429705485701561, 0.00218434096314013, -0.007351878564804792, -0.04368771240115166, 0.026208870112895966, -0.0034740364644676447, -0.025915373116731644, -0.03597022965550423, -0.025545161217451096, 0.0004502756637521088, 0.004564299248158932, 0.07861004024744034, -0.0343903973698616, -0.03424029424786568, -0.03236137703061104, 0.003401040332391858, -0.0044810594990849495, -0.007783303968608379, 0.036418311297893524, -0.02704336866736412, -0.024077165871858597, -0.011084716767072678, -0.021829312667250633, 0.053125154227018356, -0.026200810447335243, 0.06132502481341362, -0.02846347540616989, -0.03386138752102852, 0.018768660724163055, 0.08180095255374908, -0.01919594779610634, -0.017323428764939308, 0.024427736178040504, 0.04898810759186745, -0.002960076555609703, -0.01962905377149582, -0.0064643691293895245, -0.01617572456598282, 0.0023009576834738255, -0.015877416357398033, 0.007489817216992378, 0.033815376460552216, -0.03028167597949505, -0.016456319019198418, -0.028075817972421646, -0.024174634367227554, -0.015164685435593128, 0.06741341203451157, -0.015116345137357712, -0.04573167487978935, 0.047970160841941833, -0.0012420807033777237, 0.036831047385931015, -0.0395653210580349, -0.03163842484354973, 0.028042873367667198, 0.027342960238456726, 0.011133457534015179, -0.047822773456573486, -0.03316524624824524, -0.031775061041116714, 0.002394302049651742, -0.016439370810985565, 0.038668595254421234, 0.015179043635725975, -0.013027926906943321, 0.03294368088245392, -0.03967384621500969, 0.026951700448989868, -0.031578969210386276, -0.041893623769283295, 0.02732386812567711, -0.020657146349549294, 0.01893686316907406, 0.008722198195755482, 0.03686118125915527, 0.031661368906497955, 0.022885864600539207, -0.0035794556606560946, 0.015744833275675774, -0.030174070969223976, 0.016661878675222397, 0.02336777001619339, 0.0442887507379055, -0.02484680712223053, 0.04143013805150986, -0.01763560250401497, 0.015008012764155865, 0.06165551021695137, -0.005899050738662481, 0.018177157267928123, -0.039047401398420334, -0.007030957844108343, -0.03193063661456108, -0.006552737206220627, -0.03813529014587402, 0.013702845200896263, 0.033049315214157104, -0.04094090312719345, -0.02152739278972149, 0.02230626530945301, 0.023013383150100708, 0.011631404981017113, -0.0072741275653243065, -0.0020816109608858824, 0.0421556793153286, -0.02282664366066456, -0.018315820023417473, -0.045428238809108734, 0.022229522466659546, -0.0003347042656969279, -0.011358332820236683, 0.024712800979614258, 0.0015966473147273064, 0.012911024503409863, -0.008814632892608643, -0.0075928526930511, -0.02889179438352585, -0.00966524239629507, -0.013739915564656258, 0.0025586013216525316, -0.0031060671899467707, 0.06102792173624039, -0.010429968126118183, -0.011057352647185326, 0.0208722073584795, 0.032705824822187424, -0.005285733379423618, -0.02256804332137108, 0.020910052582621574, 0.029592281207442284, 0.0014059595996513963, -0.06321364641189575, -0.018159301951527596, -0.024461211636662483, -0.024065516889095306, -0.011913631111383438, 0.001820139354094863, 0.044027868658304214, 0.021519262343645096, 0.005666842684149742, 0.00431477464735508, 0.0004081054648850113, 0.0025268772151321173, 0.009303932078182697, -0.017492352053523064, 0.01762690208852291, 0.026891477406024933, 0.024366101250052452, 0.03984601050615311, 0.01892358623445034, -0.0129581019282341, 0.02337414212524891, -0.04290643334388733, 0.008060773834586143, -0.003246001433581114, 0.048055991530418396, -0.004720834083855152, 0.046503398567438126, 0.009253188036382198, 0.016117842867970467, -0.0072044190019369125, 0.04110826551914215, -0.0005723505164496601, -0.03037714585661888, 0.01448829099535942, -0.020688500255346298, -0.06355366855859756, 0.028049161657691002, -0.013415288180112839, 0.01986072026193142, -0.008779465220868587, 0.03577302396297455, 0.004531809128820896, 0.05366972088813782, 0.030489955097436905, 0.03416856378316879, -0.04861097410321236, 0.025284655392169952, -0.020449241623282433, -0.00755622424185276, -0.050133734941482544, 0.016933852806687355, -0.027242247015237808, -0.04754848778247833, -0.039075132459402084, -0.018372880294919014, -0.003624562406912446, 0.0164395272731781, 0.015332020819187164, -0.02755153365433216, 0.0052607194520533085, 0.0001510400470579043, 0.0005005892016924918, -0.02292679250240326, 0.006588914897292852, -0.018125981092453003, 0.03843243047595024, -0.007880113087594509, -0.05490585044026375, 0.0091180931776762, 0.01107700914144516, -0.005435259081423283, -0.005446591414511204, 0.06730006635189056, 0.015598941594362259, -0.018444376066327095, 0.015574421733617783, 0.014092897064983845, -0.019987458363175392, -0.015170816332101822, 0.028717394918203354, 0.03519538789987564, -0.008856410160660744, 0.0014555620728060603, 0.022532586008310318, 0.06785011291503906, 0.029241863638162613, 0.017484253272414207, -0.031215887516736984, 0.006856714375317097, 0.002423869213089347, -0.008479000069200993, 0.03131648153066635, -0.007932107895612717, 0.04018464684486389, 0.011096435599029064, -0.009221120737493038, -0.005872348789125681, -0.06136782839894295, -0.07268162816762924, -0.03978222981095314, 0.00863172858953476, -0.020766302943229675, 0.051678456366062164, -0.01806575059890747, 0.01279244665056467, 0.0029516040813177824, 0.02475128322839737, -0.018354307860136032, -0.03832907974720001, -0.010945572517812252, -0.026084231212735176, -0.009710637852549553, 0.01724507100880146, 0.04923590272665024, 0.027797361835837364, -0.00021806632867082953, -0.003793813055381179, 0.00010499229392735288, 0.0023873290047049522, 0.004449470434337854, 0.01727139763534069, -0.058171775192022324, -0.016210919246077538, 0.013973775319755077, 0.0140053890645504, 0.006876390893012285, -0.028285034000873566, 0.03849504515528679, -0.006646092515438795, -0.013892785646021366, 0.01112508587539196, -0.017500055953860283, -0.0064326925203204155, -0.021833809092640877, 0.01756235584616661, -0.008905680850148201, -0.027720633894205093, -0.02008328028023243, 0.0005659869057126343, -0.007959157228469849, -0.020803241059184074, 0.02781824767589569, -0.016062216833233833, -0.032152481377124786, 0.004641611594706774, 0.02191663533449173, 0.0019042737549170852, -0.03605389595031738, 0.04925749823451042, 0.004972464870661497, 0.02595127746462822, -0.027783116325736046, -0.01512982975691557, 0.002037325408309698, -0.002132588066160679, -0.010198940522968769, -0.028411878272891045, 0.05939536169171333, 0.0033367981668561697, -0.008039293810725212, 0.008348781615495682, 0.05829869583249092, -0.00846466887742281, -0.0008345835958607495, 0.02082507126033306, -0.017918575555086136, 0.056456416845321655, 0.04322754964232445, 0.05260603874921799, 0.004636149853467941, 0.005891130305826664, 0.01753859408199787, 0.0020803867373615503, 0.036048926413059235, -0.005524960346519947, -0.00013746072363574058, -0.03691486269235611, 0.021523578092455864, -0.02319522760808468, -0.010756541043519974, -0.023410312831401825, 0.044692590832710266, 0.02728564292192459, -0.05273378640413284, -0.012577353976666927, -0.03722895309329033, 0.033826425671577454, 0.013374839909374714, 0.02222936600446701, -0.0429072231054306, 0.034207362681627274, -0.028798187151551247, -0.00622613774612546, -0.04810028150677681, 0.007975215092301369, 0.014791564084589481, 0.0009717352804727852, -0.007038517855107784, -0.02635100483894348, -0.019040750339627266, 0.003383474890142679, 0.031377244740724564, 0.021253271028399467, 0.031688034534454346, -0.015624145977199078, -0.03954055532813072, -0.004343778360635042, 0.03234163299202919, 0.005028770305216312, 0.030007170513272285, 0.015348545275628567, 0.0026580006815493107, -0.0056827920489013195, -0.014793433248996735, 0.007282676175236702, 0.0057312436401844025, -0.04361613094806671, -0.0017843664390966296, 0.0024479753337800503, 0.014479710720479488, 0.033219173550605774, -0.04042709991335869, 0.03758479282259941, 0.008650027215480804, 0.00839398056268692, -0.004225233104079962, -0.00112934282515198, -0.005427602678537369, -0.031024973839521408, 0.007457986008375883, -0.00974322110414505, -0.015619518235325813, -0.02194979414343834, 0.01495722308754921, -0.0031245171558111906, -0.021351708099246025, -0.007948565296828747, -0.028666948899626732, -0.017462609335780144, 0.029959823936223984, 0.048933517187833786, -0.030154414474964142, 0.0006388454348780215, -0.002048282418400049, -0.013381058350205421, -0.03350184112787247, 0.01602424867451191, -0.02253868244588375, 0.0016415659338235855, 0.00244213012047112, 0.03285190463066101, 0.017529591917991638, -0.05539570748806, -0.021351272240281105, -0.006466594059020281, 0.03699710592627525, -0.013179765082895756, -0.014310368336737156, -0.003991161938756704, 0.018856292590498924, 3.166495662298985e-05, 0.009686719626188278, 0.010406000539660454, 0.009904421865940094, 0.0014900820096954703, 0.014392036944627762, 0.030263029038906097, -0.015364442020654678, -0.01327401865273714, -0.019867710769176483, -0.005848584230989218, -0.009582345373928547, 0.009114044718444347, 0.0017719812458381057, 0.011364423669874668, 0.0419878326356411, -0.017080742865800858, -0.00573530001565814, 0.01722508855164051, 0.01751641370356083, -0.019351307302713394, 0.008514348417520523, -0.008807436563074589, 0.024498503655195236, 0.039364077150821686, 0.012447078712284565, 0.011648332700133324, 0.013809761963784695, 0.03484039753675461, 0.02731071040034294, -0.001066245255060494, -0.03351528197526932, 0.014987058006227016, 0.04685211926698685, 0.05745712295174599, 0.03567846864461899, -0.028210550546646118, -0.002727360697463155, 0.02383657917380333, 0.04426096752285957, 0.0066785989329218864, -0.02750321477651596, -0.022865623235702515, 0.014086362905800343, 0.006867502350360155, -0.03435247018933296, 0.0025408021174371243, -0.011401426047086716, -0.030537351965904236, -0.0022367548663169146, 0.01097579300403595, 0.012530098669230938, -0.017742397263646126, -0.024792177602648735, 0.035013824701309204, 0.010281872935593128, -0.0269796010106802, -0.0019028580281883478, 0.006914982106536627, 0.027129849418997765, -0.02002340741455555, -0.050581637769937515, -0.021133271977305412, 0.0030269878916442394, 0.030658269301056862, 0.018698077648878098, -0.020305665209889412, 0.013470485806465149, 0.009377730078995228, -0.02110172063112259, -0.004118029028177261, -0.02011689357459545, -0.014403353445231915, 0.07023388147354126, -0.030402345582842827, 0.03250748664140701, 0.013032080605626106, -0.036909740418195724, -0.03817867860198021, 0.04086191952228546, -0.01398678869009018, 0.0019419594900682569, 0.03448404371738434, -0.02472657337784767, -0.0009978347225114703, -0.0002461269323248416, -0.03507586568593979, 0.02563597448170185, 0.03407193347811699, 0.033915527164936066, 0.020277975127100945, 0.024231871590018272, -0.023791037499904633, -0.01302803959697485, 0.019273823127150536, -0.0011320769554004073, -0.0269783828407526, 0.0383497029542923, 0.015464961528778076, 0.00307412794791162, 0.002601179527118802, -0.027242079377174377, 0.0026614798698574305, 0.007633108180016279, 0.031223898753523827, 0.03857453539967537, -0.048687759786844254, 0.018361829221248627, 0.011815722100436687, -0.0028511846903711557, 0.017333056777715683, -0.015679217875003815, -0.03622012957930565, 0.02395184338092804, 0.03851764276623726, -0.009105953387916088, -0.018574053421616554, 0.013174222782254219, -0.04972304403781891, -0.00954792182892561, -0.007331135217100382, -0.00266282819211483, 0.03257693350315094, 0.025117894634604454, 0.011455012485384941, -0.007176162675023079, -0.03537435084581375, -0.022246502339839935, -0.014702481217682362, 0.01277997437864542, 0.020537830889225006, 0.012569240294396877, 0.015214262530207634, 0.002327859867364168, -0.010778321884572506, -0.030334634706377983, 0.01861468143761158, -0.028646918013691902, 0.006791211199015379, -0.023808225989341736, 0.0034277013037353754, 0.009042811580002308, 0.055577848106622696, 0.027081720530986786, -0.01849096082150936, -0.007526951842010021, -0.013719698414206505, -0.022472871467471123, -0.01449180580675602, 0.0010419513564556837, -0.012721680104732513, -0.03233366832137108, -0.013413011096417904, -0.014533163979649544, -0.004161523189395666, -0.005878159776329994, 0.0349099338054657, 0.009410942904651165, 0.02540871687233448, -0.016245901584625244, 0.03431931510567665, -0.018823223188519478, 0.04059894010424614, 0.03312565013766289, -0.023447612300515175, 0.002998290816321969, -0.03290458396077156, 0.021818464621901512, 0.021031109616160393, -0.020061472430825233, -0.021203383803367615, -0.00188209128100425, -0.013892988674342632, -0.008797937072813511, -0.02880481630563736, 0.02600199542939663, 0.009929348714649677, -0.015936631709337234, -0.036946505308151245, 0.043270133435726166, 0.023727089166641235, -0.0009725766140036285, 0.014700405299663544, -0.005329370964318514, 0.04005572944879532, 0.0317380391061306, -0.01172562874853611, 0.023834630846977234, 0.013467318378388882, 0.002570684067904949, 0.048699233680963516, -0.012680388055741787, -0.03831471875309944, 0.0027039465494453907, -0.00897977501153946, 0.009983769617974758, 0.032473959028720856, -0.02991635724902153, 0.0035958101507276297, 0.026289913803339005, 0.004758218768984079, 0.04051612690091133, -0.005917872302234173, 0.0219340268522501, -0.003340751165524125, 0.043364349752664566, 0.0053485967218875885, 0.02287224680185318, -0.02739114500582218, -0.008060675114393234, -0.013308394700288773, -0.013005648739635944, 0.009243522770702839, -0.025104496628046036, 0.015344636514782906, 0.015357611700892448, 0.003631098661571741, 0.022337229922413826, -0.016963621601462364, -0.021090872585773468, -0.03464943543076515, 0.01847870834171772, -0.0337042510509491, 0.00532348919659853, 0.016182852908968925, -0.007375890389084816, -0.0052016498520970345, -0.0044548469595611095, 0.009907911531627178, -0.028827061876654625, 0.023664701730012894, -0.010769080370664597, -0.029915576800704002, -0.015189843252301216, 0.019975950941443443, -0.01182220783084631, 0.014776511117815971, 0.0233349297195673, -0.003478294238448143, -0.0007377995643764734, -0.0003990570839960128, 0.005619866773486137, -0.004910904914140701, -0.03428364917635918, -0.008263026364147663, 0.013315176591277122, 0.015110727399587631, -0.00045751428115181625, -0.006802466232329607, -0.0038890924770385027, -0.0517420656979084, 0.009156305342912674, -0.01880919747054577, 0.029547054320573807, 0.001546181389130652, -0.01604904793202877, 0.0022612714674323797, 0.029258832335472107, 0.006139978766441345, -0.04474477842450142, 0.015664706006646156, 0.000237004627706483, 0.0007993717445060611, -0.007437430787831545, 0.008721165359020233, 0.0006416058749891818, -0.029819821938872337, -0.0034735784865915775, -0.002538805827498436, -0.007288678083568811, 0.0020404341630637646, 0.020437901839613914, -0.019092347472906113, 0.02728494070470333, 0.013598702847957611, 0.015327753499150276, -0.0173636507242918, -0.007287175860255957, -0.004865715280175209, -0.00470965588465333, 0.021588146686553955, 0.023452183231711388, -0.03536471351981163, -0.008309290744364262, -0.013360323384404182, 0.04137524589896202, 0.016155149787664413, 0.011368847452104092, 0.022875254973769188, -0.010130777955055237, 0.007072916254401207, 0.04069557413458824, -0.03369911015033722, -0.003495128359645605, 0.0030075267422944307, 0.016987185925245285, 0.050108034163713455, -0.016806650906801224, -0.0012647529365494847, -0.013608145527541637, 5.557327676797286e-05, 0.028649061918258667, -0.035884685814380646, -0.0038923381362110376, -0.012150679714977741, 0.010018451139330864, -0.008231918327510357, 0.01154241617769003, -0.0010152502218261361, 0.01527396310120821, -0.0005139559507369995, -0.0060277581214904785, -0.018756654113531113, 0.0481371209025383, 0.04305757209658623, 0.02883579581975937, 0.034510500729084015, -0.015725938603281975, 0.027074947953224182, 0.05209507420659065, 0.020675232633948326, 0.023215096443891525, 0.014972509816288948, 0.01016004104167223, -0.04493414983153343, -0.01071860920637846, 0.007120100315660238, -0.004026686307042837, -0.00820209737867117, -0.00845356099307537, -0.018101133406162262, 0.0020379899069666862, -0.021577194333076477, -0.005878139287233353, 0.004604856017976999, 0.000718490919098258, 0.024911917746067047, -0.062402963638305664, -0.005924939643591642, 0.005786644294857979, 0.024247102439403534, 0.007021712604910135, -0.02324746735394001, -0.0049596731550991535, 0.010584762319922447, 0.012080750428140163, -0.008010433055460453, 0.008883871138095856, -0.005358126480132341, -0.041087742894887924, 0.005555740557610989, -0.031164737418293953, 0.01126695703715086, 0.02031751349568367, -0.0005686284857802093, -0.011367376893758774]) as dist FROM default.keywords WHERE distance(embeddings, [-0.054709501564502716, -0.01140053290873766, -0.04685644805431366, 0.04971540346741676, 0.08216571062803268, -0.1349666714668274, -0.13401925563812256, -0.009401926770806313, 0.01849384605884552, 0.02598581463098526, -0.1388469636440277, -0.024734575301408768, 0.0010359049774706364, -0.09202125668525696, -0.04844799265265465, -0.10980517417192459, 0.05556179955601692, -0.06170753389596939, 0.001347975223325193, -0.017361456528306007, -0.026865243911743164, -0.03410956636071205, 0.044621944427490234, -0.031989116221666336, 0.09925514459609985, 0.08755580335855484, -0.01904907450079918, 0.005060505587607622, 0.032565437257289886, 0.02875930815935135, 0.047820184379816055, -0.039546843618154526, -0.07131914794445038, -0.0035022550728172064, 0.03659830987453461, 0.08840600401163101, -0.023179005831480026, 0.08227159082889557, 0.03170226514339447, 0.06605158001184464, 0.0506376251578331, 0.00977302249521017, 0.02003619633615017, 0.017574891448020935, -0.0356876477599144, 0.01713152416050434, -0.06364750117063522, -0.014249611645936966, -0.0733797550201416, -0.06545846164226532, 0.03440629318356514, -0.008226579986512661, -0.09031408280134201, 0.06707321107387543, 0.016287734732031822, -0.12059218436479568, 0.04471950605511665, -0.005161702632904053, 0.03172316774725914, -0.045614998787641525, -0.0395355150103569, -0.033068280667066574, -0.004188463557511568, 0.05503859743475914, -0.014147698879241943, 0.049888480454683304, -0.07202812284231186, -0.03261515125632286, 0.09038082510232925, -0.1295306235551834, -0.06133893132209778, 0.022782983258366585, 0.008405906148254871, -0.004292458761483431, -0.05958266928792, 0.014831112697720528, -0.09486810863018036, 0.01067100465297699, -0.043902914971113205, 0.05588260665535927, -0.028513215482234955, 0.06748427450656891, 0.04371466115117073, -0.046074431389570236, -0.1026984453201294, 0.017819546163082123, 0.014076552353799343, 0.06737488508224487, -0.0652647390961647, -0.06289109587669373, 0.019843101501464844, -0.007105599623173475, 0.02718888781964779, 0.018660737201571465, 0.08309122174978256, 0.03472788259387016, -0.12089452147483826, 0.04323890432715416, 0.006406539119780064, -0.018308745697140694, 0.03192800283432007, -0.05489920824766159, -0.05666154623031616, -0.04139045625925064, 0.04689552262425423, 0.06613337248563766, 0.025467531755566597, -0.016717206686735153, 0.0010192295303568244, -0.017689179629087448, 0.0002835413906723261, 0.00033809299929998815, 0.00212353584356606, 0.04636271297931671, 0.017374685034155846, 0.03218512237071991, 0.04967133328318596, 0.0017892566975206137, -0.015652531757950783, -0.039951033890247345, -0.006801650859415531, -0.0836016982793808, 0.011986448429524899, 0.02348700538277626, -0.053180474787950516, -0.042024463415145874, 0.059211499989032745, -0.008331592194736004, 0.037564001977443695, -0.006923378445208073, -0.021546488627791405, 0.006343455519527197, -0.011014246381819248, -0.018998902291059494, -0.0059452238492667675, -0.012741374783217907, 0.015731852501630783, 0.009364715777337551, -0.006213606335222721, 0.01250496320426464, 0.010317860171198845, -0.07298292219638824, -0.027248365804553032, 0.05004489794373512, -0.03448612615466118, -0.033633384853601456, -0.03874223306775093, 0.021618520841002464, -0.02278466895222664, -0.009682835079729557, 0.07510213553905487, 0.03078361041843891, 0.0061830878257751465, -0.029686518013477325, -0.00016941614740062505, 0.014803263358771801, -0.001435809419490397, -0.016359524801373482, 0.01871819980442524, 0.027206601575016975, -0.01782826893031597, 0.005074284505099058, -0.03510405495762825, -0.02885357290506363, -0.007172154262661934, 0.04054395481944084, 0.01824050582945347, 0.06246767193078995, 0.026149678975343704, -0.02749113366007805, 0.015545918606221676, 0.0930979996919632, -0.00990181416273117, 0.0008413656614720821, 0.04606097936630249, 0.004259091801941395, 0.04652789607644081, -0.023790650069713593, -0.01470326166599989, -0.0002751360589172691, 0.061247047036886215, 0.009872965514659882, -0.0052938940934836864, 0.045654699206352234, 0.020236076787114143, -0.018131515011191368, -0.011328248307108879, -0.048109021037817, 0.019833877682685852, 0.04195738211274147, 0.03978081792593002, 0.03429313749074936, -0.03549719229340553, 0.07073580473661423, -0.021657953038811684, -0.036820441484451294, -0.025706207379698753, 0.003769057337194681, 0.03290987387299538, -0.021520761772990227, -0.001244714600034058, 0.01851598173379898, -0.023915134370326996, 0.08697444200515747, -0.010729770176112652, 0.011199716478586197, 0.03421718254685402, -0.034286998212337494, -0.002492978936061263, -0.0434107631444931, 0.04791213199496269, -0.0029480853118002415, 0.06704608350992203, 0.010676072910428047, 0.012552446685731411, -0.013332251459360123, -0.006054611410945654, -0.02518065832555294, 0.03719474375247955, -0.038566041737794876, -0.0018783709965646267, 0.036744456738233566, -0.008840530179440975, 0.07187488675117493, -0.04724486544728279, -0.051086366176605225, 0.04570920392870903, -0.01996835321187973, -0.038881853222846985, 0.05775464326143265, 0.015003347769379616, 0.05435073375701904, -0.07032054662704468, -0.013354523107409477, -0.008694893680512905, -0.022983577102422714, 0.027126075699925423, 0.015042219310998917, 0.008179009892046452, -0.008917582221329212, 0.002796618500724435, -0.02797548472881317, 0.015716517344117165, -0.042170450091362, -0.08211558312177658, -0.009833128191530704, -0.02315496653318405, -0.01306177768856287, -0.0481235608458519, -0.045319829136133194, -0.04487141594290733, -0.02241307683289051, 0.023200681433081627, -0.005867185536772013, 0.03130028024315834, 0.03943358361721039, -0.026955949142575264, 0.033198583871126175, -0.031935930252075195, -0.0025374109391123056, -0.002570732729509473, -0.02277042530477047, -0.009559635072946548, 0.018951404839754105, -0.019275009632110596, 0.04509629309177399, -0.01915431208908558, -0.0065764435566961765, 0.021455422043800354, -0.043456319719552994, -0.031406696885824203, 0.027184294536709785, 0.009223591536283493, 0.03695548325777054, 0.01764756068587303, -0.026085639372467995, 0.02429705485701561, 0.00218434096314013, -0.007351878564804792, -0.04368771240115166, 0.026208870112895966, -0.0034740364644676447, -0.025915373116731644, -0.03597022965550423, -0.025545161217451096, 0.0004502756637521088, 0.004564299248158932, 0.07861004024744034, -0.0343903973698616, -0.03424029424786568, -0.03236137703061104, 0.003401040332391858, -0.0044810594990849495, -0.007783303968608379, 0.036418311297893524, -0.02704336866736412, -0.024077165871858597, -0.011084716767072678, -0.021829312667250633, 0.053125154227018356, -0.026200810447335243, 0.06132502481341362, -0.02846347540616989, -0.03386138752102852, 0.018768660724163055, 0.08180095255374908, -0.01919594779610634, -0.017323428764939308, 0.024427736178040504, 0.04898810759186745, -0.002960076555609703, -0.01962905377149582, -0.0064643691293895245, -0.01617572456598282, 0.0023009576834738255, -0.015877416357398033, 0.007489817216992378, 0.033815376460552216, -0.03028167597949505, -0.016456319019198418, -0.028075817972421646, -0.024174634367227554, -0.015164685435593128, 0.06741341203451157, -0.015116345137357712, -0.04573167487978935, 0.047970160841941833, -0.0012420807033777237, 0.036831047385931015, -0.0395653210580349, -0.03163842484354973, 0.028042873367667198, 0.027342960238456726, 0.011133457534015179, -0.047822773456573486, -0.03316524624824524, -0.031775061041116714, 0.002394302049651742, -0.016439370810985565, 0.038668595254421234, 0.015179043635725975, -0.013027926906943321, 0.03294368088245392, -0.03967384621500969, 0.026951700448989868, -0.031578969210386276, -0.041893623769283295, 0.02732386812567711, -0.020657146349549294, 0.01893686316907406, 0.008722198195755482, 0.03686118125915527, 0.031661368906497955, 0.022885864600539207, -0.0035794556606560946, 0.015744833275675774, -0.030174070969223976, 0.016661878675222397, 0.02336777001619339, 0.0442887507379055, -0.02484680712223053, 0.04143013805150986, -0.01763560250401497, 0.015008012764155865, 0.06165551021695137, -0.005899050738662481, 0.018177157267928123, -0.039047401398420334, -0.007030957844108343, -0.03193063661456108, -0.006552737206220627, -0.03813529014587402, 0.013702845200896263, 0.033049315214157104, -0.04094090312719345, -0.02152739278972149, 0.02230626530945301, 0.023013383150100708, 0.011631404981017113, -0.0072741275653243065, -0.0020816109608858824, 0.0421556793153286, -0.02282664366066456, -0.018315820023417473, -0.045428238809108734, 0.022229522466659546, -0.0003347042656969279, -0.011358332820236683, 0.024712800979614258, 0.0015966473147273064, 0.012911024503409863, -0.008814632892608643, -0.0075928526930511, -0.02889179438352585, -0.00966524239629507, -0.013739915564656258, 0.0025586013216525316, -0.0031060671899467707, 0.06102792173624039, -0.010429968126118183, -0.011057352647185326, 0.0208722073584795, 0.032705824822187424, -0.005285733379423618, -0.02256804332137108, 0.020910052582621574, 0.029592281207442284, 0.0014059595996513963, -0.06321364641189575, -0.018159301951527596, -0.024461211636662483, -0.024065516889095306, -0.011913631111383438, 0.001820139354094863, 0.044027868658304214, 0.021519262343645096, 0.005666842684149742, 0.00431477464735508, 0.0004081054648850113, 0.0025268772151321173, 0.009303932078182697, -0.017492352053523064, 0.01762690208852291, 0.026891477406024933, 0.024366101250052452, 0.03984601050615311, 0.01892358623445034, -0.0129581019282341, 0.02337414212524891, -0.04290643334388733, 0.008060773834586143, -0.003246001433581114, 0.048055991530418396, -0.004720834083855152, 0.046503398567438126, 0.009253188036382198, 0.016117842867970467, -0.0072044190019369125, 0.04110826551914215, -0.0005723505164496601, -0.03037714585661888, 0.01448829099535942, -0.020688500255346298, -0.06355366855859756, 0.028049161657691002, -0.013415288180112839, 0.01986072026193142, -0.008779465220868587, 0.03577302396297455, 0.004531809128820896, 0.05366972088813782, 0.030489955097436905, 0.03416856378316879, -0.04861097410321236, 0.025284655392169952, -0.020449241623282433, -0.00755622424185276, -0.050133734941482544, 0.016933852806687355, -0.027242247015237808, -0.04754848778247833, -0.039075132459402084, -0.018372880294919014, -0.003624562406912446, 0.0164395272731781, 0.015332020819187164, -0.02755153365433216, 0.0052607194520533085, 0.0001510400470579043, 0.0005005892016924918, -0.02292679250240326, 0.006588914897292852, -0.018125981092453003, 0.03843243047595024, -0.007880113087594509, -0.05490585044026375, 0.0091180931776762, 0.01107700914144516, -0.005435259081423283, -0.005446591414511204, 0.06730006635189056, 0.015598941594362259, -0.018444376066327095, 0.015574421733617783, 0.014092897064983845, -0.019987458363175392, -0.015170816332101822, 0.028717394918203354, 0.03519538789987564, -0.008856410160660744, 0.0014555620728060603, 0.022532586008310318, 0.06785011291503906, 0.029241863638162613, 0.017484253272414207, -0.031215887516736984, 0.006856714375317097, 0.002423869213089347, -0.008479000069200993, 0.03131648153066635, -0.007932107895612717, 0.04018464684486389, 0.011096435599029064, -0.009221120737493038, -0.005872348789125681, -0.06136782839894295, -0.07268162816762924, -0.03978222981095314, 0.00863172858953476, -0.020766302943229675, 0.051678456366062164, -0.01806575059890747, 0.01279244665056467, 0.0029516040813177824, 0.02475128322839737, -0.018354307860136032, -0.03832907974720001, -0.010945572517812252, -0.026084231212735176, -0.009710637852549553, 0.01724507100880146, 0.04923590272665024, 0.027797361835837364, -0.00021806632867082953, -0.003793813055381179, 0.00010499229392735288, 0.0023873290047049522, 0.004449470434337854, 0.01727139763534069, -0.058171775192022324, -0.016210919246077538, 0.013973775319755077, 0.0140053890645504, 0.006876390893012285, -0.028285034000873566, 0.03849504515528679, -0.006646092515438795, -0.013892785646021366, 0.01112508587539196, -0.017500055953860283, -0.0064326925203204155, -0.021833809092640877, 0.01756235584616661, -0.008905680850148201, -0.027720633894205093, -0.02008328028023243, 0.0005659869057126343, -0.007959157228469849, -0.020803241059184074, 0.02781824767589569, -0.016062216833233833, -0.032152481377124786, 0.004641611594706774, 0.02191663533449173, 0.0019042737549170852, -0.03605389595031738, 0.04925749823451042, 0.004972464870661497, 0.02595127746462822, -0.027783116325736046, -0.01512982975691557, 0.002037325408309698, -0.002132588066160679, -0.010198940522968769, -0.028411878272891045, 0.05939536169171333, 0.0033367981668561697, -0.008039293810725212, 0.008348781615495682, 0.05829869583249092, -0.00846466887742281, -0.0008345835958607495, 0.02082507126033306, -0.017918575555086136, 0.056456416845321655, 0.04322754964232445, 0.05260603874921799, 0.004636149853467941, 0.005891130305826664, 0.01753859408199787, 0.0020803867373615503, 0.036048926413059235, -0.005524960346519947, -0.00013746072363574058, -0.03691486269235611, 0.021523578092455864, -0.02319522760808468, -0.010756541043519974, -0.023410312831401825, 0.044692590832710266, 0.02728564292192459, -0.05273378640413284, -0.012577353976666927, -0.03722895309329033, 0.033826425671577454, 0.013374839909374714, 0.02222936600446701, -0.0429072231054306, 0.034207362681627274, -0.028798187151551247, -0.00622613774612546, -0.04810028150677681, 0.007975215092301369, 0.014791564084589481, 0.0009717352804727852, -0.007038517855107784, -0.02635100483894348, -0.019040750339627266, 0.003383474890142679, 0.031377244740724564, 0.021253271028399467, 0.031688034534454346, -0.015624145977199078, -0.03954055532813072, -0.004343778360635042, 0.03234163299202919, 0.005028770305216312, 0.030007170513272285, 0.015348545275628567, 0.0026580006815493107, -0.0056827920489013195, -0.014793433248996735, 0.007282676175236702, 0.0057312436401844025, -0.04361613094806671, -0.0017843664390966296, 0.0024479753337800503, 0.014479710720479488, 0.033219173550605774, -0.04042709991335869, 0.03758479282259941, 0.008650027215480804, 0.00839398056268692, -0.004225233104079962, -0.00112934282515198, -0.005427602678537369, -0.031024973839521408, 0.007457986008375883, -0.00974322110414505, -0.015619518235325813, -0.02194979414343834, 0.01495722308754921, -0.0031245171558111906, -0.021351708099246025, -0.007948565296828747, -0.028666948899626732, -0.017462609335780144, 0.029959823936223984, 0.048933517187833786, -0.030154414474964142, 0.0006388454348780215, -0.002048282418400049, -0.013381058350205421, -0.03350184112787247, 0.01602424867451191, -0.02253868244588375, 0.0016415659338235855, 0.00244213012047112, 0.03285190463066101, 0.017529591917991638, -0.05539570748806, -0.021351272240281105, -0.006466594059020281, 0.03699710592627525, -0.013179765082895756, -0.014310368336737156, -0.003991161938756704, 0.018856292590498924, 3.166495662298985e-05, 0.009686719626188278, 0.010406000539660454, 0.009904421865940094, 0.0014900820096954703, 0.014392036944627762, 0.030263029038906097, -0.015364442020654678, -0.01327401865273714, -0.019867710769176483, -0.005848584230989218, -0.009582345373928547, 0.009114044718444347, 0.0017719812458381057, 0.011364423669874668, 0.0419878326356411, -0.017080742865800858, -0.00573530001565814, 0.01722508855164051, 0.01751641370356083, -0.019351307302713394, 0.008514348417520523, -0.008807436563074589, 0.024498503655195236, 0.039364077150821686, 0.012447078712284565, 0.011648332700133324, 0.013809761963784695, 0.03484039753675461, 0.02731071040034294, -0.001066245255060494, -0.03351528197526932, 0.014987058006227016, 0.04685211926698685, 0.05745712295174599, 0.03567846864461899, -0.028210550546646118, -0.002727360697463155, 0.02383657917380333, 0.04426096752285957, 0.0066785989329218864, -0.02750321477651596, -0.022865623235702515, 0.014086362905800343, 0.006867502350360155, -0.03435247018933296, 0.0025408021174371243, -0.011401426047086716, -0.030537351965904236, -0.0022367548663169146, 0.01097579300403595, 0.012530098669230938, -0.017742397263646126, -0.024792177602648735, 0.035013824701309204, 0.010281872935593128, -0.0269796010106802, -0.0019028580281883478, 0.006914982106536627, 0.027129849418997765, -0.02002340741455555, -0.050581637769937515, -0.021133271977305412, 0.0030269878916442394, 0.030658269301056862, 0.018698077648878098, -0.020305665209889412, 0.013470485806465149, 0.009377730078995228, -0.02110172063112259, -0.004118029028177261, -0.02011689357459545, -0.014403353445231915, 0.07023388147354126, -0.030402345582842827, 0.03250748664140701, 0.013032080605626106, -0.036909740418195724, -0.03817867860198021, 0.04086191952228546, -0.01398678869009018, 0.0019419594900682569, 0.03448404371738434, -0.02472657337784767, -0.0009978347225114703, -0.0002461269323248416, -0.03507586568593979, 0.02563597448170185, 0.03407193347811699, 0.033915527164936066, 0.020277975127100945, 0.024231871590018272, -0.023791037499904633, -0.01302803959697485, 0.019273823127150536, -0.0011320769554004073, -0.0269783828407526, 0.0383497029542923, 0.015464961528778076, 0.00307412794791162, 0.002601179527118802, -0.027242079377174377, 0.0026614798698574305, 0.007633108180016279, 0.031223898753523827, 0.03857453539967537, -0.048687759786844254, 0.018361829221248627, 0.011815722100436687, -0.0028511846903711557, 0.017333056777715683, -0.015679217875003815, -0.03622012957930565, 0.02395184338092804, 0.03851764276623726, -0.009105953387916088, -0.018574053421616554, 0.013174222782254219, -0.04972304403781891, -0.00954792182892561, -0.007331135217100382, -0.00266282819211483, 0.03257693350315094, 0.025117894634604454, 0.011455012485384941, -0.007176162675023079, -0.03537435084581375, -0.022246502339839935, -0.014702481217682362, 0.01277997437864542, 0.020537830889225006, 0.012569240294396877, 0.015214262530207634, 0.002327859867364168, -0.010778321884572506, -0.030334634706377983, 0.01861468143761158, -0.028646918013691902, 0.006791211199015379, -0.023808225989341736, 0.0034277013037353754, 0.009042811580002308, 0.055577848106622696, 0.027081720530986786, -0.01849096082150936, -0.007526951842010021, -0.013719698414206505, -0.022472871467471123, -0.01449180580675602, 0.0010419513564556837, -0.012721680104732513, -0.03233366832137108, -0.013413011096417904, -0.014533163979649544, -0.004161523189395666, -0.005878159776329994, 0.0349099338054657, 0.009410942904651165, 0.02540871687233448, -0.016245901584625244, 0.03431931510567665, -0.018823223188519478, 0.04059894010424614, 0.03312565013766289, -0.023447612300515175, 0.002998290816321969, -0.03290458396077156, 0.021818464621901512, 0.021031109616160393, -0.020061472430825233, -0.021203383803367615, -0.00188209128100425, -0.013892988674342632, -0.008797937072813511, -0.02880481630563736, 0.02600199542939663, 0.009929348714649677, -0.015936631709337234, -0.036946505308151245, 0.043270133435726166, 0.023727089166641235, -0.0009725766140036285, 0.014700405299663544, -0.005329370964318514, 0.04005572944879532, 0.0317380391061306, -0.01172562874853611, 0.023834630846977234, 0.013467318378388882, 0.002570684067904949, 0.048699233680963516, -0.012680388055741787, -0.03831471875309944, 0.0027039465494453907, -0.00897977501153946, 0.009983769617974758, 0.032473959028720856, -0.02991635724902153, 0.0035958101507276297, 0.026289913803339005, 0.004758218768984079, 0.04051612690091133, -0.005917872302234173, 0.0219340268522501, -0.003340751165524125, 0.043364349752664566, 0.0053485967218875885, 0.02287224680185318, -0.02739114500582218, -0.008060675114393234, -0.013308394700288773, -0.013005648739635944, 0.009243522770702839, -0.025104496628046036, 0.015344636514782906, 0.015357611700892448, 0.003631098661571741, 0.022337229922413826, -0.016963621601462364, -0.021090872585773468, -0.03464943543076515, 0.01847870834171772, -0.0337042510509491, 0.00532348919659853, 0.016182852908968925, -0.007375890389084816, -0.0052016498520970345, -0.0044548469595611095, 0.009907911531627178, -0.028827061876654625, 0.023664701730012894, -0.010769080370664597, -0.029915576800704002, -0.015189843252301216, 0.019975950941443443, -0.01182220783084631, 0.014776511117815971, 0.0233349297195673, -0.003478294238448143, -0.0007377995643764734, -0.0003990570839960128, 0.005619866773486137, -0.004910904914140701, -0.03428364917635918, -0.008263026364147663, 0.013315176591277122, 0.015110727399587631, -0.00045751428115181625, -0.006802466232329607, -0.0038890924770385027, -0.0517420656979084, 0.009156305342912674, -0.01880919747054577, 0.029547054320573807, 0.001546181389130652, -0.01604904793202877, 0.0022612714674323797, 0.029258832335472107, 0.006139978766441345, -0.04474477842450142, 0.015664706006646156, 0.000237004627706483, 0.0007993717445060611, -0.007437430787831545, 0.008721165359020233, 0.0006416058749891818, -0.029819821938872337, -0.0034735784865915775, -0.002538805827498436, -0.007288678083568811, 0.0020404341630637646, 0.020437901839613914, -0.019092347472906113, 0.02728494070470333, 0.013598702847957611, 0.015327753499150276, -0.0173636507242918, -0.007287175860255957, -0.004865715280175209, -0.00470965588465333, 0.021588146686553955, 0.023452183231711388, -0.03536471351981163, -0.008309290744364262, -0.013360323384404182, 0.04137524589896202, 0.016155149787664413, 0.011368847452104092, 0.022875254973769188, -0.010130777955055237, 0.007072916254401207, 0.04069557413458824, -0.03369911015033722, -0.003495128359645605, 0.0030075267422944307, 0.016987185925245285, 0.050108034163713455, -0.016806650906801224, -0.0012647529365494847, -0.013608145527541637, 5.557327676797286e-05, 0.028649061918258667, -0.035884685814380646, -0.0038923381362110376, -0.012150679714977741, 0.010018451139330864, -0.008231918327510357, 0.01154241617769003, -0.0010152502218261361, 0.01527396310120821, -0.0005139559507369995, -0.0060277581214904785, -0.018756654113531113, 0.0481371209025383, 0.04305757209658623, 0.02883579581975937, 0.034510500729084015, -0.015725938603281975, 0.027074947953224182, 0.05209507420659065, 0.020675232633948326, 0.023215096443891525, 0.014972509816288948, 0.01016004104167223, -0.04493414983153343, -0.01071860920637846, 0.007120100315660238, -0.004026686307042837, -0.00820209737867117, -0.00845356099307537, -0.018101133406162262, 0.0020379899069666862, -0.021577194333076477, -0.005878139287233353, 0.004604856017976999, 0.000718490919098258, 0.024911917746067047, -0.062402963638305664, -0.005924939643591642, 0.005786644294857979, 0.024247102439403534, 0.007021712604910135, -0.02324746735394001, -0.0049596731550991535, 0.010584762319922447, 0.012080750428140163, -0.008010433055460453, 0.008883871138095856, -0.005358126480132341, -0.041087742894887924, 0.005555740557610989, -0.031164737418293953, 0.01126695703715086, 0.02031751349568367, -0.0005686284857802093, -0.011367376893758774]) > 0.9 ORDER BY dist LIMIT 3 FORMAT Native), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const (&) [101], void>(int, char const (&) [101]) @ 0x173d9b16 in /usr/bin/clickhouse
3. ./build/./src/Interpreters/TreeRewriter.cpp:916: DB::TreeRewriter::analyzeSelect(std::shared_ptr<DB::IAST>&, DB::TreeRewriterResult&&, DB::SelectQueryOptions const&, std::vector<DB::TableWithColumnNamesAndTypes, std::allocator<DB::TableWithColumnNamesAndTypes>> const&, std::vector<String, std::allocator<String>> const&, std::shared_ptr<DB::TableJoin>, bool, std::unordered_map<String, String, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, String>>>, std::unordered_map<String, String, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, String>>>) const @ 0x17ec5867 in /usr/bin/clickhouse
4. ./build/./contrib/llvm-project/libcxx/include/__utility/swap.h:37: DB::InterpreterSelectQuery::InterpreterSelectQuery(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context> const&, std::optional<DB::Pipe>, std::shared_ptr<DB::IStorage> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::shared_ptr<DB::PreparedSets>)::$_0::operator()(bool) const @ 0x17c0ac9c in /usr/bin/clickhouse
5. ./build/./src/Interpreters/InterpreterSelectQuery.cpp:0: DB::InterpreterSelectQuery::InterpreterSelectQuery(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context> const&, std::optional<DB::Pipe>, std::shared_ptr<DB::IStorage> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::shared_ptr<DB::PreparedSets>) @ 0x17c07875 in /usr/bin/clickhouse
6. ./build/./contrib/llvm-project/libcxx/include/optional:260: DB::InterpreterSelectQuery::InterpreterSelectQuery(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x17c04c31 in /usr/bin/clickhouse
7. ./build/./src/Interpreters/InterpreterSelectWithUnionQuery.cpp:257: DB::InterpreterSelectWithUnionQuery::buildCurrentChildInterpreter(std::shared_ptr<DB::IAST> const&, std::vector<String, std::allocator<String>> const&) @ 0x17c9093a in /usr/bin/clickhouse
8. ./build/./src/Interpreters/InterpreterSelectWithUnionQuery.cpp:152: DB::InterpreterSelectWithUnionQuery::InterpreterSelectWithUnionQuery(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context>, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x17c8e888 in /usr/bin/clickhouse
9. ./build/./contrib/llvm-project/libcxx/include/vector:434: std::__unique_if<DB::InterpreterSelectWithUnionQuery>::__unique_single std::make_unique[abi:v15000]<DB::InterpreterSelectWithUnionQuery, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::Context>&, DB::SelectQueryOptions const&>(std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::Context>&, DB::SelectQueryOptions const&) @ 0x17bcce93 in /usr/bin/clickhouse
10. ./build/./src/Interpreters/InterpreterFactory.cpp:0: DB::InterpreterFactory::get(std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::Context>, DB::SelectQueryOptions const&) @ 0x17bcc0b5 in /usr/bin/clickhouse
11. ./build/./src/Interpreters/executeQuery.cpp:0: DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x17f5cf2c in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:612: DB::executeQuery(DB::ReadBuffer&, DB::WriteBuffer&, bool, std::shared_ptr<DB::Context>, std::function<void (DB::QueryResultDetails const&)>, std::optional<DB::FormatSettings> const&) @ 0x17f6a022 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/optional:260: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c4a8e0 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
15. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
16. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
18. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
19. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
20. ? @ 0x7f3895a94ac3 in ?
21. ? @ 0x7f3895b26850 in ?

2024.10.09 23:32:36.236410 [ 39 ] {24105692-8c81-4396-91de-a30fc5d168ca} <Error> DynamicQueryHandler: Code: 62. DB::Exception: Not support more than one function among vector scan, text search, or hybrid search in one query now. (SYNTAX_ERROR), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const (&) [101], void>(int, char const (&) [101]) @ 0x173d9b16 in /usr/bin/clickhouse
3. ./build/./src/Interpreters/TreeRewriter.cpp:916: DB::TreeRewriter::analyzeSelect(std::shared_ptr<DB::IAST>&, DB::TreeRewriterResult&&, DB::SelectQueryOptions const&, std::vector<DB::TableWithColumnNamesAndTypes, std::allocator<DB::TableWithColumnNamesAndTypes>> const&, std::vector<String, std::allocator<String>> const&, std::shared_ptr<DB::TableJoin>, bool, std::unordered_map<String, String, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, String>>>, std::unordered_map<String, String, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, String>>>) const @ 0x17ec5867 in /usr/bin/clickhouse
4. ./build/./contrib/llvm-project/libcxx/include/__utility/swap.h:37: DB::InterpreterSelectQuery::InterpreterSelectQuery(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context> const&, std::optional<DB::Pipe>, std::shared_ptr<DB::IStorage> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::shared_ptr<DB::PreparedSets>)::$_0::operator()(bool) const @ 0x17c0ac9c in /usr/bin/clickhouse
5. ./build/./src/Interpreters/InterpreterSelectQuery.cpp:0: DB::InterpreterSelectQuery::InterpreterSelectQuery(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context> const&, std::optional<DB::Pipe>, std::shared_ptr<DB::IStorage> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::shared_ptr<DB::PreparedSets>) @ 0x17c07875 in /usr/bin/clickhouse
6. ./build/./contrib/llvm-project/libcxx/include/optional:260: DB::InterpreterSelectQuery::InterpreterSelectQuery(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x17c04c31 in /usr/bin/clickhouse
7. ./build/./src/Interpreters/InterpreterSelectWithUnionQuery.cpp:257: DB::InterpreterSelectWithUnionQuery::buildCurrentChildInterpreter(std::shared_ptr<DB::IAST> const&, std::vector<String, std::allocator<String>> const&) @ 0x17c9093a in /usr/bin/clickhouse
8. ./build/./src/Interpreters/InterpreterSelectWithUnionQuery.cpp:152: DB::InterpreterSelectWithUnionQuery::InterpreterSelectWithUnionQuery(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context>, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x17c8e888 in /usr/bin/clickhouse
9. ./build/./contrib/llvm-project/libcxx/include/vector:434: std::__unique_if<DB::InterpreterSelectWithUnionQuery>::__unique_single std::make_unique[abi:v15000]<DB::InterpreterSelectWithUnionQuery, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::Context>&, DB::SelectQueryOptions const&>(std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::Context>&, DB::SelectQueryOptions const&) @ 0x17bcce93 in /usr/bin/clickhouse
10. ./build/./src/Interpreters/InterpreterFactory.cpp:0: DB::InterpreterFactory::get(std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::Context>, DB::SelectQueryOptions const&) @ 0x17bcc0b5 in /usr/bin/clickhouse
11. ./build/./src/Interpreters/executeQuery.cpp:0: DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x17f5cf2c in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:612: DB::executeQuery(DB::ReadBuffer&, DB::WriteBuffer&, bool, std::shared_ptr<DB::Context>, std::function<void (DB::QueryResultDetails const&)>, std::optional<DB::FormatSettings> const&) @ 0x17f6a022 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/optional:260: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c4a8e0 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
15. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
16. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
18. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
19. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
20. ? @ 0x7f3895a94ac3 in ?
21. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.09 23:38:53.664376 [ 229 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.90 GiB (attempt to allocate chunk of 4360528 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:157: DB::WriteBufferFromFileBase::WriteBufferFromFileBase(unsigned long, char*, unsigned long) @ 0x127a5e2c in /usr/bin/clickhouse
10. ./build/./src/IO/WriteBufferFromFileDescriptor.cpp:93: DB::WriteBufferFromFileDescriptor::WriteBufferFromFileDescriptor(int, unsigned long, char*, unsigned long, String) @ 0x127a599b in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::WriteBufferFromFile::WriteBufferFromFile(String const&, unsigned long, int, unsigned int, char*, unsigned long) @ 0x12825d14 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/string:1499: std::__unique_if<DB::WriteBufferFromFile>::__unique_single std::make_unique[abi:v15000]<DB::WriteBufferFromFile, std::__fs::filesystem::path, unsigned long&, int&>(std::__fs::filesystem::path&&, unsigned long&, int&) @ 0x1717a40f in /usr/bin/clickhouse
13. ./build/./src/Disks/DiskLocal.cpp:0: DB::DiskLocal::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1717144d in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/DataPartStorageOnDiskFull.cpp:0: DB::DataPartStorageOnDiskFull::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1878a0c5 in /usr/bin/clickhouse
15. ./build/./src/Storages/MergeTree/IDataPartStorage.h:0: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f41e4 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
17. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
20. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
24. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
27. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
28. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
29. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
31. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.09 23:40:24.460220 [ 226 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:157: DB::WriteBufferFromFileBase::WriteBufferFromFileBase(unsigned long, char*, unsigned long) @ 0x127a5e2c in /usr/bin/clickhouse
10. ./build/./src/IO/WriteBufferFromFileDescriptor.cpp:93: DB::WriteBufferFromFileDescriptor::WriteBufferFromFileDescriptor(int, unsigned long, char*, unsigned long, String) @ 0x127a599b in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::WriteBufferFromFile::WriteBufferFromFile(String const&, unsigned long, int, unsigned int, char*, unsigned long) @ 0x12825d14 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/string:1499: std::__unique_if<DB::WriteBufferFromFile>::__unique_single std::make_unique[abi:v15000]<DB::WriteBufferFromFile, std::__fs::filesystem::path, unsigned long&, int&>(std::__fs::filesystem::path&&, unsigned long&, int&) @ 0x1717a40f in /usr/bin/clickhouse
13. ./build/./src/Disks/DiskLocal.cpp:0: DB::DiskLocal::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1717144d in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/DataPartStorageOnDiskFull.cpp:0: DB::DataPartStorageOnDiskFull::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1878a0c5 in /usr/bin/clickhouse
15. ./build/./src/Storages/MergeTree/IDataPartStorage.h:0: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f41e4 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
17. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
20. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
24. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
27. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
28. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
29. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
31. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.09 23:41:09.454506 [ 233 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.86 GiB (attempt to allocate chunk of 4360496 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:157: DB::WriteBufferFromFileBase::WriteBufferFromFileBase(unsigned long, char*, unsigned long) @ 0x127a5e2c in /usr/bin/clickhouse
10. ./build/./src/IO/WriteBufferFromFileDescriptor.cpp:93: DB::WriteBufferFromFileDescriptor::WriteBufferFromFileDescriptor(int, unsigned long, char*, unsigned long, String) @ 0x127a599b in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::WriteBufferFromFile::WriteBufferFromFile(String const&, unsigned long, int, unsigned int, char*, unsigned long) @ 0x12825d14 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/string:1499: std::__unique_if<DB::WriteBufferFromFile>::__unique_single std::make_unique[abi:v15000]<DB::WriteBufferFromFile, std::__fs::filesystem::path, unsigned long&, int&>(std::__fs::filesystem::path&&, unsigned long&, int&) @ 0x1717a40f in /usr/bin/clickhouse
13. ./build/./src/Disks/DiskLocal.cpp:0: DB::DiskLocal::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1717144d in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/DataPartStorageOnDiskFull.cpp:0: DB::DataPartStorageOnDiskFull::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1878a0c5 in /usr/bin/clickhouse
15. ./build/./src/Storages/MergeTree/IDataPartStorage.h:0: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f41e4 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
17. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
20. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
24. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
27. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
28. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
29. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
31. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.09 23:44:11.729076 [ 233 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.81 GiB (attempt to allocate chunk of 4360448 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:157: DB::WriteBufferFromFileBase::WriteBufferFromFileBase(unsigned long, char*, unsigned long) @ 0x127a5e2c in /usr/bin/clickhouse
10. ./build/./src/IO/WriteBufferFromFileDescriptor.cpp:93: DB::WriteBufferFromFileDescriptor::WriteBufferFromFileDescriptor(int, unsigned long, char*, unsigned long, String) @ 0x127a599b in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::WriteBufferFromFile::WriteBufferFromFile(String const&, unsigned long, int, unsigned int, char*, unsigned long) @ 0x12825d14 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/string:1499: std::__unique_if<DB::WriteBufferFromFile>::__unique_single std::make_unique[abi:v15000]<DB::WriteBufferFromFile, std::__fs::filesystem::path, unsigned long&, int&>(std::__fs::filesystem::path&&, unsigned long&, int&) @ 0x1717a40f in /usr/bin/clickhouse
13. ./build/./src/Disks/DiskLocal.cpp:0: DB::DiskLocal::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1717144d in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/DataPartStorageOnDiskFull.cpp:0: DB::DataPartStorageOnDiskFull::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1878a0c5 in /usr/bin/clickhouse
15. ./build/./src/Storages/MergeTree/IDataPartStorage.h:0: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f41e4 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
17. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
20. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
24. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
27. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
28. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
29. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
31. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.10 04:21:34.822786 [ 226 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.93 GiB (attempt to allocate chunk of 4360528 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 04:24:05.604796 [ 228 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.82 GiB (attempt to allocate chunk of 4202730 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero.: (while reading column ProfileEvent_ExternalAggregationWritePart): (while reading from part /var/lib/clickhouse/store/a51/a51efc65-fc44-4803-9d0c-ce07f9ff06af/202410_5190_5589_80/ from mark 0 with max_rows_to_read = 2114): While executing MergeTreeSequentialSource. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. void DB::PODArrayBase<8ul, 4096ul, Allocator<false, false>, 63ul, 64ul>::resize<>(unsigned long) @ 0xda23ab8 in /usr/bin/clickhouse
9. ./build/./src/Common/PODArray.h:389: DB::SerializationNumber<unsigned long>::deserializeBinaryBulk(DB::IColumn&, DB::ReadBuffer&, unsigned long, double) const @ 0x170ce4bb in /usr/bin/clickhouse
10. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:209: DB::ISerialization::deserializeBinaryBulkWithMultipleStreams(COW<DB::IColumn>::immutable_ptr<DB::IColumn>&, unsigned long, DB::ISerialization::DeserializeBinaryBulkSettings&, std::shared_ptr<DB::ISerialization::DeserializeBinaryBulkState>&, std::unordered_map<String, COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>>*) const @ 0x1709e16b in /usr/bin/clickhouse
11. ./build/./src/Storages/MergeTree/MergeTreeReaderWide.cpp:0: DB::MergeTreeReaderWide::readData(DB::NameAndTypePair const&, std::shared_ptr<DB::ISerialization const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn>&, unsigned long, bool, unsigned long, unsigned long, std::unordered_map<String, COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>>&, bool) @ 0x189e4120 in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeReaderWide.cpp:157: DB::MergeTreeReaderWide::readRows(unsigned long, unsigned long, bool, unsigned long, std::vector<COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::allocator<COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>&) @ 0x189e2d93 in /usr/bin/clickhouse
13. ./build/./src/Storages/MergeTree/MergeTreeSequentialSource.cpp:182: DB::MergeTreeSequentialSource::generate() @ 0x189e7608 in /usr/bin/clickhouse
14. ./build/./src/Processors/Chunk.h:90: DB::ISource::tryGenerate() @ 0x18cd2395 in /usr/bin/clickhouse
15. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::ISource::work() @ 0x18cd1ec5 in /usr/bin/clickhouse
16. ./build/./src/Processors/Executors/ExecutionThreadContext.cpp:0: DB::ExecutionThreadContext::executeTask() @ 0x18ce950c in /usr/bin/clickhouse
17. ./build/./src/Processors/Executors/PipelineExecutor.cpp:248: DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x18cdfd7b in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/atomic:958: DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x18cdf8a9 in /usr/bin/clickhouse
19. ./build/./src/Processors/Executors/PullingPipelineExecutor.cpp:54: DB::PullingPipelineExecutor::pull(DB::Chunk&) @ 0x18cecf48 in /usr/bin/clickhouse
20. ./build/./src/Processors/Executors/PullingPipelineExecutor.cpp:0: DB::PullingPipelineExecutor::pull(DB::Block&) @ 0x18ced130 in /usr/bin/clickhouse
21. ./build/./src/Storages/MergeTree/MergeTask.cpp:521: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::executeImpl() @ 0x18811eb4 in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
25. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
27. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
28. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
29. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
31. ? @ 0x7f3895a94ac3 in ?
 (version 23.3.2.1)
2024.10.10 04:42:32.776042 [ 237 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.85 GiB (attempt to allocate chunk of 4360432 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 04:43:10.924210 [ 228 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 04:47:34.544627 [ 229 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.84 GiB (attempt to allocate chunk of 4360368 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 09:58:24.177361 [ 239 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.93 GiB (attempt to allocate chunk of 4360432 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 10:00:53.950133 [ 229 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.99 GiB (attempt to allocate chunk of 4468765 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:157: DB::WriteBufferFromFileBase::WriteBufferFromFileBase(unsigned long, char*, unsigned long) @ 0x127a5e2c in /usr/bin/clickhouse
10. ./build/./src/IO/WriteBufferFromFileDescriptor.cpp:93: DB::WriteBufferFromFileDescriptor::WriteBufferFromFileDescriptor(int, unsigned long, char*, unsigned long, String) @ 0x127a599b in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::WriteBufferFromFile::WriteBufferFromFile(String const&, unsigned long, int, unsigned int, char*, unsigned long) @ 0x12825d14 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/string:1499: std::__unique_if<DB::WriteBufferFromFile>::__unique_single std::make_unique[abi:v15000]<DB::WriteBufferFromFile, std::__fs::filesystem::path, unsigned long&, int&>(std::__fs::filesystem::path&&, unsigned long&, int&) @ 0x1717a40f in /usr/bin/clickhouse
13. ./build/./src/Disks/DiskLocal.cpp:0: DB::DiskLocal::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1717144d in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/DataPartStorageOnDiskFull.cpp:0: DB::DataPartStorageOnDiskFull::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1878a0c5 in /usr/bin/clickhouse
15. ./build/./src/Storages/MergeTree/IDataPartStorage.h:0: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f41e4 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
17. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
20. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
24. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
27. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
28. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
29. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
31. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.10 10:00:53.960729 [ 225 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.99 GiB (attempt to allocate chunk of 4468765 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:157: DB::WriteBufferFromFileBase::WriteBufferFromFileBase(unsigned long, char*, unsigned long) @ 0x127a5e2c in /usr/bin/clickhouse
10. ./build/./src/IO/WriteBufferFromFileDescriptor.cpp:93: DB::WriteBufferFromFileDescriptor::WriteBufferFromFileDescriptor(int, unsigned long, char*, unsigned long, String) @ 0x127a599b in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::WriteBufferFromFile::WriteBufferFromFile(String const&, unsigned long, int, unsigned int, char*, unsigned long) @ 0x12825d14 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/string:1499: std::__unique_if<DB::WriteBufferFromFile>::__unique_single std::make_unique[abi:v15000]<DB::WriteBufferFromFile, std::__fs::filesystem::path, unsigned long&, int&>(std::__fs::filesystem::path&&, unsigned long&, int&) @ 0x1717a40f in /usr/bin/clickhouse
13. ./build/./src/Disks/DiskLocal.cpp:0: DB::DiskLocal::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1717144d in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/DataPartStorageOnDiskFull.cpp:0: DB::DataPartStorageOnDiskFull::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1878a0c5 in /usr/bin/clickhouse
15. ./build/./src/Storages/MergeTree/IDataPartStorage.h:0: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f41e4 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
17. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
20. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
24. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
27. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
28. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
29. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
31. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.10 10:00:53.973122 [ 237 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.99 GiB (attempt to allocate chunk of 4468765 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:157: DB::WriteBufferFromFileBase::WriteBufferFromFileBase(unsigned long, char*, unsigned long) @ 0x127a5e2c in /usr/bin/clickhouse
10. ./build/./src/IO/WriteBufferFromFileDescriptor.cpp:93: DB::WriteBufferFromFileDescriptor::WriteBufferFromFileDescriptor(int, unsigned long, char*, unsigned long, String) @ 0x127a599b in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::WriteBufferFromFile::WriteBufferFromFile(String const&, unsigned long, int, unsigned int, char*, unsigned long) @ 0x12825d14 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/string:1499: std::__unique_if<DB::WriteBufferFromFile>::__unique_single std::make_unique[abi:v15000]<DB::WriteBufferFromFile, std::__fs::filesystem::path, unsigned long&, int&>(std::__fs::filesystem::path&&, unsigned long&, int&) @ 0x1717a40f in /usr/bin/clickhouse
13. ./build/./src/Disks/DiskLocal.cpp:0: DB::DiskLocal::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1717144d in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/DataPartStorageOnDiskFull.cpp:0: DB::DataPartStorageOnDiskFull::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1878a0c5 in /usr/bin/clickhouse
15. ./build/./src/Storages/MergeTree/IDataPartStorage.h:0: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f41e4 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
17. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
20. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
24. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
27. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
28. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
29. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
31. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.10 10:00:53.986276 [ 233 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.99 GiB (attempt to allocate chunk of 4468765 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:157: DB::WriteBufferFromFileBase::WriteBufferFromFileBase(unsigned long, char*, unsigned long) @ 0x127a5e2c in /usr/bin/clickhouse
10. ./build/./src/IO/WriteBufferFromFileDescriptor.cpp:93: DB::WriteBufferFromFileDescriptor::WriteBufferFromFileDescriptor(int, unsigned long, char*, unsigned long, String) @ 0x127a599b in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::WriteBufferFromFile::WriteBufferFromFile(String const&, unsigned long, int, unsigned int, char*, unsigned long) @ 0x12825d14 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/string:1499: std::__unique_if<DB::WriteBufferFromFile>::__unique_single std::make_unique[abi:v15000]<DB::WriteBufferFromFile, std::__fs::filesystem::path, unsigned long&, int&>(std::__fs::filesystem::path&&, unsigned long&, int&) @ 0x1717a40f in /usr/bin/clickhouse
13. ./build/./src/Disks/DiskLocal.cpp:0: DB::DiskLocal::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1717144d in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/DataPartStorageOnDiskFull.cpp:0: DB::DataPartStorageOnDiskFull::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1878a0c5 in /usr/bin/clickhouse
15. ./build/./src/Storages/MergeTree/IDataPartStorage.h:0: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f41e4 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
17. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
20. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
24. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
27. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
28. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
29. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
31. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.10 10:00:54.047535 [ 231 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.99 GiB (attempt to allocate chunk of 4468765 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:157: DB::WriteBufferFromFileBase::WriteBufferFromFileBase(unsigned long, char*, unsigned long) @ 0x127a5e2c in /usr/bin/clickhouse
10. ./build/./src/IO/WriteBufferFromFileDescriptor.cpp:93: DB::WriteBufferFromFileDescriptor::WriteBufferFromFileDescriptor(int, unsigned long, char*, unsigned long, String) @ 0x127a599b in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::WriteBufferFromFile::WriteBufferFromFile(String const&, unsigned long, int, unsigned int, char*, unsigned long) @ 0x12825d14 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/string:1499: std::__unique_if<DB::WriteBufferFromFile>::__unique_single std::make_unique[abi:v15000]<DB::WriteBufferFromFile, std::__fs::filesystem::path, unsigned long&, int&>(std::__fs::filesystem::path&&, unsigned long&, int&) @ 0x1717a40f in /usr/bin/clickhouse
13. ./build/./src/Disks/DiskLocal.cpp:0: DB::DiskLocal::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1717144d in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/DataPartStorageOnDiskFull.cpp:0: DB::DataPartStorageOnDiskFull::writeFile(String const&, unsigned long, DB::WriteMode, DB::WriteSettings const&) @ 0x1878a0c5 in /usr/bin/clickhouse
15. ./build/./src/Storages/MergeTree/IDataPartStorage.h:0: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f41e4 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
17. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
20. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
24. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
27. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
28. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
29. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
31. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.10 10:00:55.395486 [ 228 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.99 GiB (attempt to allocate chunk of 4198795 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero.: (while reading column ProfileEvent_ReplicaPartialShutdown): (while reading from part /var/lib/clickhouse/store/a51/a51efc65-fc44-4803-9d0c-ce07f9ff06af/202410_5670_6003_67/ from mark 0 with max_rows_to_read = 2114): While executing MergeTreeSequentialSource. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:80: DB::CompressedReadBufferFromFile::readBig(char*, unsigned long) @ 0x16f2bbf3 in /usr/bin/clickhouse
10. ./build/./src/DataTypes/Serializations/SerializationNumber.cpp:155: DB::SerializationNumber<unsigned long>::deserializeBinaryBulk(DB::IColumn&, DB::ReadBuffer&, unsigned long, double) const @ 0x170ce4d7 in /usr/bin/clickhouse
11. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:209: DB::ISerialization::deserializeBinaryBulkWithMultipleStreams(COW<DB::IColumn>::immutable_ptr<DB::IColumn>&, unsigned long, DB::ISerialization::DeserializeBinaryBulkSettings&, std::shared_ptr<DB::ISerialization::DeserializeBinaryBulkState>&, std::unordered_map<String, COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>>*) const @ 0x1709e16b in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeReaderWide.cpp:0: DB::MergeTreeReaderWide::readData(DB::NameAndTypePair const&, std::shared_ptr<DB::ISerialization const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn>&, unsigned long, bool, unsigned long, unsigned long, std::unordered_map<String, COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>>&, bool) @ 0x189e4120 in /usr/bin/clickhouse
13. ./build/./src/Storages/MergeTree/MergeTreeReaderWide.cpp:157: DB::MergeTreeReaderWide::readRows(unsigned long, unsigned long, bool, unsigned long, std::vector<COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::allocator<COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>&) @ 0x189e2d93 in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/MergeTreeSequentialSource.cpp:182: DB::MergeTreeSequentialSource::generate() @ 0x189e7608 in /usr/bin/clickhouse
15. ./build/./src/Processors/Chunk.h:90: DB::ISource::tryGenerate() @ 0x18cd2395 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::ISource::work() @ 0x18cd1ec5 in /usr/bin/clickhouse
17. ./build/./src/Processors/Executors/ExecutionThreadContext.cpp:0: DB::ExecutionThreadContext::executeTask() @ 0x18ce950c in /usr/bin/clickhouse
18. ./build/./src/Processors/Executors/PipelineExecutor.cpp:248: DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x18cdfd7b in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/atomic:958: DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x18cdf8a9 in /usr/bin/clickhouse
20. ./build/./src/Processors/Executors/PullingPipelineExecutor.cpp:54: DB::PullingPipelineExecutor::pull(DB::Chunk&) @ 0x18cecf48 in /usr/bin/clickhouse
21. ./build/./src/Processors/Executors/PullingPipelineExecutor.cpp:0: DB::PullingPipelineExecutor::pull(DB::Block&) @ 0x18ced130 in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:521: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::executeImpl() @ 0x18811eb4 in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
25. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
26. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
27. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
29. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
30. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
31. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.10 10:19:51.337828 [ 231 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.99 GiB (attempt to allocate chunk of 4201133 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero.: (while reading column ProfileEvent_DiskS3GetRequestThrottlerSleepMicroseconds): (while reading from part /var/lib/clickhouse/store/a51/a51efc65-fc44-4803-9d0c-ce07f9ff06af/202410_5670_6033_73/ from mark 0 with max_rows_to_read = 2114): While executing MergeTreeSequentialSource. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:80: DB::CompressedReadBufferFromFile::readBig(char*, unsigned long) @ 0x16f2bbf3 in /usr/bin/clickhouse
10. ./build/./src/DataTypes/Serializations/SerializationNumber.cpp:155: DB::SerializationNumber<unsigned long>::deserializeBinaryBulk(DB::IColumn&, DB::ReadBuffer&, unsigned long, double) const @ 0x170ce4d7 in /usr/bin/clickhouse
11. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:209: DB::ISerialization::deserializeBinaryBulkWithMultipleStreams(COW<DB::IColumn>::immutable_ptr<DB::IColumn>&, unsigned long, DB::ISerialization::DeserializeBinaryBulkSettings&, std::shared_ptr<DB::ISerialization::DeserializeBinaryBulkState>&, std::unordered_map<String, COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>>*) const @ 0x1709e16b in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeReaderWide.cpp:0: DB::MergeTreeReaderWide::readData(DB::NameAndTypePair const&, std::shared_ptr<DB::ISerialization const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn>&, unsigned long, bool, unsigned long, unsigned long, std::unordered_map<String, COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>>&, bool) @ 0x189e4120 in /usr/bin/clickhouse
13. ./build/./src/Storages/MergeTree/MergeTreeReaderWide.cpp:157: DB::MergeTreeReaderWide::readRows(unsigned long, unsigned long, bool, unsigned long, std::vector<COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::allocator<COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>&) @ 0x189e2d93 in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/MergeTreeSequentialSource.cpp:182: DB::MergeTreeSequentialSource::generate() @ 0x189e7608 in /usr/bin/clickhouse
15. ./build/./src/Processors/Chunk.h:90: DB::ISource::tryGenerate() @ 0x18cd2395 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::ISource::work() @ 0x18cd1ec5 in /usr/bin/clickhouse
17. ./build/./src/Processors/Executors/ExecutionThreadContext.cpp:0: DB::ExecutionThreadContext::executeTask() @ 0x18ce950c in /usr/bin/clickhouse
18. ./build/./src/Processors/Executors/PipelineExecutor.cpp:248: DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x18cdfd7b in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/atomic:958: DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x18cdf8a9 in /usr/bin/clickhouse
20. ./build/./src/Processors/Executors/PullingPipelineExecutor.cpp:54: DB::PullingPipelineExecutor::pull(DB::Chunk&) @ 0x18cecf48 in /usr/bin/clickhouse
21. ./build/./src/Processors/Executors/PullingPipelineExecutor.cpp:0: DB::PullingPipelineExecutor::pull(DB::Block&) @ 0x18ced130 in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:521: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::executeImpl() @ 0x18811eb4 in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
25. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
26. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
27. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
29. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
30. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
31. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.10 11:00:28.519479 [ 235 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.85 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 11:02:22.038830 [ 225 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.97 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 11:03:00.122554 [ 230 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.96 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 11:03:37.697873 [ 232 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.85 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 11:09:56.029844 [ 239 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.84 GiB (attempt to allocate chunk of 4360416 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 11:13:05.396851 [ 237 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.84 GiB (attempt to allocate chunk of 4360528 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 11:13:43.244130 [ 226 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.84 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 11:27:34.134111 [ 234 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360448 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 11:30:05.084506 [ 235 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.85 GiB (attempt to allocate chunk of 4360432 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 11:45:14.015937 [ 231 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.86 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 11:47:44.697364 [ 225 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.86 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 11:49:37.681484 [ 236 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.86 GiB (attempt to allocate chunk of 4360432 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 11:54:01.853264 [ 230 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.86 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 11:55:54.930208 [ 237 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.87 GiB (attempt to allocate chunk of 4360448 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 12:00:18.848910 [ 237 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.86 GiB (attempt to allocate chunk of 4360368 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 12:04:42.834920 [ 225 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.86 GiB (attempt to allocate chunk of 4207502 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero.: (while reading column ProfileEvent_AIOWrite): (while reading from part /var/lib/clickhouse/store/a51/a51efc65-fc44-4803-9d0c-ce07f9ff06af/202410_5670_6602_187/ from mark 0 with max_rows_to_read = 2114): While executing MergeTreeSequentialSource. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. void DB::PODArrayBase<8ul, 4096ul, Allocator<false, false>, 63ul, 64ul>::resize<>(unsigned long) @ 0xda23ab8 in /usr/bin/clickhouse
9. ./build/./src/Common/PODArray.h:389: DB::SerializationNumber<unsigned long>::deserializeBinaryBulk(DB::IColumn&, DB::ReadBuffer&, unsigned long, double) const @ 0x170ce4bb in /usr/bin/clickhouse
10. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:209: DB::ISerialization::deserializeBinaryBulkWithMultipleStreams(COW<DB::IColumn>::immutable_ptr<DB::IColumn>&, unsigned long, DB::ISerialization::DeserializeBinaryBulkSettings&, std::shared_ptr<DB::ISerialization::DeserializeBinaryBulkState>&, std::unordered_map<String, COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>>*) const @ 0x1709e16b in /usr/bin/clickhouse
11. ./build/./src/Storages/MergeTree/MergeTreeReaderWide.cpp:0: DB::MergeTreeReaderWide::readData(DB::NameAndTypePair const&, std::shared_ptr<DB::ISerialization const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn>&, unsigned long, bool, unsigned long, unsigned long, std::unordered_map<String, COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>>&, bool) @ 0x189e4120 in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeReaderWide.cpp:157: DB::MergeTreeReaderWide::readRows(unsigned long, unsigned long, bool, unsigned long, std::vector<COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::allocator<COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>&) @ 0x189e2d93 in /usr/bin/clickhouse
13. ./build/./src/Storages/MergeTree/MergeTreeSequentialSource.cpp:182: DB::MergeTreeSequentialSource::generate() @ 0x189e7608 in /usr/bin/clickhouse
14. ./build/./src/Processors/Chunk.h:90: DB::ISource::tryGenerate() @ 0x18cd2395 in /usr/bin/clickhouse
15. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::ISource::work() @ 0x18cd1ec5 in /usr/bin/clickhouse
16. ./build/./src/Processors/Executors/ExecutionThreadContext.cpp:0: DB::ExecutionThreadContext::executeTask() @ 0x18ce950c in /usr/bin/clickhouse
17. ./build/./src/Processors/Executors/PipelineExecutor.cpp:248: DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x18cdfd7b in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/atomic:958: DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x18cdf8a9 in /usr/bin/clickhouse
19. ./build/./src/Processors/Executors/PullingPipelineExecutor.cpp:54: DB::PullingPipelineExecutor::pull(DB::Chunk&) @ 0x18cecf48 in /usr/bin/clickhouse
20. ./build/./src/Processors/Executors/PullingPipelineExecutor.cpp:0: DB::PullingPipelineExecutor::pull(DB::Block&) @ 0x18ced130 in /usr/bin/clickhouse
21. ./build/./src/Storages/MergeTree/MergeTask.cpp:521: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::executeImpl() @ 0x18811eb4 in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
25. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
27. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
28. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
29. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
31. ? @ 0x7f3895a94ac3 in ?
 (version 23.3.2.1)
2024.10.10 12:06:35.776002 [ 238 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.85 GiB (attempt to allocate chunk of 4360432 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 12:07:13.660015 [ 238 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.84 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 12:11:37.666790 [ 235 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.82 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 12:13:30.677228 [ 229 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 12:15:23.752622 [ 228 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.81 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 12:17:17.040557 [ 232 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.82 GiB (attempt to allocate chunk of 4360528 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 12:17:54.799112 [ 231 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.82 GiB (attempt to allocate chunk of 4206869 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero.: (while reading column ProfileEvent_MergeTreeDataWriterCompressedBytes): (while reading from part /var/lib/clickhouse/store/a51/a51efc65-fc44-4803-9d0c-ce07f9ff06af/202410_5670_6707_208/ from mark 0 with max_rows_to_read = 2114): While executing MergeTreeSequentialSource. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:49: DB::ReadBufferFromFileBase::ReadBufferFromFileBase(unsigned long, char*, unsigned long, std::optional<unsigned long>) @ 0x1278efdb in /usr/bin/clickhouse
10. ./build/./src/IO/ReadBufferFromFileDescriptor.h:38: DB::ReadBufferFromFilePReadWithDescriptorsCache::ReadBufferFromFilePReadWithDescriptorsCache(String const&, unsigned long, int, char*, unsigned long, std::optional<unsigned long>) @ 0x16a59cb2 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:0: DB::createReadBufferFromFileBase(String const&, DB::ReadSettings const&, std::optional<unsigned long>, std::optional<unsigned long>, int, char*, unsigned long)::$_0::operator()(unsigned long, unsigned long, int) const @ 0x16a5964b in /usr/bin/clickhouse
12. ./build/./src/Disks/IO/createReadBufferFromFileBase.cpp:185: DB::createReadBufferFromFileBase(String const&, DB::ReadSettings const&, std::optional<unsigned long>, std::optional<unsigned long>, int, char*, unsigned long) @ 0x16a595a2 in /usr/bin/clickhouse
13. ./build/./src/Disks/DiskLocal.cpp:0: DB::DiskLocal::readFile(String const&, DB::ReadSettings const&, std::optional<unsigned long>, std::optional<unsigned long>) const @ 0x171710f2 in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/DataPartStorageOnDiskFull.cpp:0: DB::DataPartStorageOnDiskFull::readFile(String const&, DB::ReadSettings const&, std::optional<unsigned long>, std::optional<unsigned long>) const @ 0x18788da8 in /usr/bin/clickhouse
15. ./build/./src/Storages/MergeTree/MergeTreeReaderStream.cpp:0: DB::MergeTreeReaderStream::init() @ 0x189e0854 in /usr/bin/clickhouse
16. ./build/./src/Storages/MergeTree/MergeTreeReaderStream.cpp:275: DB::MergeTreeReaderStream::adjustRightMark(unsigned long) @ 0x189e242f in /usr/bin/clickhouse
17. ./build/./src/Storages/MergeTree/MergeTreeReaderWide.cpp:281: DB::getStream(bool, DB::ISerialization::SubstreamPath const&, std::map<String, std::unique_ptr<DB::MergeTreeReaderStream, std::default_delete<DB::MergeTreeReaderStream>>, std::less<String>, std::allocator<std::pair<String const, std::unique_ptr<DB::MergeTreeReaderStream, std::default_delete<DB::MergeTreeReaderStream>>>>>&, DB::NameAndTypePair const&, unsigned long, bool, unsigned long, std::unordered_map<String, COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>>&) @ 0x189e4d88 in /usr/bin/clickhouse
18. ./build/./src/Storages/MergeTree/MergeTreeReaderWide.cpp:350: DB::ReadBuffer* std::__function::__policy_invoker<DB::ReadBuffer* (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeReaderWide::readData(DB::NameAndTypePair const&, std::shared_ptr<DB::ISerialization const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn>&, unsigned long, bool, unsigned long, unsigned long, std::unordered_map<String, COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>>&, bool)::$_3, DB::ReadBuffer* (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x189e5027 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::ISerialization::deserializeBinaryBulkWithMultipleStreams(COW<DB::IColumn>::immutable_ptr<DB::IColumn>&, unsigned long, DB::ISerialization::DeserializeBinaryBulkSettings&, std::shared_ptr<DB::ISerialization::DeserializeBinaryBulkState>&, std::unordered_map<String, COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>>*) const @ 0x1709e13e in /usr/bin/clickhouse
20. ./build/./src/Storages/MergeTree/MergeTreeReaderWide.cpp:0: DB::MergeTreeReaderWide::readData(DB::NameAndTypePair const&, std::shared_ptr<DB::ISerialization const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn>&, unsigned long, bool, unsigned long, unsigned long, std::unordered_map<String, COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>>&, bool) @ 0x189e4120 in /usr/bin/clickhouse
21. ./build/./src/Storages/MergeTree/MergeTreeReaderWide.cpp:157: DB::MergeTreeReaderWide::readRows(unsigned long, unsigned long, bool, unsigned long, std::vector<COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::allocator<COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>&) @ 0x189e2d93 in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTreeSequentialSource.cpp:182: DB::MergeTreeSequentialSource::generate() @ 0x189e7608 in /usr/bin/clickhouse
23. ./build/./src/Processors/Chunk.h:90: DB::ISource::tryGenerate() @ 0x18cd2395 in /usr/bin/clickhouse
24. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::ISource::work() @ 0x18cd1ec5 in /usr/bin/clickhouse
25. ./build/./src/Processors/Executors/ExecutionThreadContext.cpp:0: DB::ExecutionThreadContext::executeTask() @ 0x18ce950c in /usr/bin/clickhouse
26. ./build/./src/Processors/Executors/PipelineExecutor.cpp:248: DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x18cdfd7b in /usr/bin/clickhouse
27. ./build/./contrib/llvm-project/libcxx/include/atomic:958: DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x18cdf8a9 in /usr/bin/clickhouse
28. ./build/./src/Processors/Executors/PullingPipelineExecutor.cpp:54: DB::PullingPipelineExecutor::pull(DB::Chunk&) @ 0x18cecf48 in /usr/bin/clickhouse
29. ./build/./src/Processors/Executors/PullingPipelineExecutor.cpp:0: DB::PullingPipelineExecutor::pull(DB::Block&) @ 0x18ced130 in /usr/bin/clickhouse
30. ./build/./src/Storages/MergeTree/MergeTask.cpp:521: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::executeImpl() @ 0x18811eb4 in /usr/bin/clickhouse
31. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.10 12:19:09.865751 [ 231 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.82 GiB (attempt to allocate chunk of 4360432 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 12:19:47.640200 [ 228 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.82 GiB (attempt to allocate chunk of 4360448 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 12:21:40.707753 [ 239 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.82 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 12:23:33.783230 [ 234 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.82 GiB (attempt to allocate chunk of 4360528 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 13:17:16.849730 [ 228 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.81 GiB (attempt to allocate chunk of 4360448 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 14:01:04.117562 [ 233 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.86 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 14:03:00.897432 [ 235 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 14:24:30.962469 [ 229 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.81 GiB (attempt to allocate chunk of 4197503 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero.: (while reading column ProfileEvent_PerfAlignmentFaults): (while reading from part /var/lib/clickhouse/store/a51/a51efc65-fc44-4803-9d0c-ce07f9ff06af/202410_5670_6882_243/ from mark 0 with max_rows_to_read = 2114): While executing MergeTreeSequentialSource. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. void DB::PODArrayBase<8ul, 4096ul, Allocator<false, false>, 63ul, 64ul>::resize<>(unsigned long) @ 0xda23ab8 in /usr/bin/clickhouse
9. ./build/./src/Common/PODArray.h:389: DB::SerializationNumber<unsigned long>::deserializeBinaryBulk(DB::IColumn&, DB::ReadBuffer&, unsigned long, double) const @ 0x170ce4bb in /usr/bin/clickhouse
10. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:209: DB::ISerialization::deserializeBinaryBulkWithMultipleStreams(COW<DB::IColumn>::immutable_ptr<DB::IColumn>&, unsigned long, DB::ISerialization::DeserializeBinaryBulkSettings&, std::shared_ptr<DB::ISerialization::DeserializeBinaryBulkState>&, std::unordered_map<String, COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>>*) const @ 0x1709e16b in /usr/bin/clickhouse
11. ./build/./src/Storages/MergeTree/MergeTreeReaderWide.cpp:0: DB::MergeTreeReaderWide::readData(DB::NameAndTypePair const&, std::shared_ptr<DB::ISerialization const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn>&, unsigned long, bool, unsigned long, unsigned long, std::unordered_map<String, COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>>&, bool) @ 0x189e4120 in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeReaderWide.cpp:157: DB::MergeTreeReaderWide::readRows(unsigned long, unsigned long, bool, unsigned long, std::vector<COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::allocator<COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>&) @ 0x189e2d93 in /usr/bin/clickhouse
13. ./build/./src/Storages/MergeTree/MergeTreeSequentialSource.cpp:182: DB::MergeTreeSequentialSource::generate() @ 0x189e7608 in /usr/bin/clickhouse
14. ./build/./src/Processors/Chunk.h:90: DB::ISource::tryGenerate() @ 0x18cd2395 in /usr/bin/clickhouse
15. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::ISource::work() @ 0x18cd1ec5 in /usr/bin/clickhouse
16. ./build/./src/Processors/Executors/ExecutionThreadContext.cpp:0: DB::ExecutionThreadContext::executeTask() @ 0x18ce950c in /usr/bin/clickhouse
17. ./build/./src/Processors/Executors/PipelineExecutor.cpp:248: DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x18cdfd7b in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/atomic:958: DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x18cdf8a9 in /usr/bin/clickhouse
19. ./build/./src/Processors/Executors/PullingPipelineExecutor.cpp:54: DB::PullingPipelineExecutor::pull(DB::Chunk&) @ 0x18cecf48 in /usr/bin/clickhouse
20. ./build/./src/Processors/Executors/PullingPipelineExecutor.cpp:0: DB::PullingPipelineExecutor::pull(DB::Block&) @ 0x18ced130 in /usr/bin/clickhouse
21. ./build/./src/Storages/MergeTree/MergeTask.cpp:521: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::executeImpl() @ 0x18811eb4 in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
25. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
27. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
28. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
29. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
31. ? @ 0x7f3895a94ac3 in ?
 (version 23.3.2.1)
2024.10.10 14:42:04.008582 [ 236 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.82 GiB (attempt to allocate chunk of 4254014 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero.: (while reading column ProfileEvent_MergesTimeMilliseconds): (while reading from part /var/lib/clickhouse/store/a51/a51efc65-fc44-4803-9d0c-ce07f9ff06af/202410_5670_6897_246/ from mark 0 with max_rows_to_read = 2114): While executing MergeTreeSequentialSource. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:80: DB::CompressedReadBufferFromFile::readBig(char*, unsigned long) @ 0x16f2bbf3 in /usr/bin/clickhouse
10. ./build/./src/DataTypes/Serializations/SerializationNumber.cpp:155: DB::SerializationNumber<unsigned long>::deserializeBinaryBulk(DB::IColumn&, DB::ReadBuffer&, unsigned long, double) const @ 0x170ce4d7 in /usr/bin/clickhouse
11. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:209: DB::ISerialization::deserializeBinaryBulkWithMultipleStreams(COW<DB::IColumn>::immutable_ptr<DB::IColumn>&, unsigned long, DB::ISerialization::DeserializeBinaryBulkSettings&, std::shared_ptr<DB::ISerialization::DeserializeBinaryBulkState>&, std::unordered_map<String, COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>>*) const @ 0x1709e16b in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeReaderWide.cpp:0: DB::MergeTreeReaderWide::readData(DB::NameAndTypePair const&, std::shared_ptr<DB::ISerialization const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn>&, unsigned long, bool, unsigned long, unsigned long, std::unordered_map<String, COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>>&, bool) @ 0x189e4120 in /usr/bin/clickhouse
13. ./build/./src/Storages/MergeTree/MergeTreeReaderWide.cpp:157: DB::MergeTreeReaderWide::readRows(unsigned long, unsigned long, bool, unsigned long, std::vector<COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::allocator<COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>&) @ 0x189e2d93 in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/MergeTreeSequentialSource.cpp:182: DB::MergeTreeSequentialSource::generate() @ 0x189e7608 in /usr/bin/clickhouse
15. ./build/./src/Processors/Chunk.h:90: DB::ISource::tryGenerate() @ 0x18cd2395 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::ISource::work() @ 0x18cd1ec5 in /usr/bin/clickhouse
17. ./build/./src/Processors/Executors/ExecutionThreadContext.cpp:0: DB::ExecutionThreadContext::executeTask() @ 0x18ce950c in /usr/bin/clickhouse
18. ./build/./src/Processors/Executors/PipelineExecutor.cpp:248: DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x18cdfd7b in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/atomic:958: DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x18cdf8a9 in /usr/bin/clickhouse
20. ./build/./src/Processors/Executors/PullingPipelineExecutor.cpp:54: DB::PullingPipelineExecutor::pull(DB::Chunk&) @ 0x18cecf48 in /usr/bin/clickhouse
21. ./build/./src/Processors/Executors/PullingPipelineExecutor.cpp:0: DB::PullingPipelineExecutor::pull(DB::Block&) @ 0x18ced130 in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:521: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::executeImpl() @ 0x18811eb4 in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
25. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
26. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
27. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
29. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
30. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
31. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.10 15:21:57.776355 [ 225 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.85 GiB (attempt to allocate chunk of 4360448 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 15:22:35.513568 [ 234 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 16:04:04.755667 [ 224 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.84 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 16:57:56.642393 [ 234 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.82 GiB (attempt to allocate chunk of 4360432 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 17:05:00.585980 [ 228 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360432 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 17:44:00.781264 [ 234 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 17:45:53.635135 [ 229 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.88 GiB (attempt to allocate chunk of 4360448 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 18:05:59.155203 [ 237 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.81 GiB (attempt to allocate chunk of 4360368 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 18:07:51.651654 [ 233 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.84 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 18:09:44.782890 [ 231 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.86 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 18:10:22.756733 [ 238 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.89 GiB (attempt to allocate chunk of 4360432 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 22:03:14.942114 [ 233 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.86 GiB (attempt to allocate chunk of 4360432 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 22:07:38.812225 [ 231 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.85 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 22:17:43.657361 [ 236 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.84 GiB (attempt to allocate chunk of 4360448 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 22:20:14.866428 [ 226 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.87 GiB (attempt to allocate chunk of 4360448 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 22:21:30.926622 [ 239 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 22:23:24.041683 [ 226 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.89 GiB (attempt to allocate chunk of 4360432 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 22:25:54.958978 [ 231 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 22:28:25.708867 [ 230 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.92 GiB (attempt to allocate chunk of 4360368 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 22:36:36.627453 [ 234 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.87 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 22:41:39.002676 [ 226 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.90 GiB (attempt to allocate chunk of 4360368 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 22:46:41.029392 [ 239 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.92 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 22:49:11.841582 [ 236 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.91 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 22:56:45.672315 [ 238 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.91 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 23:02:25.686088 [ 237 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.86 GiB (attempt to allocate chunk of 4360528 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 23:08:05.852833 [ 234 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.91 GiB (attempt to allocate chunk of 4360432 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 23:11:14.825803 [ 228 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.92 GiB (attempt to allocate chunk of 4360432 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 23:16:54.770402 [ 231 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.85 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
2024.10.10 23:19:25.617144 [ 236 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360432 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f3895a94ac3 in ?
31. ? @ 0x7f3895b26850 in ?
 (version 23.3.2.1)
