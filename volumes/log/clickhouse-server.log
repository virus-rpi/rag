2024.09.26 22:59:56.642449 [ 39 ] {} <Error> Access(user directories): from: 192.168.65.1, user: default: Authentication failed: Code: 195. DB::Exception: Connections from 192.168.65.1 are not allowed. (IP_ADDRESS_NOT_ALLOWED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0xda217e4 in /usr/bin/clickhouse
3. ./build/./src/Access/IAccessStorage.cpp:0: DB::IAccessStorage::throwAddressNotAllowed(Poco::Net::IPAddress const&) @ 0x16c1b3d2 in /usr/bin/clickhouse
4. ./build/./src/Access/IAccessStorage.cpp:490: DB::IAccessStorage::authenticateImpl(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c1864c in /usr/bin/clickhouse
5. ./build/./src/Access/IAccessStorage.cpp:468: DB::IAccessStorage::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c1b342 in /usr/bin/clickhouse
6. ./build/./src/Access/MultipleAccessStorage.cpp:342: DB::MultipleAccessStorage::authenticateImpl(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c3cdd1 in /usr/bin/clickhouse
7. ./build/./src/Access/IAccessStorage.cpp:456: DB::IAccessStorage::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool) const @ 0x16c1b30c in /usr/bin/clickhouse
8. ./build/./src/Access/AccessControl.cpp:559: DB::AccessControl::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&) const @ 0x16b74d62 in /usr/bin/clickhouse
9. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::Session::authenticate(DB::Credentials const&, Poco::Net::SocketAddress const&) @ 0x17d8d042 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::HTTPHandler::authenticateUser(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&) @ 0x18c45f2e in /usr/bin/clickhouse
11. ./build/./src/Server/HTTPHandler.cpp:544: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c47815 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
13. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
14. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
15. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
16. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
17. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
18. ? @ 0x7f61f2294ac3 in ?
19. ? @ 0x7f61f2326850 in ?
 (version 23.3.2.1)
2024.09.26 22:59:56.656750 [ 39 ] {} <Error> DynamicQueryHandler: Code: 516. DB::Exception: default: Authentication failed: password is incorrect, or there is no user with such name.

If you have installed ClickHouse and forgot password you can reset it in the configuration file.
The password for default user is typically located at /etc/clickhouse-server/users.d/default-password.xml
and deleting this file will reset the password.
See also /etc/clickhouse-server/users.xml on the server where ClickHouse is installed.

. (AUTHENTICATION_FAILED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0xda3792c in /usr/bin/clickhouse
3. ./build/./src/Access/AccessControl.cpp:0: DB::AccessControl::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&) const @ 0x16b7501d in /usr/bin/clickhouse
4. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::Session::authenticate(DB::Credentials const&, Poco::Net::SocketAddress const&) @ 0x17d8d042 in /usr/bin/clickhouse
5. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::HTTPHandler::authenticateUser(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&) @ 0x18c45f2e in /usr/bin/clickhouse
6. ./build/./src/Server/HTTPHandler.cpp:544: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c47815 in /usr/bin/clickhouse
7. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
8. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
9. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
11. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
12. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
13. ? @ 0x7f61f2294ac3 in ?
14. ? @ 0x7f61f2326850 in ?
 (version 23.3.2.1)
2024.09.26 23:01:48.161328 [ 39 ] {} <Error> Access(user directories): from: 192.168.65.1, user: default: Authentication failed: Code: 195. DB::Exception: Connections from 192.168.65.1 are not allowed. (IP_ADDRESS_NOT_ALLOWED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0xda217e4 in /usr/bin/clickhouse
3. ./build/./src/Access/IAccessStorage.cpp:0: DB::IAccessStorage::throwAddressNotAllowed(Poco::Net::IPAddress const&) @ 0x16c1b3d2 in /usr/bin/clickhouse
4. ./build/./src/Access/IAccessStorage.cpp:490: DB::IAccessStorage::authenticateImpl(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c1864c in /usr/bin/clickhouse
5. ./build/./src/Access/IAccessStorage.cpp:468: DB::IAccessStorage::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c1b342 in /usr/bin/clickhouse
6. ./build/./src/Access/MultipleAccessStorage.cpp:342: DB::MultipleAccessStorage::authenticateImpl(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c3cdd1 in /usr/bin/clickhouse
7. ./build/./src/Access/IAccessStorage.cpp:456: DB::IAccessStorage::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool) const @ 0x16c1b30c in /usr/bin/clickhouse
8. ./build/./src/Access/AccessControl.cpp:559: DB::AccessControl::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&) const @ 0x16b74d62 in /usr/bin/clickhouse
9. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::Session::authenticate(DB::Credentials const&, Poco::Net::SocketAddress const&) @ 0x17d8d042 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::HTTPHandler::authenticateUser(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&) @ 0x18c45f2e in /usr/bin/clickhouse
11. ./build/./src/Server/HTTPHandler.cpp:544: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c47815 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
13. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
14. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
15. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
16. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
17. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
18. ? @ 0x7f61f2294ac3 in ?
19. ? @ 0x7f61f2326850 in ?
 (version 23.3.2.1)
2024.09.26 23:01:48.171520 [ 39 ] {} <Error> DynamicQueryHandler: Code: 516. DB::Exception: default: Authentication failed: password is incorrect, or there is no user with such name.

If you have installed ClickHouse and forgot password you can reset it in the configuration file.
The password for default user is typically located at /etc/clickhouse-server/users.d/default-password.xml
and deleting this file will reset the password.
See also /etc/clickhouse-server/users.xml on the server where ClickHouse is installed.

. (AUTHENTICATION_FAILED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0xda3792c in /usr/bin/clickhouse
3. ./build/./src/Access/AccessControl.cpp:0: DB::AccessControl::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&) const @ 0x16b7501d in /usr/bin/clickhouse
4. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::Session::authenticate(DB::Credentials const&, Poco::Net::SocketAddress const&) @ 0x17d8d042 in /usr/bin/clickhouse
5. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::HTTPHandler::authenticateUser(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&) @ 0x18c45f2e in /usr/bin/clickhouse
6. ./build/./src/Server/HTTPHandler.cpp:544: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c47815 in /usr/bin/clickhouse
7. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
8. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
9. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
11. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
12. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
13. ? @ 0x7f61f2294ac3 in ?
14. ? @ 0x7f61f2326850 in ?
 (version 23.3.2.1)
2024.09.26 23:04:29.027271 [ 39 ] {} <Error> Access(user directories): from: 192.168.65.1, user: default: Authentication failed: Code: 195. DB::Exception: Connections from 192.168.65.1 are not allowed. (IP_ADDRESS_NOT_ALLOWED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0xda217e4 in /usr/bin/clickhouse
3. ./build/./src/Access/IAccessStorage.cpp:0: DB::IAccessStorage::throwAddressNotAllowed(Poco::Net::IPAddress const&) @ 0x16c1b3d2 in /usr/bin/clickhouse
4. ./build/./src/Access/IAccessStorage.cpp:490: DB::IAccessStorage::authenticateImpl(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c1864c in /usr/bin/clickhouse
5. ./build/./src/Access/IAccessStorage.cpp:468: DB::IAccessStorage::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c1b342 in /usr/bin/clickhouse
6. ./build/./src/Access/MultipleAccessStorage.cpp:342: DB::MultipleAccessStorage::authenticateImpl(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c3cdd1 in /usr/bin/clickhouse
7. ./build/./src/Access/IAccessStorage.cpp:456: DB::IAccessStorage::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool) const @ 0x16c1b30c in /usr/bin/clickhouse
8. ./build/./src/Access/AccessControl.cpp:559: DB::AccessControl::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&) const @ 0x16b74d62 in /usr/bin/clickhouse
9. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::Session::authenticate(DB::Credentials const&, Poco::Net::SocketAddress const&) @ 0x17d8d042 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::HTTPHandler::authenticateUser(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&) @ 0x18c45f2e in /usr/bin/clickhouse
11. ./build/./src/Server/HTTPHandler.cpp:544: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c47815 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
13. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
14. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
15. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
16. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
17. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
18. ? @ 0x7fc8b5c94ac3 in ?
19. ? @ 0x7fc8b5d26850 in ?
 (version 23.3.2.1)
2024.09.26 23:04:29.046397 [ 39 ] {} <Error> DynamicQueryHandler: Code: 516. DB::Exception: default: Authentication failed: password is incorrect, or there is no user with such name.

If you have installed ClickHouse and forgot password you can reset it in the configuration file.
The password for default user is typically located at /etc/clickhouse-server/users.d/default-password.xml
and deleting this file will reset the password.
See also /etc/clickhouse-server/users.xml on the server where ClickHouse is installed.

. (AUTHENTICATION_FAILED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0xda3792c in /usr/bin/clickhouse
3. ./build/./src/Access/AccessControl.cpp:0: DB::AccessControl::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&) const @ 0x16b7501d in /usr/bin/clickhouse
4. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::Session::authenticate(DB::Credentials const&, Poco::Net::SocketAddress const&) @ 0x17d8d042 in /usr/bin/clickhouse
5. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::HTTPHandler::authenticateUser(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&) @ 0x18c45f2e in /usr/bin/clickhouse
6. ./build/./src/Server/HTTPHandler.cpp:544: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c47815 in /usr/bin/clickhouse
7. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
8. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
9. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
11. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
12. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
13. ? @ 0x7fc8b5c94ac3 in ?
14. ? @ 0x7fc8b5d26850 in ?
 (version 23.3.2.1)
2024.09.26 23:04:32.247685 [ 39 ] {} <Error> Access(user directories): from: 192.168.65.1, user: default: Authentication failed: Code: 195. DB::Exception: Connections from 192.168.65.1 are not allowed. (IP_ADDRESS_NOT_ALLOWED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0xda217e4 in /usr/bin/clickhouse
3. ./build/./src/Access/IAccessStorage.cpp:0: DB::IAccessStorage::throwAddressNotAllowed(Poco::Net::IPAddress const&) @ 0x16c1b3d2 in /usr/bin/clickhouse
4. ./build/./src/Access/IAccessStorage.cpp:490: DB::IAccessStorage::authenticateImpl(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c1864c in /usr/bin/clickhouse
5. ./build/./src/Access/IAccessStorage.cpp:468: DB::IAccessStorage::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c1b342 in /usr/bin/clickhouse
6. ./build/./src/Access/MultipleAccessStorage.cpp:342: DB::MultipleAccessStorage::authenticateImpl(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c3cdd1 in /usr/bin/clickhouse
7. ./build/./src/Access/IAccessStorage.cpp:456: DB::IAccessStorage::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool) const @ 0x16c1b30c in /usr/bin/clickhouse
8. ./build/./src/Access/AccessControl.cpp:559: DB::AccessControl::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&) const @ 0x16b74d62 in /usr/bin/clickhouse
9. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::Session::authenticate(DB::Credentials const&, Poco::Net::SocketAddress const&) @ 0x17d8d042 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::HTTPHandler::authenticateUser(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&) @ 0x18c45f2e in /usr/bin/clickhouse
11. ./build/./src/Server/HTTPHandler.cpp:544: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c47815 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
13. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
14. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
15. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
16. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
17. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
18. ? @ 0x7fc8b5c94ac3 in ?
19. ? @ 0x7fc8b5d26850 in ?
 (version 23.3.2.1)
2024.09.26 23:04:32.249259 [ 39 ] {} <Error> DynamicQueryHandler: Code: 516. DB::Exception: default: Authentication failed: password is incorrect, or there is no user with such name.

If you have installed ClickHouse and forgot password you can reset it in the configuration file.
The password for default user is typically located at /etc/clickhouse-server/users.d/default-password.xml
and deleting this file will reset the password.
See also /etc/clickhouse-server/users.xml on the server where ClickHouse is installed.

. (AUTHENTICATION_FAILED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0xda3792c in /usr/bin/clickhouse
3. ./build/./src/Access/AccessControl.cpp:0: DB::AccessControl::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&) const @ 0x16b7501d in /usr/bin/clickhouse
4. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::Session::authenticate(DB::Credentials const&, Poco::Net::SocketAddress const&) @ 0x17d8d042 in /usr/bin/clickhouse
5. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::HTTPHandler::authenticateUser(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&) @ 0x18c45f2e in /usr/bin/clickhouse
6. ./build/./src/Server/HTTPHandler.cpp:544: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c47815 in /usr/bin/clickhouse
7. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
8. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
9. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
11. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
12. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
13. ? @ 0x7fc8b5c94ac3 in ?
14. ? @ 0x7fc8b5d26850 in ?
 (version 23.3.2.1)
2024.09.26 23:13:06.531109 [ 39 ] {} <Error> Access(user directories): from: 192.168.65.1, user: default: Authentication failed: Code: 195. DB::Exception: Connections from 192.168.65.1 are not allowed. (IP_ADDRESS_NOT_ALLOWED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0xda217e4 in /usr/bin/clickhouse
3. ./build/./src/Access/IAccessStorage.cpp:0: DB::IAccessStorage::throwAddressNotAllowed(Poco::Net::IPAddress const&) @ 0x16c1b3d2 in /usr/bin/clickhouse
4. ./build/./src/Access/IAccessStorage.cpp:490: DB::IAccessStorage::authenticateImpl(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c1864c in /usr/bin/clickhouse
5. ./build/./src/Access/IAccessStorage.cpp:468: DB::IAccessStorage::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c1b342 in /usr/bin/clickhouse
6. ./build/./src/Access/MultipleAccessStorage.cpp:342: DB::MultipleAccessStorage::authenticateImpl(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c3cdd1 in /usr/bin/clickhouse
7. ./build/./src/Access/IAccessStorage.cpp:456: DB::IAccessStorage::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool) const @ 0x16c1b30c in /usr/bin/clickhouse
8. ./build/./src/Access/AccessControl.cpp:559: DB::AccessControl::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&) const @ 0x16b74d62 in /usr/bin/clickhouse
9. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::Session::authenticate(DB::Credentials const&, Poco::Net::SocketAddress const&) @ 0x17d8d042 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::HTTPHandler::authenticateUser(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&) @ 0x18c45f2e in /usr/bin/clickhouse
11. ./build/./src/Server/HTTPHandler.cpp:544: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c47815 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
13. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
14. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
15. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
16. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
17. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
18. ? @ 0x7fc8b5c94ac3 in ?
19. ? @ 0x7fc8b5d26850 in ?
 (version 23.3.2.1)
2024.09.26 23:13:06.538506 [ 39 ] {} <Error> DynamicQueryHandler: Code: 516. DB::Exception: default: Authentication failed: password is incorrect, or there is no user with such name.

If you have installed ClickHouse and forgot password you can reset it in the configuration file.
The password for default user is typically located at /etc/clickhouse-server/users.d/default-password.xml
and deleting this file will reset the password.
See also /etc/clickhouse-server/users.xml on the server where ClickHouse is installed.

. (AUTHENTICATION_FAILED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0xda3792c in /usr/bin/clickhouse
3. ./build/./src/Access/AccessControl.cpp:0: DB::AccessControl::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&) const @ 0x16b7501d in /usr/bin/clickhouse
4. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::Session::authenticate(DB::Credentials const&, Poco::Net::SocketAddress const&) @ 0x17d8d042 in /usr/bin/clickhouse
5. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::HTTPHandler::authenticateUser(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&) @ 0x18c45f2e in /usr/bin/clickhouse
6. ./build/./src/Server/HTTPHandler.cpp:544: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c47815 in /usr/bin/clickhouse
7. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
8. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
9. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
11. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
12. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
13. ? @ 0x7fc8b5c94ac3 in ?
14. ? @ 0x7fc8b5d26850 in ?
 (version 23.3.2.1)
2024.09.26 23:15:52.565441 [ 39 ] {} <Error> Access(user directories): from: 192.168.65.1, user: default: Authentication failed: Code: 193. DB::Exception: Invalid credentials. (WRONG_PASSWORD), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::Exception<char const (&) [20], void>(int, char const (&) [20]) @ 0xdd92f36 in /usr/bin/clickhouse
3. ./build/./src/Access/IAccessStorage.cpp:709: DB::IAccessStorage::throwInvalidCredentials() @ 0x16c1b5e4 in /usr/bin/clickhouse
4. ./build/./src/Access/IAccessStorage.cpp:0: DB::IAccessStorage::authenticateImpl(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c18656 in /usr/bin/clickhouse
5. ./build/./src/Access/IAccessStorage.cpp:468: DB::IAccessStorage::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c1b342 in /usr/bin/clickhouse
6. ./build/./src/Access/MultipleAccessStorage.cpp:342: DB::MultipleAccessStorage::authenticateImpl(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c3cdd1 in /usr/bin/clickhouse
7. ./build/./src/Access/IAccessStorage.cpp:456: DB::IAccessStorage::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool) const @ 0x16c1b30c in /usr/bin/clickhouse
8. ./build/./src/Access/AccessControl.cpp:559: DB::AccessControl::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&) const @ 0x16b74d62 in /usr/bin/clickhouse
9. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::Session::authenticate(DB::Credentials const&, Poco::Net::SocketAddress const&) @ 0x17d8d042 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::HTTPHandler::authenticateUser(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&) @ 0x18c45f2e in /usr/bin/clickhouse
11. ./build/./src/Server/HTTPHandler.cpp:544: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c47815 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
13. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
14. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
15. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
16. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
17. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
18. ? @ 0x7f2e3da94ac3 in ?
19. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.26 23:15:52.579849 [ 39 ] {} <Error> DynamicQueryHandler: Code: 516. DB::Exception: default: Authentication failed: password is incorrect, or there is no user with such name.

If you have installed ClickHouse and forgot password you can reset it in the configuration file.
The password for default user is typically located at /etc/clickhouse-server/users.d/default-password.xml
and deleting this file will reset the password.
See also /etc/clickhouse-server/users.xml on the server where ClickHouse is installed.

. (AUTHENTICATION_FAILED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0xda3792c in /usr/bin/clickhouse
3. ./build/./src/Access/AccessControl.cpp:0: DB::AccessControl::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&) const @ 0x16b7501d in /usr/bin/clickhouse
4. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::Session::authenticate(DB::Credentials const&, Poco::Net::SocketAddress const&) @ 0x17d8d042 in /usr/bin/clickhouse
5. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::HTTPHandler::authenticateUser(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&) @ 0x18c45f2e in /usr/bin/clickhouse
6. ./build/./src/Server/HTTPHandler.cpp:544: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c47815 in /usr/bin/clickhouse
7. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
8. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
9. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
11. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
12. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
13. ? @ 0x7f2e3da94ac3 in ?
14. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.26 23:17:42.503184 [ 39 ] {} <Error> Access(user directories): from: 192.168.65.1, user: default: Authentication failed: Code: 193. DB::Exception: Invalid credentials. (WRONG_PASSWORD), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::Exception<char const (&) [20], void>(int, char const (&) [20]) @ 0xdd92f36 in /usr/bin/clickhouse
3. ./build/./src/Access/IAccessStorage.cpp:709: DB::IAccessStorage::throwInvalidCredentials() @ 0x16c1b5e4 in /usr/bin/clickhouse
4. ./build/./src/Access/IAccessStorage.cpp:0: DB::IAccessStorage::authenticateImpl(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c18656 in /usr/bin/clickhouse
5. ./build/./src/Access/IAccessStorage.cpp:468: DB::IAccessStorage::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c1b342 in /usr/bin/clickhouse
6. ./build/./src/Access/MultipleAccessStorage.cpp:342: DB::MultipleAccessStorage::authenticateImpl(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c3cdd1 in /usr/bin/clickhouse
7. ./build/./src/Access/IAccessStorage.cpp:456: DB::IAccessStorage::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool) const @ 0x16c1b30c in /usr/bin/clickhouse
8. ./build/./src/Access/AccessControl.cpp:559: DB::AccessControl::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&) const @ 0x16b74d62 in /usr/bin/clickhouse
9. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::Session::authenticate(DB::Credentials const&, Poco::Net::SocketAddress const&) @ 0x17d8d042 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::HTTPHandler::authenticateUser(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&) @ 0x18c45f2e in /usr/bin/clickhouse
11. ./build/./src/Server/HTTPHandler.cpp:544: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c47815 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
13. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
14. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
15. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
16. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
17. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
18. ? @ 0x7f2e3da94ac3 in ?
19. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.26 23:17:42.505311 [ 39 ] {} <Error> DynamicQueryHandler: Code: 516. DB::Exception: default: Authentication failed: password is incorrect, or there is no user with such name.

If you have installed ClickHouse and forgot password you can reset it in the configuration file.
The password for default user is typically located at /etc/clickhouse-server/users.d/default-password.xml
and deleting this file will reset the password.
See also /etc/clickhouse-server/users.xml on the server where ClickHouse is installed.

. (AUTHENTICATION_FAILED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0xda3792c in /usr/bin/clickhouse
3. ./build/./src/Access/AccessControl.cpp:0: DB::AccessControl::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&) const @ 0x16b7501d in /usr/bin/clickhouse
4. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::Session::authenticate(DB::Credentials const&, Poco::Net::SocketAddress const&) @ 0x17d8d042 in /usr/bin/clickhouse
5. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::HTTPHandler::authenticateUser(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&) @ 0x18c45f2e in /usr/bin/clickhouse
6. ./build/./src/Server/HTTPHandler.cpp:544: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c47815 in /usr/bin/clickhouse
7. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
8. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
9. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
11. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
12. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
13. ? @ 0x7f2e3da94ac3 in ?
14. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.26 23:18:36.658498 [ 39 ] {} <Error> Access(user directories): from: 192.168.65.1, user: default: Authentication failed: Code: 193. DB::Exception: Invalid credentials. (WRONG_PASSWORD), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::Exception<char const (&) [20], void>(int, char const (&) [20]) @ 0xdd92f36 in /usr/bin/clickhouse
3. ./build/./src/Access/IAccessStorage.cpp:709: DB::IAccessStorage::throwInvalidCredentials() @ 0x16c1b5e4 in /usr/bin/clickhouse
4. ./build/./src/Access/IAccessStorage.cpp:0: DB::IAccessStorage::authenticateImpl(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c18656 in /usr/bin/clickhouse
5. ./build/./src/Access/IAccessStorage.cpp:468: DB::IAccessStorage::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c1b342 in /usr/bin/clickhouse
6. ./build/./src/Access/MultipleAccessStorage.cpp:342: DB::MultipleAccessStorage::authenticateImpl(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool, bool) const @ 0x16c3cdd1 in /usr/bin/clickhouse
7. ./build/./src/Access/IAccessStorage.cpp:456: DB::IAccessStorage::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ExternalAuthenticators const&, bool, bool) const @ 0x16c1b30c in /usr/bin/clickhouse
8. ./build/./src/Access/AccessControl.cpp:559: DB::AccessControl::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&) const @ 0x16b74d62 in /usr/bin/clickhouse
9. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::Session::authenticate(DB::Credentials const&, Poco::Net::SocketAddress const&) @ 0x17d8d042 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::HTTPHandler::authenticateUser(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&) @ 0x18c45f2e in /usr/bin/clickhouse
11. ./build/./src/Server/HTTPHandler.cpp:544: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c47815 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
13. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
14. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
15. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
16. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
17. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
18. ? @ 0x7f2e3da94ac3 in ?
19. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.26 23:18:36.661776 [ 39 ] {} <Error> DynamicQueryHandler: Code: 516. DB::Exception: default: Authentication failed: password is incorrect, or there is no user with such name.

If you have installed ClickHouse and forgot password you can reset it in the configuration file.
The password for default user is typically located at /etc/clickhouse-server/users.d/default-password.xml
and deleting this file will reset the password.
See also /etc/clickhouse-server/users.xml on the server where ClickHouse is installed.

. (AUTHENTICATION_FAILED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0xda3792c in /usr/bin/clickhouse
3. ./build/./src/Access/AccessControl.cpp:0: DB::AccessControl::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&) const @ 0x16b7501d in /usr/bin/clickhouse
4. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::Session::authenticate(DB::Credentials const&, Poco::Net::SocketAddress const&) @ 0x17d8d042 in /usr/bin/clickhouse
5. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::HTTPHandler::authenticateUser(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&) @ 0x18c45f2e in /usr/bin/clickhouse
6. ./build/./src/Server/HTTPHandler.cpp:544: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c47815 in /usr/bin/clickhouse
7. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
8. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
9. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
11. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
12. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
13. ? @ 0x7f2e3da94ac3 in ?
14. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.26 23:18:57.819959 [ 39 ] {25fd30d8-abc9-474f-b3a4-5f189c844917} <Error> executeQuery: std::exception. Code: 1001, type: SearchIndexException, e.what() = Error(BAD_ARGUMENTS): Unknown index type for Float32 Vector: MSTG (version 23.3.2.1) (from 192.168.65.1:31275) (in query:  ALTER TABLE default.test ADD VECTOR INDEX vector_index embeddings TYPE MSTG ), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: SearchIndexException::SearchIndexException(Search::ErrorCode, String const&) @ 0x19186c55 in /usr/bin/clickhouse
1. ./build/./contrib/search-index/SearchIndex/VectorSearch.cpp:92: Search::getVectorIndexType(String, Search::DataType const&) @ 0x1ca07ed1 in /usr/bin/clickhouse
2. ./build/./src/VectorIndex/Storages/VIDescriptions.cpp:0: DB::VIDescription::getVectorIndexFromAST(std::shared_ptr<DB::IAST> const&, DB::ColumnsDescription const&, DB::ConstraintsDescription const&, bool) @ 0x19243052 in /usr/bin/clickhouse
3. ./build/./src/Storages/AlterCommands.cpp:0: DB::AlterCommand::apply(DB::StorageInMemoryMetadata&, std::shared_ptr<DB::Context const>) const @ 0x182a97f3 in /usr/bin/clickhouse
4. ./build/./contrib/llvm-project/libcxx/include/__iterator/wrap_iter.h:100: DB::AlterCommands::apply(DB::StorageInMemoryMetadata&, std::shared_ptr<DB::Context const>) const @ 0x182acb6e in /usr/bin/clickhouse
5. ./build/./src/Storages/MergeTree/MergeTreeData.cpp:0: DB::MergeTreeData::checkAlterIsPossible(DB::AlterCommands const&, std::shared_ptr<DB::Context const>) const @ 0x18836d1b in /usr/bin/clickhouse
6. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:1645: DB::InterpreterAlterQuery::executeToTable(DB::ASTAlterQuery&) @ 0x17b0ec20 in /usr/bin/clickhouse
7. ./build/./src/Interpreters/InterpreterAlterQuery.cpp:67: DB::InterpreterAlterQuery::execute() @ 0x17b0b030 in /usr/bin/clickhouse
8. ./build/./src/Interpreters/executeQuery.cpp:0: DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x17f5dd65 in /usr/bin/clickhouse
9. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:612: DB::executeQuery(DB::ReadBuffer&, DB::WriteBuffer&, bool, std::shared_ptr<DB::Context>, std::function<void (DB::QueryResultDetails const&)>, std::optional<DB::FormatSettings> const&) @ 0x17f6a022 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/optional:260: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c4a8e0 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
12. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
13. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
15. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
16. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
17. ? @ 0x7f2e3da94ac3 in ?
18. ? @ 0x7f2e3db26850 in ?

2024.09.26 23:18:57.821568 [ 39 ] {25fd30d8-abc9-474f-b3a4-5f189c844917} <Error> DynamicQueryHandler: std::exception. Code: 1001, type: SearchIndexException, e.what() = Error(BAD_ARGUMENTS): Unknown index type for Float32 Vector: MSTG, Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: SearchIndexException::SearchIndexException(Search::ErrorCode, String const&) @ 0x19186c55 in /usr/bin/clickhouse
1. ./build/./contrib/search-index/SearchIndex/VectorSearch.cpp:92: Search::getVectorIndexType(String, Search::DataType const&) @ 0x1ca07ed1 in /usr/bin/clickhouse
2. ./build/./src/VectorIndex/Storages/VIDescriptions.cpp:0: DB::VIDescription::getVectorIndexFromAST(std::shared_ptr<DB::IAST> const&, DB::ColumnsDescription const&, DB::ConstraintsDescription const&, bool) @ 0x19243052 in /usr/bin/clickhouse
3. ./build/./src/Storages/AlterCommands.cpp:0: DB::AlterCommand::apply(DB::StorageInMemoryMetadata&, std::shared_ptr<DB::Context const>) const @ 0x182a97f3 in /usr/bin/clickhouse
4. ./build/./contrib/llvm-project/libcxx/include/__iterator/wrap_iter.h:100: DB::AlterCommands::apply(DB::StorageInMemoryMetadata&, std::shared_ptr<DB::Context const>) const @ 0x182acb6e in /usr/bin/clickhouse
5. ./build/./src/Storages/MergeTree/MergeTreeData.cpp:0: DB::MergeTreeData::checkAlterIsPossible(DB::AlterCommands const&, std::shared_ptr<DB::Context const>) const @ 0x18836d1b in /usr/bin/clickhouse
6. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:1645: DB::InterpreterAlterQuery::executeToTable(DB::ASTAlterQuery&) @ 0x17b0ec20 in /usr/bin/clickhouse
7. ./build/./src/Interpreters/InterpreterAlterQuery.cpp:67: DB::InterpreterAlterQuery::execute() @ 0x17b0b030 in /usr/bin/clickhouse
8. ./build/./src/Interpreters/executeQuery.cpp:0: DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x17f5dd65 in /usr/bin/clickhouse
9. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:612: DB::executeQuery(DB::ReadBuffer&, DB::WriteBuffer&, bool, std::shared_ptr<DB::Context>, std::function<void (DB::QueryResultDetails const&)>, std::optional<DB::FormatSettings> const&) @ 0x17f6a022 in /usr/bin/clickhouse
10. ./build/./contrib/llvm-project/libcxx/include/optional:260: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c4a8e0 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
12. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
13. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
15. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
16. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
17. ? @ 0x7f2e3da94ac3 in ?
18. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.26 23:20:23.267009 [ 39 ] {68d13f5d-c0bf-45a0-ac23-54615aa55673} <Error> executeQuery: Code: 57. DB::Exception: Table default.test already exists. (TABLE_ALREADY_EXISTS) (version 23.3.2.1) (from 192.168.65.1:57082) (in query:  CREATE TABLE default.test ( id Int64, page_content String, embeddings Array(Float32), CONSTRAINT check_data_length CHECK length(embeddings) = 768 ) ENGINE = MergeTree() ORDER BY id ), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<String&, String, String>(int, FormatStringHelperImpl<std::type_identity<String&>::type, std::type_identity<String>::type, std::type_identity<String>::type>, String&, String&&, String&&) @ 0x15168440 in /usr/bin/clickhouse
3. ./build/./src/Interpreters/InterpreterCreateQuery.cpp:0: DB::InterpreterCreateQuery::doCreateTable(DB::ASTCreateQuery&, DB::InterpreterCreateQuery::TableProperties const&, std::unique_ptr<DB::DDLGuard, std::default_delete<DB::DDLGuard>>&) @ 0x17a961cb in /usr/bin/clickhouse
4. ./build/./src/Interpreters/InterpreterCreateQuery.cpp:0: DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x17a90402 in /usr/bin/clickhouse
5. ./build/./src/Interpreters/InterpreterCreateQuery.cpp:1819: DB::InterpreterCreateQuery::execute() @ 0x17a7ddc1 in /usr/bin/clickhouse
6. ./build/./src/Interpreters/executeQuery.cpp:0: DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x17f5dd65 in /usr/bin/clickhouse
7. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:612: DB::executeQuery(DB::ReadBuffer&, DB::WriteBuffer&, bool, std::shared_ptr<DB::Context>, std::function<void (DB::QueryResultDetails const&)>, std::optional<DB::FormatSettings> const&) @ 0x17f6a022 in /usr/bin/clickhouse
8. ./build/./contrib/llvm-project/libcxx/include/optional:260: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c4a8e0 in /usr/bin/clickhouse
9. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
10. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
11. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
13. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
14. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
15. ? @ 0x7f2e3da94ac3 in ?
16. ? @ 0x7f2e3db26850 in ?

2024.09.26 23:20:23.269632 [ 39 ] {68d13f5d-c0bf-45a0-ac23-54615aa55673} <Error> DynamicQueryHandler: Code: 57. DB::Exception: Table default.test already exists. (TABLE_ALREADY_EXISTS), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<String&, String, String>(int, FormatStringHelperImpl<std::type_identity<String&>::type, std::type_identity<String>::type, std::type_identity<String>::type>, String&, String&&, String&&) @ 0x15168440 in /usr/bin/clickhouse
3. ./build/./src/Interpreters/InterpreterCreateQuery.cpp:0: DB::InterpreterCreateQuery::doCreateTable(DB::ASTCreateQuery&, DB::InterpreterCreateQuery::TableProperties const&, std::unique_ptr<DB::DDLGuard, std::default_delete<DB::DDLGuard>>&) @ 0x17a961cb in /usr/bin/clickhouse
4. ./build/./src/Interpreters/InterpreterCreateQuery.cpp:0: DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x17a90402 in /usr/bin/clickhouse
5. ./build/./src/Interpreters/InterpreterCreateQuery.cpp:1819: DB::InterpreterCreateQuery::execute() @ 0x17a7ddc1 in /usr/bin/clickhouse
6. ./build/./src/Interpreters/executeQuery.cpp:0: DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x17f5dd65 in /usr/bin/clickhouse
7. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:612: DB::executeQuery(DB::ReadBuffer&, DB::WriteBuffer&, bool, std::shared_ptr<DB::Context>, std::function<void (DB::QueryResultDetails const&)>, std::optional<DB::FormatSettings> const&) @ 0x17f6a022 in /usr/bin/clickhouse
8. ./build/./contrib/llvm-project/libcxx/include/optional:260: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c4a8e0 in /usr/bin/clickhouse
9. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
10. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
11. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
13. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
14. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
15. ? @ 0x7f2e3da94ac3 in ?
16. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.26 23:35:56.151669 [ 239 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f2e3da94ac3 in ?
31. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.26 23:38:26.715539 [ 228 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.84 GiB (attempt to allocate chunk of 4360416 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f2e3da94ac3 in ?
31. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.26 23:40:57.925818 [ 232 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360448 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f2e3da94ac3 in ?
31. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.26 23:45:21.706113 [ 234 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.82 GiB (attempt to allocate chunk of 4360368 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f2e3da94ac3 in ?
31. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.26 23:49:45.718195 [ 234 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360336 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f2e3da94ac3 in ?
31. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.26 23:50:23.643046 [ 224 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.84 GiB (attempt to allocate chunk of 4360272 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f2e3da94ac3 in ?
31. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.26 23:52:16.751088 [ 230 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.85 GiB (attempt to allocate chunk of 4360368 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f2e3da94ac3 in ?
31. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.26 23:57:18.857982 [ 233 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360448 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f2e3da94ac3 in ?
31. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.26 23:59:50.302134 [ 228 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.82 GiB (attempt to allocate chunk of 4360448 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f2e3da94ac3 in ?
31. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.27 00:02:20.581044 [ 233 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.82 GiB (attempt to allocate chunk of 4360336 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f2e3da94ac3 in ?
31. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.27 00:04:13.663940 [ 233 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.81 GiB (attempt to allocate chunk of 4360272 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f2e3da94ac3 in ?
31. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.27 00:09:53.716312 [ 239 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.82 GiB (attempt to allocate chunk of 4360368 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f2e3da94ac3 in ?
31. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.27 00:12:24.603571 [ 233 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.82 GiB (attempt to allocate chunk of 4360304 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f2e3da94ac3 in ?
31. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.27 00:14:55.953489 [ 230 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360368 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f2e3da94ac3 in ?
31. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.27 00:15:33.742271 [ 231 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.90 GiB (attempt to allocate chunk of 4360416 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f2e3da94ac3 in ?
31. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.27 02:05:52.753103 [ 224 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.84 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7f2e3da94ac3 in ?
31. ? @ 0x7f2e3db26850 in ?
 (version 23.3.2.1)
2024.09.27 09:03:35.098362 [ 234 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.88 GiB (attempt to allocate chunk of 4222641 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero.: (while reading column ProfileEvent_NetworkSendBytes): (while reading from part /var/lib/clickhouse/store/a51/a51efc65-fc44-4803-9d0c-ce07f9ff06af/202409_1_2273_427/ from mark 0 with max_rows_to_read = 2114): While executing MergeTreeSequentialSource. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. void DB::PODArrayBase<8ul, 4096ul, Allocator<false, false>, 63ul, 64ul>::resize<>(unsigned long) @ 0xda23ab8 in /usr/bin/clickhouse
9. ./build/./src/Common/PODArray.h:389: DB::SerializationNumber<unsigned long>::deserializeBinaryBulk(DB::IColumn&, DB::ReadBuffer&, unsigned long, double) const @ 0x170ce4bb in /usr/bin/clickhouse
10. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:209: DB::ISerialization::deserializeBinaryBulkWithMultipleStreams(COW<DB::IColumn>::immutable_ptr<DB::IColumn>&, unsigned long, DB::ISerialization::DeserializeBinaryBulkSettings&, std::shared_ptr<DB::ISerialization::DeserializeBinaryBulkState>&, std::unordered_map<String, COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>>*) const @ 0x1709e16b in /usr/bin/clickhouse
11. ./build/./src/Storages/MergeTree/MergeTreeReaderWide.cpp:0: DB::MergeTreeReaderWide::readData(DB::NameAndTypePair const&, std::shared_ptr<DB::ISerialization const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn>&, unsigned long, bool, unsigned long, unsigned long, std::unordered_map<String, COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>>&, bool) @ 0x189e4120 in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeReaderWide.cpp:157: DB::MergeTreeReaderWide::readRows(unsigned long, unsigned long, bool, unsigned long, std::vector<COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::allocator<COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>&) @ 0x189e2d93 in /usr/bin/clickhouse
13. ./build/./src/Storages/MergeTree/MergeTreeSequentialSource.cpp:182: DB::MergeTreeSequentialSource::generate() @ 0x189e7608 in /usr/bin/clickhouse
14. ./build/./src/Processors/Chunk.h:90: DB::ISource::tryGenerate() @ 0x18cd2395 in /usr/bin/clickhouse
15. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::ISource::work() @ 0x18cd1ec5 in /usr/bin/clickhouse
16. ./build/./src/Processors/Executors/ExecutionThreadContext.cpp:0: DB::ExecutionThreadContext::executeTask() @ 0x18ce950c in /usr/bin/clickhouse
17. ./build/./src/Processors/Executors/PipelineExecutor.cpp:248: DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x18cdfd7b in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/atomic:958: DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x18cdf8a9 in /usr/bin/clickhouse
19. ./build/./src/Processors/Executors/PullingPipelineExecutor.cpp:54: DB::PullingPipelineExecutor::pull(DB::Chunk&) @ 0x18cecf48 in /usr/bin/clickhouse
20. ./build/./src/Processors/Executors/PullingPipelineExecutor.cpp:0: DB::PullingPipelineExecutor::pull(DB::Block&) @ 0x18ced130 in /usr/bin/clickhouse
21. ./build/./src/Storages/MergeTree/MergeTask.cpp:521: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::executeImpl() @ 0x18811eb4 in /usr/bin/clickhouse
22. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
25. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
26. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
27. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
28. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
29. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
30. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
31. ? @ 0x7f2e3da94ac3 in ?
 (version 23.3.2.1)
2024.10.02 22:43:14.754028 [ 39 ] {08fcea98-2dc7-494a-aa2d-9ce86b38c25b} <Error> executeQuery: Code: 62. DB::Exception: Not support distance function without ORDER BY clause. (SYNTAX_ERROR) (version 23.3.2.1) (from 192.168.65.1:61870) (in query:  SELECT keywords, distance(embeddings, [0.03699438, -0.040089518, -0.064849064, -0.016746355, 0.053397097, 0.010999547, 0.0036444569, -0.01743426, 0.021367166, 0.02756787, -0.055426203, 0.023027187, -0.023926627, -0.06467651, -0.018086523, -0.030773327, -0.027391966, 0.043407705, 0.004129164, -0.01620058, -0.011294144, 0.031303287, 0.019731497, 0.0047164783, 0.053746738, -0.04445773, -0.011030656, -0.03618617, -0.020795159, 0.023311386, -0.038536396, 0.048730165, 0.0007542536, -0.0151743395, 0.0003700302, -0.057269022, -0.011442179, 0.064925924, 0.004469991, 0.009488511, 0.023872864, -0.08210364, -0.020039598, 0.015152989, -0.03455951, -0.054042786, -0.05828221, -0.0056554046, 0.005865583, -0.071073085, 0.04425871, 0.014148037, 0.06189315, 0.03481871, 0.0073301676, -0.032488443, 0.038492322, 0.011572406, 0.019825239, 0.026526352, 0.012632791, -0.011928984, 0.016074032, 0.055432256, -0.0065144887, -0.044166185, -0.022224836, -0.0008785451, 0.040924825, -0.012424532, -0.0029351765, -0.056494884, 0.025244974, -0.011784074, -0.052461334, -0.11254319, -0.019410562, 0.044913128, 0.0023883644, 0.026291382, -0.008406303, -0.043705024, -0.08495333, -0.027652573, -0.07519549, 0.033721145, -0.009692825, -0.023569351, -0.035907727, 0.018102072, -0.038564023, -0.014759392, 0.057618953, -0.044333704, -0.039962053, 0.105801076, -0.012327563, -0.0054806517, 0.007520503, -0.058296427, 0.018502992, 0.0036653425, -0.05797612, 0.058554575, 0.02739057, 0.076447316, -0.01298798, 0.050707407, -0.011958466, 0.05107749, -0.07577634, -0.037861608, 0.036007203, -0.058324285, 0.045401957, -0.02501924, -0.017445616, 0.046888944, 0.05114052, 0.038307942, 0.02882377, 0.037953768, 0.0742223, 0.004274218, 0.0088198865, 0.024424488, -0.0004095162, 0.043095827, 0.03682955, 0.014330134, 0.003208707, -0.040602606, -0.040088546, 0.026590066, 0.046391156, 0.07367876, 0.023998376, -0.025120897, 0.0035239793, -0.013285776, -0.008768575, 0.02016276, 0.0010779889, 0.043165553, 0.001310545, 0.042327337, -0.01885023, 0.023272468, 0.08018527, -0.051045116, -0.034667443, 0.00020957118, -0.06712201, -0.02379333, 0.03336453, 0.008412936, -0.03273267, 0.050669704, 0.09437578, 0.06589382, 0.039406676, 0.018450612, 0.028625293, 0.0046728887, -0.049847394, 0.015251399, -0.006554311, -0.016548678, 0.023529349, 0.0043250974, -0.0021488704, 0.089529626, -0.03804672, -0.024356285, -0.008075331, -0.015903907, -0.0058758804, 0.0004073673, -0.030676642, -0.03656273, -0.012119554, 0.004015856, -0.008629824, 0.026174987, 0.011489186, -0.021910496, 0.07312163, -0.017047336, -0.014005227, 0.0030832523, -0.02577037, -0.015560933, -0.0417329, -0.028640663, -0.023765663, 0.04488632, -0.009398627, 0.007038831, 0.035848163, -0.046222135, -0.0021941354, 0.06706701, 0.0033863278, 0.0067402194, 0.045719255, -0.0041433815, 0.026703075, -0.005650576, -0.021597635, 0.042490955, -0.019296128, 0.011165145, -0.043809336, -0.0064701163, 0.018556248, -0.009519116, 0.027139805, 0.016593011, -0.006007977, -0.029470269, -0.03905902, 0.035240978, -0.033909567, -0.0024433252, -0.004952422, 0.06523346, -0.045307893, 0.0042731264, 0.035185263, -0.027283058, -0.01846644, 0.09376739, 0.016555505, -0.0017514607, 0.078591175, -0.014939238, 0.018160552, 0.032782376, -0.006694654, 0.033134095, -0.008662764, 0.020671666, -0.021540483, 0.024259139, -0.042602215, -0.08840811, -0.015961371, 0.064084016, 0.008771312, 0.031071763, 0.0013063564, -0.016081853, -0.0035057603, -0.0062895217, -0.04520596, 0.050900925, -0.029725403, 0.0041065672, -0.007854125, 0.013407516, 0.020131478, 0.025780268, -0.003840437, -0.01289965, -0.02179761, -0.024918098, 0.05336189, -0.050594635, 0.024162801, 0.012208516, 0.025960539, 0.007266379, 0.031318214, 0.013826131, 0.015230341, 0.03474755, -0.0105011435, 0.043871213, 0.03930262, -0.053653263, 0.0060727037, 0.053199995, 0.007826698, -0.059909213, -0.014090388, -0.0092615895, -0.04947403, -0.02529563, -0.0375785, -0.045861304, -0.048001856, -0.024553498, -0.009206843, -0.032012995, -0.032333445, 0.023160346, 0.02796993, 0.03366755, 0.0019476394, -0.08939203, -0.009866293, -0.0569794, 0.03520322, -0.11132757, 0.024057008, -0.0031262173, -0.04478177, -0.057226628, 0.018165773, 0.05607867, 0.024768917, -0.03530705, -0.04702305, -0.0009087978, 0.032788023, 0.0135077955, -0.034628253, 0.0233885, -0.07506211, 0.03642665, 0.028317226, 0.088546015, 0.009478744, -0.03942127, 0.0111533, 0.07658725, -0.020805119, 0.01813683, -0.020707158, 0.034090456, -0.0041516856, -0.0077053616, -0.03633104, 0.025105936, 0.021863556, 0.026916882, -0.0981228, -0.004523251, -0.037712988, 0.018456535, 0.016205374, 0.03227894, -0.030527158, -0.053949613, 0.023964545, 0.02269021, -0.022293461, 0.03367573, 0.085209906, 0.060796294, 0.010838065, 0.12902263, -0.01694008, 0.018405084, -0.0049455087, -0.042993665, -0.01019101, -0.0033217429, 0.055764314, -0.028230106, 0.000730329, 0.026552994, 0.003957798, -0.034522787, -0.024497991, 0.014242735, -0.023903621, 0.01507725, 0.016007833, 0.03621179, -0.0085084895, -0.02287522, 0.030702623, -0.0030377535, -0.0053026974, -0.0034253176, -0.06186622, -0.063173644, -0.010933676, 0.011757615, -0.042364713, -0.018662458, 0.015349212, 0.01326398, 0.05749138, -0.011801498, 0.030677686, 0.009742563, -0.013932522, 0.0440089, -0.04352725, 0.03446055, 0.04937953, -0.015561065, 0.05242365, 0.011058239, -0.012140186, -0.047183063, 0.025291087, 0.01965361, 0.006409989, -0.024329515, -0.033837937, -0.008912799, -0.00018269588, 0.0007890399, -0.0021570618, -0.009216193, -0.035334956, 0.008073508, 0.013990948, 0.020804781, 0.039264835, -0.10574533, -0.022850022, -0.025708204, 0.013246247, -0.017094923, -0.03435561, 0.02929498, -0.016654646, 0.023595568, 0.021752797, -0.017676894, -0.06941912, -0.04577211, 0.023971343, -0.008513252, 0.006589605, 0.0050590597, 0.017276702, 0.002541564, -0.02288965, -0.032129847, -0.03235706, -0.04756713, 0.01130429, 0.025885917, 0.00027474246, -0.011692397, 0.052505635, -0.016754206, 0.007739998, 0.00031204932, -0.011126217, -0.04999242, -0.020067757, -0.02679827, 0.015927594, -0.073336825, 0.013469353, -0.0580917, -0.043998066, -0.011027563, -0.039664164, -0.005749623, 0.018272659, 0.07282008, -0.028953746, 0.008125625, 0.029799266, 0.00930479, -0.0052663796, -0.108113006, 0.011571947, -0.0032099118, 0.028925946, 0.00040189954, -0.010614756, 0.023520697, 0.039298646, 0.0041626547, 0.020949168, -0.017950444, 0.021378938, -0.0038062378, -0.06714989, 0.017683938, -0.051217444, -0.024703328, -0.0078828, 0.03254166, 0.0010553305, 0.03319834, -0.022770675, 0.021067346, -0.0009863164, 0.048314497, -0.037366938, 0.072503954, -0.032973994, -0.04739449, -0.05867264, -0.061556213, -0.01490505, 0.009413129, 0.013524396, 0.04195668, 0.009708794, 0.0115918955, -0.030000556, -0.003406723, 0.0006018104, -0.013914035, 0.056682464, -0.08217875, -0.001219442, 0.034592006, -0.01170216, -0.024157742, -0.015376954, -0.02845654, 0.0035460761, -0.012266723, 0.057166953, -0.02048005, 0.037438408, -0.0045330795, -0.00031943165, -0.01631846, -0.01245495, -0.038763992, -0.078346975, -0.002038096, 0.019253433, -0.08414125, 0.038358845, 0.036325462, -0.041629266, 0.013063169, -0.015793618, 0.05837563, -0.0706814, -0.026032368, 0.015781965, 0.03436528, 0.013275698, -0.020307407, 0.004132362, -0.0439121, 0.082610644, -0.009417679, 0.017384512, 0.068277545, -0.017448483, 0.005332682, 0.010497486, -0.05917456, -0.009461004, -0.027491445, -0.039685093, 0.014020787, 0.042099625, -0.013748909, 0.00429445, -0.013879585, 0.00036192214, 0.0014250231, 0.015838409, -0.005729923, -0.029609395, -0.012657533, -0.009822376, -0.028636726, 0.06367585, 0.009841709, -0.0040893545, -0.0016083913, 0.045984656, -0.055777512, -0.022561613, -0.05726247, 0.06032096, 0.031847216, 0.078910634, -0.024023477, -0.025755208, -0.033546302, -0.030200802, -0.004976394, 0.058450643, 0.024584055, 0.01462004, 0.06358059, -0.004168876, 0.030705746, 0.03965261, 0.06868595, 0.052272663, -0.002557367, -0.017804824, 0.014052447, -0.011136537, -0.006610256, 0.02557463, 0.023084363, 0.037227098, -0.019117171, -0.0076187295, -0.01615469, 0.014430799, -0.06576304, 0.049786743, -0.0141218025, 0.0027244764, 0.03613718, -0.018096369, 0.0052798274, 0.020776577, 0.030618723, -0.008130019, -0.038449273, 0.015559043, -0.052439686, -0.022446053, -0.0300201, 0.062337894, -0.03221063, -0.02144594, -0.011290945, -0.013556042, 0.02742661, 0.02013747, -0.023218554, 0.009589082, 0.016736591, -0.0005807484, 0.00013909032, 0.085036464, 0.038106408, 0.021597024, 0.02178403, 0.018013647, 0.009632963, -0.025870504, 0.0063394234, -0.021679161, 0.011654006, 0.00762929, -0.01497246, -0.076975584, 0.005404775, 0.036844432, -0.02355763, -0.015521761, 0.05999857, 0.009588825, -0.09448155, -0.0077713546, -0.011029748, 0.0030538219, 0.012367527, 0.030350346, -0.049445428, 0.0039242823, -0.013819624, -0.03415084, -0.008133336, 0.0878895, -0.0046882555, -0.049495995, 0.008406013, -0.017823445, -0.0021215093, -0.027740017, -0.014728463, -0.027044287, -0.058870573, -0.031761892, 0.00088360155, -0.04108465, 0.08357774, 0.028615639, -0.017514495, 0.020811848, -0.001628287, -0.01244699, -0.0068482254, 0.015220526, -0.0013649927, -0.0026609127, 0.031167706, -0.0005389089, 0.03932212, -0.014842763, 0.072785966, -0.009019472, 0.013104402, -0.030209247, -0.016053982, 0.054317616, 0.0021747216, -0.046264, 0.02437336, 0.07458065, 0.03125905, -0.089877725, -0.022951107, 0.03068962, 0.031759605, -0.028261038, -0.061399035, -0.0026744113, 0.03077485, 0.05964815, 0.02123617, 0.006204028, 0.017600993, 0.019899257, 0.036894497, 0.047271047, -0.021611892, -0.027172612, 0.04521311, -0.015572926, -0.026682043, 0.004856933, 0.02866872, -0.0033389323, 0.07078031, 0.051183514, 0.030393064, 0.065503135, -0.022367178, -0.0632898, 0.045625035, -0.015985426, -0.0025249105, -0.007823751, 0.0039300434, 0.05045026, -0.04638493, 0.0030467995, 0.01687344, -0.044307783, 0.06332948, 0.011980257, 0.048224032, 0.0012050231, -0.11291813, -0.020754946, 0.00052623695, 0.0025405032, 0.05242986, 0.029035084, -0.010089483, -0.014904519, -0.0036358065, 0.004798264, -0.0036547978, -0.036878455, -0.023304243, -0.03088867, 0.047965094, 0.05376685, -0.046020027, -0.030424504, 0.0015687464, -0.021906087, 0.0071473517, -0.033671364, 0.0064924904, 0.0054803286, 0.04393574, -0.014034028, -0.008778806, -0.024371734, 0.02096771]) as dist FROM default.keywords FORMAT Native), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::Exception<String&>(int, FormatStringHelperImpl<std::type_identity<String&>::type>, String&) @ 0xdd9bba4 in /usr/bin/clickhouse
3. ./build/./src/Interpreters/TreeRewriter.cpp:941: DB::TreeRewriter::analyzeSelect(std::shared_ptr<DB::IAST>&, DB::TreeRewriterResult&&, DB::SelectQueryOptions const&, std::vector<DB::TableWithColumnNamesAndTypes, std::allocator<DB::TableWithColumnNamesAndTypes>> const&, std::vector<String, std::allocator<String>> const&, std::shared_ptr<DB::TableJoin>, bool, std::unordered_map<String, String, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, String>>>, std::unordered_map<String, String, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, String>>>) const @ 0x17ec58e7 in /usr/bin/clickhouse
4. ./build/./contrib/llvm-project/libcxx/include/__utility/swap.h:37: DB::InterpreterSelectQuery::InterpreterSelectQuery(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context> const&, std::optional<DB::Pipe>, std::shared_ptr<DB::IStorage> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::shared_ptr<DB::PreparedSets>)::$_0::operator()(bool) const @ 0x17c0ac9c in /usr/bin/clickhouse
5. ./build/./src/Interpreters/InterpreterSelectQuery.cpp:0: DB::InterpreterSelectQuery::InterpreterSelectQuery(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context> const&, std::optional<DB::Pipe>, std::shared_ptr<DB::IStorage> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::shared_ptr<DB::PreparedSets>) @ 0x17c07875 in /usr/bin/clickhouse
6. ./build/./contrib/llvm-project/libcxx/include/optional:260: DB::InterpreterSelectQuery::InterpreterSelectQuery(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x17c04c31 in /usr/bin/clickhouse
7. ./build/./src/Interpreters/InterpreterSelectWithUnionQuery.cpp:257: DB::InterpreterSelectWithUnionQuery::buildCurrentChildInterpreter(std::shared_ptr<DB::IAST> const&, std::vector<String, std::allocator<String>> const&) @ 0x17c9093a in /usr/bin/clickhouse
8. ./build/./src/Interpreters/InterpreterSelectWithUnionQuery.cpp:152: DB::InterpreterSelectWithUnionQuery::InterpreterSelectWithUnionQuery(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context>, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x17c8e888 in /usr/bin/clickhouse
9. ./build/./contrib/llvm-project/libcxx/include/vector:434: std::__unique_if<DB::InterpreterSelectWithUnionQuery>::__unique_single std::make_unique[abi:v15000]<DB::InterpreterSelectWithUnionQuery, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::Context>&, DB::SelectQueryOptions const&>(std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::Context>&, DB::SelectQueryOptions const&) @ 0x17bcce93 in /usr/bin/clickhouse
10. ./build/./src/Interpreters/InterpreterFactory.cpp:0: DB::InterpreterFactory::get(std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::Context>, DB::SelectQueryOptions const&) @ 0x17bcc0b5 in /usr/bin/clickhouse
11. ./build/./src/Interpreters/executeQuery.cpp:0: DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x17f5cf2c in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:612: DB::executeQuery(DB::ReadBuffer&, DB::WriteBuffer&, bool, std::shared_ptr<DB::Context>, std::function<void (DB::QueryResultDetails const&)>, std::optional<DB::FormatSettings> const&) @ 0x17f6a022 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/optional:260: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c4a8e0 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
15. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
16. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
18. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
19. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
20. ? @ 0x7fbe27a94ac3 in ?
21. ? @ 0x7fbe27b26850 in ?

2024.10.02 22:43:14.758495 [ 39 ] {08fcea98-2dc7-494a-aa2d-9ce86b38c25b} <Error> DynamicQueryHandler: Code: 62. DB::Exception: Not support distance function without ORDER BY clause. (SYNTAX_ERROR), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. DB::Exception::Exception<String&>(int, FormatStringHelperImpl<std::type_identity<String&>::type>, String&) @ 0xdd9bba4 in /usr/bin/clickhouse
3. ./build/./src/Interpreters/TreeRewriter.cpp:941: DB::TreeRewriter::analyzeSelect(std::shared_ptr<DB::IAST>&, DB::TreeRewriterResult&&, DB::SelectQueryOptions const&, std::vector<DB::TableWithColumnNamesAndTypes, std::allocator<DB::TableWithColumnNamesAndTypes>> const&, std::vector<String, std::allocator<String>> const&, std::shared_ptr<DB::TableJoin>, bool, std::unordered_map<String, String, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, String>>>, std::unordered_map<String, String, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, String>>>) const @ 0x17ec58e7 in /usr/bin/clickhouse
4. ./build/./contrib/llvm-project/libcxx/include/__utility/swap.h:37: DB::InterpreterSelectQuery::InterpreterSelectQuery(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context> const&, std::optional<DB::Pipe>, std::shared_ptr<DB::IStorage> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::shared_ptr<DB::PreparedSets>)::$_0::operator()(bool) const @ 0x17c0ac9c in /usr/bin/clickhouse
5. ./build/./src/Interpreters/InterpreterSelectQuery.cpp:0: DB::InterpreterSelectQuery::InterpreterSelectQuery(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context> const&, std::optional<DB::Pipe>, std::shared_ptr<DB::IStorage> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::shared_ptr<DB::PreparedSets>) @ 0x17c07875 in /usr/bin/clickhouse
6. ./build/./contrib/llvm-project/libcxx/include/optional:260: DB::InterpreterSelectQuery::InterpreterSelectQuery(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x17c04c31 in /usr/bin/clickhouse
7. ./build/./src/Interpreters/InterpreterSelectWithUnionQuery.cpp:257: DB::InterpreterSelectWithUnionQuery::buildCurrentChildInterpreter(std::shared_ptr<DB::IAST> const&, std::vector<String, std::allocator<String>> const&) @ 0x17c9093a in /usr/bin/clickhouse
8. ./build/./src/Interpreters/InterpreterSelectWithUnionQuery.cpp:152: DB::InterpreterSelectWithUnionQuery::InterpreterSelectWithUnionQuery(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context>, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x17c8e888 in /usr/bin/clickhouse
9. ./build/./contrib/llvm-project/libcxx/include/vector:434: std::__unique_if<DB::InterpreterSelectWithUnionQuery>::__unique_single std::make_unique[abi:v15000]<DB::InterpreterSelectWithUnionQuery, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::Context>&, DB::SelectQueryOptions const&>(std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::Context>&, DB::SelectQueryOptions const&) @ 0x17bcce93 in /usr/bin/clickhouse
10. ./build/./src/Interpreters/InterpreterFactory.cpp:0: DB::InterpreterFactory::get(std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::Context>, DB::SelectQueryOptions const&) @ 0x17bcc0b5 in /usr/bin/clickhouse
11. ./build/./src/Interpreters/executeQuery.cpp:0: DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x17f5cf2c in /usr/bin/clickhouse
12. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:612: DB::executeQuery(DB::ReadBuffer&, DB::WriteBuffer&, bool, std::shared_ptr<DB::Context>, std::function<void (DB::QueryResultDetails const&)>, std::optional<DB::FormatSettings> const&) @ 0x17f6a022 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/optional:260: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::optional<DB::CurrentThread::QueryScope>&) @ 0x18c4a8e0 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:290: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x18c4253c in /usr/bin/clickhouse
15. ./build/./base/poco/Foundation/include/Poco/AutoPtr.h:205: DB::HTTPServerConnection::run() @ 0x18ca9b00 in /usr/bin/clickhouse
16. ./build/./base/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x1baf0447 in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: Poco::Net::TCPServerDispatcher::run() @ 0x1baf066d in /usr/bin/clickhouse
18. ./build/./base/poco/Foundation/src/ThreadPool.cpp:202: Poco::PooledThread::run() @ 0x1bc8aac7 in /usr/bin/clickhouse
19. ./build/./base/poco/Foundation/include/Poco/SharedPtr.h:139: Poco::ThreadImpl::runnableEntry(void*) @ 0x1bc88f63 in /usr/bin/clickhouse
20. ? @ 0x7fbe27a94ac3 in ?
21. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.02 23:17:12.797191 [ 281 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.84 GiB (attempt to allocate chunk of 4360432 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.02 23:19:43.571018 [ 281 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.84 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.02 23:24:45.508666 [ 253 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.84 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.02 23:26:38.751863 [ 236 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.85 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.02 23:27:17.064060 [ 238 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.80 GiB (attempt to allocate chunk of 4360368 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.02 23:29:47.711820 [ 224 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.82 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.02 23:32:18.508434 [ 234 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.02 23:34:49.529560 [ 230 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.85 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.02 23:36:42.559438 [ 245 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.02 23:39:13.303580 [ 239 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.02 23:43:38.065800 [ 257 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.02 23:45:30.830469 [ 245 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.82 GiB (attempt to allocate chunk of 4360464 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.02 23:46:09.549514 [ 240 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.81 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.02 23:49:18.236452 [ 258 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4218217 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero.: (while reading column ProfileEvent_CreatedLogEntryForBuildVIndex): (while reading from part /var/lib/clickhouse/store/a51/a51efc65-fc44-4803-9d0c-ce07f9ff06af/202410_2302_2837_107/ from mark 0 with max_rows_to_read = 2114): While executing MergeTreeSequentialSource. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:80: DB::CompressedReadBufferFromFile::readBig(char*, unsigned long) @ 0x16f2bbf3 in /usr/bin/clickhouse
10. ./build/./src/DataTypes/Serializations/SerializationNumber.cpp:155: DB::SerializationNumber<unsigned long>::deserializeBinaryBulk(DB::IColumn&, DB::ReadBuffer&, unsigned long, double) const @ 0x170ce4d7 in /usr/bin/clickhouse
11. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:209: DB::ISerialization::deserializeBinaryBulkWithMultipleStreams(COW<DB::IColumn>::immutable_ptr<DB::IColumn>&, unsigned long, DB::ISerialization::DeserializeBinaryBulkSettings&, std::shared_ptr<DB::ISerialization::DeserializeBinaryBulkState>&, std::unordered_map<String, COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>>*) const @ 0x1709e16b in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeReaderWide.cpp:0: DB::MergeTreeReaderWide::readData(DB::NameAndTypePair const&, std::shared_ptr<DB::ISerialization const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn>&, unsigned long, bool, unsigned long, unsigned long, std::unordered_map<String, COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>>&, bool) @ 0x189e4120 in /usr/bin/clickhouse
13. ./build/./src/Storages/MergeTree/MergeTreeReaderWide.cpp:157: DB::MergeTreeReaderWide::readRows(unsigned long, unsigned long, bool, unsigned long, std::vector<COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::allocator<COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>&) @ 0x189e2d93 in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/MergeTreeSequentialSource.cpp:182: DB::MergeTreeSequentialSource::generate() @ 0x189e7608 in /usr/bin/clickhouse
15. ./build/./src/Processors/Chunk.h:90: DB::ISource::tryGenerate() @ 0x18cd2395 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::ISource::work() @ 0x18cd1ec5 in /usr/bin/clickhouse
17. ./build/./src/Processors/Executors/ExecutionThreadContext.cpp:0: DB::ExecutionThreadContext::executeTask() @ 0x18ce950c in /usr/bin/clickhouse
18. ./build/./src/Processors/Executors/PipelineExecutor.cpp:248: DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x18cdfd7b in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/atomic:958: DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x18cdf8a9 in /usr/bin/clickhouse
20. ./build/./src/Processors/Executors/PullingPipelineExecutor.cpp:54: DB::PullingPipelineExecutor::pull(DB::Chunk&) @ 0x18cecf48 in /usr/bin/clickhouse
21. ./build/./src/Processors/Executors/PullingPipelineExecutor.cpp:0: DB::PullingPipelineExecutor::pull(DB::Block&) @ 0x18ced130 in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:521: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::executeImpl() @ 0x18811eb4 in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
25. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
26. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
27. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
29. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
30. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
31. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.02 23:53:41.597942 [ 234 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.82 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.02 23:56:12.746647 [ 281 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.81 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.03 00:01:14.708777 [ 247 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.88 GiB (attempt to allocate chunk of 4360432 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.03 00:03:45.684705 [ 235 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.03 00:07:31.867902 [ 239 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.84 GiB (attempt to allocate chunk of 4360368 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.03 00:08:09.710573 [ 257 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.89 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.03 00:10:02.809477 [ 224 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.89 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.03 00:14:26.804156 [ 281 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.03 00:15:04.733314 [ 257 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.85 GiB (attempt to allocate chunk of 4196403 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero.: (while reading column ProfileEvent_SelectedBytes): (while reading from part /var/lib/clickhouse/store/a51/a51efc65-fc44-4803-9d0c-ce07f9ff06af/202410_2302_3042_148/ from mark 0 with max_rows_to_read = 2114): While executing MergeTreeSequentialSource. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:0: CurrentMemoryTracker::realloc(long, long) @ 0x1271b089 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:141: Allocator<false, false>::realloc(void*, unsigned long, unsigned long, unsigned long) @ 0x12718827 in /usr/bin/clickhouse
8. ./build/./src/Common/PODArray.h:0: DB::CompressedReadBufferBase::readCompressedData(unsigned long&, unsigned long&, bool) @ 0x16f29d56 in /usr/bin/clickhouse
9. ./build/./src/Compression/CompressedReadBufferFromFile.cpp:122: DB::CompressedReadBufferFromFile::readBig(char*, unsigned long) @ 0x16f2ba1a in /usr/bin/clickhouse
10. ./build/./src/DataTypes/Serializations/SerializationNumber.cpp:155: DB::SerializationNumber<unsigned long>::deserializeBinaryBulk(DB::IColumn&, DB::ReadBuffer&, unsigned long, double) const @ 0x170ce4d7 in /usr/bin/clickhouse
11. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:209: DB::ISerialization::deserializeBinaryBulkWithMultipleStreams(COW<DB::IColumn>::immutable_ptr<DB::IColumn>&, unsigned long, DB::ISerialization::DeserializeBinaryBulkSettings&, std::shared_ptr<DB::ISerialization::DeserializeBinaryBulkState>&, std::unordered_map<String, COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>>*) const @ 0x1709e16b in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeReaderWide.cpp:0: DB::MergeTreeReaderWide::readData(DB::NameAndTypePair const&, std::shared_ptr<DB::ISerialization const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn>&, unsigned long, bool, unsigned long, unsigned long, std::unordered_map<String, COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::hash<String>, std::equal_to<String>, std::allocator<std::pair<String const, COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>>&, bool) @ 0x189e4120 in /usr/bin/clickhouse
13. ./build/./src/Storages/MergeTree/MergeTreeReaderWide.cpp:157: DB::MergeTreeReaderWide::readRows(unsigned long, unsigned long, bool, unsigned long, std::vector<COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::allocator<COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>&) @ 0x189e2d93 in /usr/bin/clickhouse
14. ./build/./src/Storages/MergeTree/MergeTreeSequentialSource.cpp:182: DB::MergeTreeSequentialSource::generate() @ 0x189e7608 in /usr/bin/clickhouse
15. ./build/./src/Processors/Chunk.h:90: DB::ISource::tryGenerate() @ 0x18cd2395 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/optional:344: DB::ISource::work() @ 0x18cd1ec5 in /usr/bin/clickhouse
17. ./build/./src/Processors/Executors/ExecutionThreadContext.cpp:0: DB::ExecutionThreadContext::executeTask() @ 0x18ce950c in /usr/bin/clickhouse
18. ./build/./src/Processors/Executors/PipelineExecutor.cpp:248: DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x18cdfd7b in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/atomic:958: DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x18cdf8a9 in /usr/bin/clickhouse
20. ./build/./src/Processors/Executors/PullingPipelineExecutor.cpp:54: DB::PullingPipelineExecutor::pull(DB::Chunk&) @ 0x18cecf48 in /usr/bin/clickhouse
21. ./build/./src/Processors/Executors/PullingPipelineExecutor.cpp:0: DB::PullingPipelineExecutor::pull(DB::Block&) @ 0x18ced130 in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:521: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::executeImpl() @ 0x18811eb4 in /usr/bin/clickhouse
23. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
25. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
26. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
27. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
29. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
30. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
31. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
 (version 23.3.2.1)
2024.10.03 00:16:57.984320 [ 237 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360432 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.03 00:19:29.109854 [ 282 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.84 GiB (attempt to allocate chunk of 4360368 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
2024.10.03 00:21:59.584370 [ 234 ] {} <Error> void DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(DB::TaskRuntimeDataPtr) [Queue = DB::DynamicRuntimeQueue]: Code: 241. DB::Exception: Memory limit (total) exceeded: would use 1.83 GiB (attempt to allocate chunk of 4360400 bytes), maximum: 1.80 GiB. OvercommitTracker decision: Memory overcommit isn't used. Waiting time or overcommit denominator are set to zero. (MEMORY_LIMIT_EXCEEDED), Stack trace (when copying this message, always include the lines below):

0. ./build/./contrib/llvm-project/libcxx/include/exception:134: Poco::Exception::Exception(String const&, int) @ 0x1bc30d93 in /usr/bin/clickhouse
1. ./build/./src/Common/Exception.cpp:91: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x12743e35 in /usr/bin/clickhouse
2. ./build/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const*, char const*, String, long&, String, char const*, std::basic_string_view<char, std::char_traits<char>>>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<char const*>::type, std::type_identity<String>::type, std::type_identity<long&>::type, std::type_identity<String>::type, std::type_identity<char const*>::type, std::type_identity<std::basic_string_view<char, std::char_traits<char>>>::type>, char const*&&, char const*&&, String&&, long&, String&&, char const*&&, std::basic_string_view<char, std::char_traits<char>>&&) @ 0x1274ea78 in /usr/bin/clickhouse
3. ./build/./src/Common/MemoryTracker.cpp:0: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274de32 in /usr/bin/clickhouse
4. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
5. ./build/./src/Common/MemoryTracker.cpp:338: MemoryTracker::allocImpl(long, bool, MemoryTracker*) @ 0x1274d979 in /usr/bin/clickhouse
6. ./build/./src/Common/CurrentMemoryTracker.cpp:59: CurrentMemoryTracker::alloc(long) @ 0x1271af75 in /usr/bin/clickhouse
7. ./build/./src/Common/Allocator.h:103: Allocator<false, false>::alloc(unsigned long, unsigned long) @ 0x12717fc4 in /usr/bin/clickhouse
8. ./build/./src/IO/BufferWithOwnMemory.h:130: DB::Memory<Allocator<false, false>>::alloc(unsigned long) @ 0x1278cf48 in /usr/bin/clickhouse
9. ./build/./src/IO/BufferWithOwnMemory.h:159: DB::CompressedWriteBuffer::CompressedWriteBuffer(DB::WriteBuffer&, std::shared_ptr<DB::ICompressionCodec>, unsigned long) @ 0x16f2c495 in /usr/bin/clickhouse
10. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterOnDisk.cpp:70: DB::MergeTreeDataPartWriterOnDisk::Stream::Stream(String const&, std::shared_ptr<DB::IDataPartStorage> const&, String const&, String const&, String const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, std::shared_ptr<DB::ICompressionCodec> const&, unsigned long, DB::WriteSettings const&) @ 0x188f4251 in /usr/bin/clickhouse
11. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: std::__unique_if<DB::MergeTreeDataPartWriterOnDisk::Stream>::__unique_single std::make_unique[abi:v15000]<DB::MergeTreeDataPartWriterOnDisk::Stream, String&, std::shared_ptr<DB::IDataPartStorage>, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&>(String&, std::shared_ptr<DB::IDataPartStorage>&&, String&, char const* const&, String&, String const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, std::shared_ptr<DB::ICompressionCodec>&, unsigned long const&, DB::WriteSettings const&) @ 0x1890269f in /usr/bin/clickhouse
12. ./build/./src/Storages/MergeTree/MergeTreeDataPartWriterWide.cpp:119: void std::__function::__policy_invoker<void (DB::ISerialization::SubstreamPath const&)>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&)::$_0, void (DB::ISerialization::SubstreamPath const&)>>(std::__function::__policy_storage const*, DB::ISerialization::SubstreamPath const&) @ 0x188fd799 in /usr/bin/clickhouse
13. ./build/./contrib/llvm-project/libcxx/include/vector:1613: DB::ISerialization::enumerateStreams(DB::ISerialization::EnumerateStreamsSettings&, std::function<void (DB::ISerialization::SubstreamPath const&)> const&, DB::ISerialization::SubstreamData const&) const @ 0x1709e030 in /usr/bin/clickhouse
14. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::ISerialization::enumerateStreams(std::function<void (DB::ISerialization::SubstreamPath const&)> const&, std::shared_ptr<DB::IDataType const> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&) const @ 0x1709ebf6 in /usr/bin/clickhouse
15. ./build/./contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:98: DB::MergeTreeDataPartWriterWide::addStreams(DB::NameAndTypePair const&, std::shared_ptr<DB::IAST> const&) @ 0x188fd347 in /usr/bin/clickhouse
16. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeDataPartWriterWide::MergeTreeDataPartWriterWide(std::shared_ptr<DB::IMergeTreeDataPart> const&, DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, String const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188fd20d in /usr/bin/clickhouse
17. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714: DB::MergeTreeDataPartWide::getWriter(DB::NamesAndTypesList const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec> const&, DB::MergeTreeWriterSettings const&, DB::MergeTreeIndexGranularity const&) @ 0x188e7d5d in /usr/bin/clickhouse
18. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: DB::MergedBlockOutputStream::MergedBlockOutputStream(std::shared_ptr<DB::IMergeTreeDataPart> const&, std::shared_ptr<DB::StorageInMemoryMetadata const> const&, DB::NamesAndTypesList const&, std::vector<std::shared_ptr<DB::IMergeTreeIndex const>, std::allocator<std::shared_ptr<DB::IMergeTreeIndex const>>> const&, std::shared_ptr<DB::ICompressionCodec>, std::shared_ptr<DB::MergeTreeTransaction> const&, bool, bool, DB::WriteSettings const&) @ 0x18a361b5 in /usr/bin/clickhouse
19. ./build/./contrib/llvm-project/libcxx/include/__memory/construct_at.h:0: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::prepare() @ 0x1880e0d3 in /usr/bin/clickhouse
20. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda'(), bool ()>>(std::__function::__policy_storage const*) @ 0x18822ac9 in /usr/bin/clickhouse
21. ./build/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x1880974b in /usr/bin/clickhouse
22. ./build/./src/Storages/MergeTree/MergeTask.cpp:0: DB::MergeTask::execute() @ 0x1881bdfa in /usr/bin/clickhouse
23. ./build/./src/Storages/MergeTree/MergePlainMergeTreeTask.cpp:0: DB::MergePlainMergeTreeTask::executeStep() @ 0x18b6edff in /usr/bin/clickhouse
24. ./build/./src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:137: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x1883145b in /usr/bin/clickhouse
25. ./build/./contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:701: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x188310ca in /usr/bin/clickhouse
26. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::worker(std::__list_iterator<ThreadFromGlobalPoolImpl<false>, void*>) @ 0x128029ae in /usr/bin/clickhouse
27. ./build/./src/Common/ThreadPool.cpp:0: ThreadFromGlobalPoolImpl<false>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false>>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() @ 0x128025bc in /usr/bin/clickhouse
28. ./build/./base/base/../base/wide_integer_impl.h:789: ThreadPoolImpl<std::thread>::worker(std::__list_iterator<std::thread, void*>) @ 0x127fed2d in /usr/bin/clickhouse
29. ./build/./contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:302: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, long, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x127fe8ae in /usr/bin/clickhouse
30. ? @ 0x7fbe27a94ac3 in ?
31. ? @ 0x7fbe27b26850 in ?
 (version 23.3.2.1)
